

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>通过LLMs实现需求的背后逻辑 作者： XKC的不定期分享 来源： XKC的不定期分享 前言 大型语言模型（LLMs）是目前最热门的人工智能领域。在这个领域中，已经逐渐形成了一个初具规模的生态系统。本文并不是手把手教你如何通过 AI 构建一个应用，而是希望说清楚 AI 构建一个应用背后的逻辑，  | AiBard123| ai工具网址导航,ai最新产品</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AI聊天,AI文本生成,AI绘画,AI编程,AI电商" />
    <meta name="description" content="AiBard123 网址导航 | 免费chatgpt 汇集各类先进的人工智能产品，旨在帮助用户更快速地了解和使用这些产品,轻松地浏览不同领域的AI产品，包括语音识别、图像处理、自然语言处理。" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://aibard123.com/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                        </a>
                        <a href="https://aibard123.com/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>本月热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>热门网站</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>国内热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>对话工具</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>写作</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像处理</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音视频</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音乐生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>办公</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>提示词</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>编程</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AI搜索</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>文本翻译</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>学习网站</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>友情链接</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AiBard123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AiBard123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AiBard123| ai工具网址导航,ai最新产品">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI 文摘
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">通过LLMs实现需求的背后逻辑</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://aibard123.com/about>AiBard123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              October 12, 2023 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/B7xyZb5QVzZPDKYGJe5HrOr22Yt6viaoRCchnOB0E2n9VhbcJSfup7Ev0a5ibGE1iclF7pSz3K0S7wSEhkFiaq3D3A/640?wx_fmt=png" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <p>作者： XKC的不定期分享  来源： <a href="https://mp.weixin.qq.com/s/B1IZgZztcevW4ygYCZe92Q">XKC的不定期分享</a></p>
<h4 id="前言">前言</h4>
<p>大型语言模型（LLMs）是目前最热门的人工智能领域。在这个领域中，已经逐渐形成了一个初具规模的生态系统。本文并不是手把手教你如何通过 AI 构建一个应用，而是希望说清楚 AI 构建一个应用背后的逻辑，以此希望对后续产品思考和设计有所帮助，当然文中也包含代码，如果感兴趣也可以点击链接查看源代码了解更多内容。</p>
<h4 id="如何通过-langchain-构建应用">如何通过 LangChain 构建应用</h4>
<p>LangChain 是目前最热门的 LLMs 应用框架，甚至没有之一，如果想要深入了解 LLMs 构建应用，那么这一个框架是绕不开的，所幸这个框架入门非常简单，我下面会结合一些实际场景来说明一下。</p>
<h4 id="langchain-是什么和大语言模型llms有什么关系">LangChain 是什么？和大语言模型（LLMs）有什么关系？</h4>
<p>LangChain 是一个基于大语言模型（LLMs）的应用框架，它本身不是大语言模型（LLMs），其主要作用是降低通过 LLMs 实现功能的开发成本，因此它可以对接多个 LLMs，对于产品来说可以降低被某一个 LLMs 影响整个产品的风险：</p>
<ul>
<li>
<p>文档问答</p>
</li>
<li>
<p>聊天机器人</p>
</li>
<li>
<p>调用 API</p>
</li>
<li>
<p>分析结构化数据</p>
</li>
<li>
<p>内容推荐</p>
</li>
<li>
<p>……</p>
</li>
</ul>
<p>以上场景可能在产品中被使用，因此作为产品团队，我们可以通过了解 LangChain 的实现底层逻辑、可行性和限制来预先规划，并帮助未来的产品设计工作。以下将以通过 LangChain 实现文档问答机器人为例。</p>
<h4 id="通过-langchain-实现文档问答机器人">通过 LangChain 实现文档问答机器人</h4>
<p>首先需要做的还是数据清洗+存储</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/B7xyZb5QVzZPDKYGJe5HrOr22Yt6viaoRTDjvVIWJRiaerhicVqa1jBFlC97IJAx2t1YbZFFjZd7wq5ibGaq4k3RvA/640?wx_fmt=png" alt=""></p>
<p>这里涉及到一个知识点是向量，关于向量的具体原理可以去网上查找，资料很多，如果不想找的话可以暂时只记住向量计算主要是计算内容之间的相似程度即可。</p>
<p>而向量在这里主要是降低 AI 使用费用的，因为如果要将所有文档都告诉 AI，一个是很多模型的上下文长度不够，另外一方面是由于成本实在太高了。因此当我们将文档交给 LLMs 转化成向量后，如果有一个地方进行存储，这就是向量数据库了。</p>
<p>目前比较火热的向量数据库有很多：付费的有Pincone，免费的有 Redis、Chroma、PostgreSQL 等，具体区别和差异就是另外一个话题了。</p>
<p>接下来我们来模拟一下真实的用户使用流程，看看如何利用这些向量并结合 LLMs 优化用户问答体验：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/B7xyZb5QVzZPDKYGJe5HrOr22Yt6viaoR5yngAlicuHxzdpOMHjHHicVqibHaS8gibzMibjLGWXgVX0N4NUKnYJdiaocg/640?wx_fmt=png" alt=""></p>
<p>下面我将通过 LangChain 实现上面的流程：</p>
<p><a href="https://github.com/xukecheng/APITable-LLMs-Enhancement-Experiments/blob/main/apitable_devbook_vector_db_qa_with_sources.ipynb">https://github.com/xukecheng/APITable-LLMs-Enhancement-Experiments/blob/main/apitable_devbook_vector_db_qa_with_sources.ipynb</a></p>
<p>当然这里还有一份 OpenAI 官方的实例可以参考：</p>
<p><a href="https://github.com/openai/openai-cookbook/blob/main/examples/Question_answering_using_embeddings.ipynb">https://github.com/openai/openai-cookbook/blob/main/examples/Question_answering_using_embeddings.ipynb</a></p>
<p>通过上述流程，可以方便快捷地实现一个文档问答系统，甚至可初步投入使用。然而，我们也需要了解该模式的缺点。因为得失常并存，例如采用向量数据库降低 LLMs 使用费用时，会失去聊天上下文的便利性：通过上面对于整体的流程说明后，可以知道我们主要工作是需要根据用户问题获取相关文档内容，那么假如实现聊天上下文，用户首先问如何实现表格内快速查找替换，然后我们返回了相关文档，再然后用户又问了一个关于如何合并单元格的问题，此时的 Prompt = 第一个问题 + 第一个问题的相关文档 + 第二个问题，如果此时将 Prompt 直接发送给 LLMs 获取向量必定是不准确的，因此就需要做更精细的 Prompt 管理，例如说只将第二个问题单独发给 LLMs 获取向量再进行对比获取相关文档，然后组成新的 Prompt = 第一个问题 + 第一个问题的相关文档 + 第二个问题 + 第二个问题的相关文档，以此组成聊天上下文发送给 LLMs 获取最终答案。</p>
<p>在市场上，文档 + AI 这一需求在市面上也催生出了一些 SaaS 产品，有些甚至已经有了不少的用户，比如说 LangChain 官方文档网站中使用的产品：https://www.mendable.ai/。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/B7xyZb5QVzZPDKYGJe5HrOr22Yt6viaoRCchnOB0E2n9VhbcJSfup7Ev0a5ibGE1iclF7pSz3K0S7wSEhkFiaq3D3A/640?wx_fmt=png" alt=""></p>
<h4 id="fine-tuning微调">Fine-tuning（微调）</h4>
<p>上面主要是关于 AI 技术中关于向量（Embeddings）相关的应用，向量是一种很强大的工具可以用在很多其他方面：内容推荐、文本比较、数据分析等。而另外一个需要厘清的技术是微调（Fine-tuning）。在 OpenAI 开放 API 的初期，绝大部分人以为微调就是可以让 GPT 按照自己提供的数据集回答问题，但其实微调并不是做这个的，相反向量计算才是做这个，从上面的示例中也能看到。</p>
<blockquote>
<p>官方也有提到：Although fine-tuning can feel like the more natural option—training on data is how GPT learned all of its other knowledge, after all—we generally do not recommend it as a way to teach the model knowledge. Fine-tuning is better suited to teaching specialized tasks or styles, and is less reliable for factual recall.</p>
</blockquote>
<p>那么微调到底是做什么的呢？从目前网上的实践经验来看，我发现微调主要是可以让 GPT 模型对于特定领域的内容有着更好的理解能力和更适当的表达方式：比如说可以通过一定的语料加强模型对于中文的理解，例如去识别评论里的阴阳怪气、反问并准确地做出情感分析。</p>
<p>而要实现这一点，也需要准备海量的优质训练文本，训练文本越多，微调的价格也越高，根据我在网上看到的实践来看，要达到一定的效果需要数百到数千美元不等，且不含购买或准备训练文本的费用。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/B7xyZb5QVzZPDKYGJe5HrOr22Yt6viaoR4qmoe2JmTRH9TVJib2qJoxA866j0GQydgd3WYpXCjeYbCjBmWDMqMYw/640?wx_fmt=png" alt=""></p>
<p>因此，很多时候 Embeddings 或 Prompt Engineering 才是性价比更高的选择。</p>
<h4 id="openai-function-calling-对于构建应用的影响">OpenAI Function Calling 对于构建应用的影响</h4>
<p>LLMs 目前的领头羊 OpenAI 在本月进行了一次 API 方面的更新，更新内容包含新增 mode、降价等等，但是其中对于构建产品来说最重要的更新是支持 16K 上下文和 Chat Completions API 新增函数调用功能，前者支持了更多上下文，后者则有可能改变使用 AI 构建产品的方式。</p>
<p>函数调用并不是指 GPT 会直接帮你调用功能或接口，而是需要你告诉 GPT 有哪些函数以及每个函数的具体信息。然后输入用户问题，GPT 能够根据用户问题准确匹配出应该使用哪个函数，并为你准备好相应的入参。然后，你只需将入参发送给对应的函数执行，完成后将结果返回给 GPT，它就会自动匹配相应结果并呈现给用户。</p>
<p>有什么用呢？</p>
<p>这个可以大大的降低通过 AI 构建应用成本，比如说我之前想实现 AI 通过操作 APITable Fusion API 实现语义化查询表格，我应该怎么做？</p>
<p>说实话，这个在 Function Calling 出来之前也是成功通过 LangChain 实现了的，且基本逻辑和 Function Calling 较为类似，首先是定义一组工具，包括获取空间站、获取表格、获取记录、获取字段等，然后基本 ReAct 原理设计 Prompt，并且将工具说明注入到 Prompt 中，然后就是交给 LLMs 自行循环推理+本地执行了。但是最终实现的效果不算理想，一个是不够稳定，另一方面是由于 ReAct 和工具的原因导致耗费的 token 过多，同时在很多时候总是需要几轮会话下来 AI 才能成功解决一个问题（gpt-3.5-turbo），一个问题往往可能需要几个回合，其中不成功的原因主要包括返回数据不是 JSON 需要告知并让其重新组织数据、经常出现人工智能幻觉等等：</p>
<p><a href="https://github.com/xukecheng/APITable-LLMs-Enhancement-Experiments/blob/main/apitable_langchain_toolkit.ipynb">https://github.com/xukecheng/APITable-LLMs-Enhancement-Experiments/blob/main/apitable_langchain_toolkit.ipynb</a></p>
<p>而使用 Function Calling 就不一样了，由于是 OpenAI 官方推出的能力，理应有着更好的问题→方法的推理能力，如果顺利的话，理想的用户流程应该如下：</p>
<p>1.<strong>准备方法：</strong> 获取空间站、获取表格、获取记录、获取字段</p>
<p>2.<strong>用户问题</strong> ：我想要 XX 空间站中 XX 表的最新数据。</p>
<p>3.<strong>产品</strong> ：把用户问题和上述函数定义传给 GPT</p>
<p>4.<strong>GPT</strong> ：根据用户问题判断是否应用使用函数，应该用哪个？怎么用？然后把结果发过来</p>
<p>5.<strong>产品：</strong> 根据 GPT 的结果<strong>本地（服务端）</strong> 调用对应的函数，然后获取到结果并发送给 GPT</p>
<p>6.<strong>GPT：</strong> 获取调用结果，返回最终回复</p>
<p>7.<strong>产品：</strong> 发送最终回复给用户</p>
<p>下面这两个是我的一些实践过程：</p>
<p><a href="https://github.com/xukecheng/APITable-LLMs-Enhancement-Experiments/blob/main/apitable_openai_function.ipynb">https://github.com/xukecheng/APITable-LLMs-Enhancement-Experiments/blob/main/apitable_openai_function.ipynb</a></p>
<p><a href="https://github.com/xukecheng/APITable-LLMs-Enhancement-Experiments/blob/main/apitable_langchain_function.ipynb">https://github.com/xukecheng/APITable-LLMs-Enhancement-Experiments/blob/main/apitable_langchain_function.ipynb</a></p>
<p>我分别使用了 OpenAI API 和 LangChain 两种形式去实现，发现最终效果还算符合预期，一个是对问题的理解很准确，能够准确地调用对应的方法，另外一个就是 token 的消耗比之前少很多。</p>
<p>当然也存在一些问题：</p>
<ul>
<li>
<p>使用 OpenAI 提供的 API 来实现复杂问题（通常需要多个方法联合解决）时无法判断 AI 返回的结果是否完成，因此有可能还需要继续调用才能得出最终结果，但是 API 中并不能给出任何标记说明是否需要继续请求 API，此时就需要使用结合了 ReAct 的 LangChain。</p>
</li>
<li>
<p>LangChain 定义方法的方式和官方不太一样，需要通过定义 LangChain 中的 Tool 类型，再由 LangChain 自行转换传给 OpenAI，但是过程中发现转换似乎有些问题：https://github.com/hwchase17/langchain/issues/6814</p>
</li>
</ul>
<h4 id="总结">总结</h4>
<p>需要着重说明的是上面的应用其实仅仅停留在 Demo 阶段。如果我们想进一步将其打造成一个可用的产品，就需要考虑到许多其他问题。例如：</p>
<ul>
<li>
<p>文本的检索直接影响问答的质量，我们应该如何对其进行优化，优化向量检索？提高文本质量？</p>
</li>
<li>
<p>不同的 Prompt 对结果有很大影响，如何进行有效的效果评估也很重要。</p>
</li>
<li>
<p>从成本上来说，自己训练一个 LLM 的成本目前来说不太现实，因此暂时只能优先考虑使用 OpenAI 一类的 LLMs 服务提供商，但是他们基本都是按照用量付费，也就是说随着产品的用量增加，计算和存储的成本也会逐渐增加，如何保证入能敷出也是一个问题。</p>
</li>
<li>
<p>现在虽然已经有国内的产品接入了 GPT，但是这可能处于监管灰色地带，暂无确定的条例允许这一行为，这也是一个高风险事项。</p>
</li>
<li>
<p>目前绝大部分能力都是通过 API 实现，并不存在任何实质上的壁垒，因此和产品的结合才是更加重要的思考点</p>
</li>
</ul>
<p>总的来说，根据我的实践经验，将人工智能应用到实际场景并不像传闻中那么简单。无论市面上声称只需几百行代码搭建一个应用还是我今天演示的只是个玩具，要开发出可用的产品仍需要做更多的工作。</p>
<p>更多AI工具，参考<a href="https://aibard123.com/">Github-AiBard123</a>，<a href="https://aibard123.com/">国内AiBard123</a></p>



          </div>

可关注我们的公众号：每天AI新工具

<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


