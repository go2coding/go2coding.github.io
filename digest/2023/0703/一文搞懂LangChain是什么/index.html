

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>一文搞懂LangChain是什么 作者： giscafer 来源： [giscafer](https://mp.weixin.qq.com/s/vLlS17AYe4lM95KrG5sFyQ) 介绍 LangChain是一个专门为利用语言模型创建应用程序而设计的全面框架。它的主要目标是帮助开发人员轻松构建基于语言模型的应用。虽然LangChain与多种语言模型兼容，但它特别与OpenAI ChatGPT无缝集成，从中受  | AiBard123| ai工具网址导航,ai最新产品</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AI聊天,AI文本生成,AI绘画,AI编程,AI电商" />
    <meta name="description" content="AiBard123 网址导航 | 免费chatgpt 汇集各类先进的人工智能产品，旨在帮助用户更快速地了解和使用这些产品,轻松地浏览不同领域的AI产品，包括语音识别、图像处理、自然语言处理。" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://aibard123.com/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                        </a>
                        <a href="https://aibard123.com/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>本月热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>热门网站</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>国内热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>对话工具</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>写作</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像处理</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音视频</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音乐生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>办公</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>提示词</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>编程</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AI搜索</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>文本翻译</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>学习网站</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>友情链接</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AiBard123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AiBard123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AiBard123| ai工具网址导航,ai最新产品">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI 文摘
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">一文搞懂LangChain是什么</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://aibard123.com/about>AiBard123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              July 3, 2023 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/femv5Jq5M17HfYiaByVJdtNjhHZCAdib4Ln7mA79GwJiaMHzkoRydXaqZdF45OMB3iaVFc5biaKBNfic9QanKCiaDFF3w/640?wx_fmt=png" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <pre><code>作者： giscafer  来源： [giscafer](https://mp.weixin.qq.com/s/vLlS17AYe4lM95KrG5sFyQ)
</code></pre>
<h4 id="heading"></h4>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/femv5Jq5M17HfYiaByVJdtNjhHZCAdib4LGYPDorNefBeia7hXhBZGOBCnEukv5wEH1fNs9r27HrnBXECLvTogiaLw/640?wx_fmt=jpeg" alt=""></p>
<h4 id="介绍">介绍</h4>
<p>LangChain是一个专门为利用语言模型创建应用程序而设计的全面框架。它的主要目标是帮助开发人员轻松构建基于语言模型的应用。虽然LangChain与多种语言模型兼容，但它特别与OpenAI ChatGPT无缝集成，从中受益于其先进功能。</p>
<p>本文学习知识点: 语言模型（LLMs）和LangChain。 提示工程。 语言模型的内存。 语言模型的链式结构。 LangChain索引。 工具和代理。</p>
<h4 id="llms和langchain">LLMs和LangChain</h4>
<p>LLMs，即大型语言模型，是具有数十亿个参数的强大深度学习模型，在各种自然语言处理任务中表现出色。它们可以执行诸如翻译、情感分析和聊天机器人对话等任务，而无需进行特定训练。LLMs由多个神经网络层组成，包括前馈、嵌入和注意力层，共同处理输入文本并生成预测。 虽然LLMs有改变行业的潜力，但应考虑它们的限制和伦理影响。开发人员应优化这些模型，以最大程度地减少偏见并增强其实用性。LLMs可以处理的最大标记数取决于具体的实现。在LangChain中，最大标记数由所使用的底层OpenAI模型确定。为了处理超过标记限制的输入文本，可以将其拆分为较小的块并单独处理，然后再将结果组合起来。</p>
<p>简单使用：</p>
<pre><code>from langchain.llms import OpenAI  
from langchain.callbacks import get_openai_callback  
  
llm = OpenAI(model_name=&quot;text-davinci-003&quot;, n=2, best_of=2)  
  
with get_openai_callback() as cb:  
    result = llm(&quot;Tell me a joke&quot;)  
    print(cb)  
</code></pre>
<p>输出：</p>
<pre><code>Tokens Used: 48  
 Prompt Tokens: 4  
 Completion Tokens: 44  
Successful Requests: 1  
Total Cost (USD): $0.00096  
</code></pre>
<p>尽管LangChain与OpenAI LLMs协同工作非常顺畅，但它也可以与其他LLMs一起使用。我们将看一下Hugging Face托管的一个名为&rsquo;google/flan-t5-large&rsquo;的LLM。</p>
<pre><code>from langchain import HuggingFaceHub, LLMChain  
  
# initialize Hub LLM  
hub_llm = HuggingFaceHub(  
        repo_id='google/flan-t5-large',  
    model_kwargs={'temperature':0}  
)  
  
# create prompt template &gt; LLM chain  
llm_chain = LLMChain(  
    prompt=prompt,  
    llm=hub_llm  
)  
  
print(llm_chain.run(question))  
</code></pre>
<p>输出</p>
<pre><code>paris  
</code></pre>
<p>基于OpenAI ChatGPT的gpt-3.5-turbo模型的示例。</p>
<pre><code>from langchain.chat_models import ChatOpenAI  
from langchain.chains import LLMChain  
from langchain.prompts import PromptTemplate  
  
llm = ChatOpenAI(model_name=&quot;gpt-3.5-turbo&quot;, temperature=0)  
  
summarization_template = &quot;Summarize the following text to one sentence: {text}&quot;  
summarization_prompt = PromptTemplate(input_variables=[&quot;text&quot;], template=summarization_template)  
summarization_chain = LLMChain(llm=llm, prompt=summarization_prompt)  
  
text = &quot;LangChain provides many modules that can be used to build language model applications. Modules can be combined to create more complex applications, or be used individually for simple applications. The most basic building block of LangChain is calling an LLM on some input. Let’s walk through a simple example of how to do this. For this purpose, let’s pretend we are building a service that generates a company name based on what the company makes.&quot;  
summarized_text = summarization_chain.predict(text=text)  
  
summarized_text  
</code></pre>
<p>输出</p>
<pre><code>'LangChain offers various modules for building language model applications, allowing users to combine them for more complex applications or use them individually for simpler ones, with the basic building block being calling an LLM on input, as demonstrated in the example of creating a company name based on its product.'  
</code></pre>
<h4 id="提示工程prompt-engineering">提示工程（Prompt Engineering）</h4>
<p>提示工程（Prompt Engineering）是在使用大型语言模型时必须掌握的关键方面。通过精心设计适当的提示，即使使用较弱或开源模型，也可以达到可比较的准确性水平。</p>
<p>角色提示（Role prompting）涉及指示LLM在执行任务时扮演特定的角色或身份。例如，可以要求它扮演一个文案撰稿人的角色。这种方法通过提供上下文或观点来引导模型的回应。为了有效地利用角色提示，可以按照以下迭代步骤进行操作：</p>
<ul>
<li>
<p>1.在提示中明确指定所需的角色，例如：“作为一个文案撰稿人，为AWS服务生成引人注目的口号。”</p>
</li>
<li>
<p>2.利用提示从LLM生成输出。</p>
</li>
<li>
<p>3.分析生成的回应，并根据需要改进提示以提升结果的质量。</p>
<p>from langchain import PromptTemplate, LLMChain<br>
from langchain.llms import OpenAI</p>
<p># Before executing the following code, make sure to have<br>
# your OpenAI key saved in the “OPENAI_API_KEY” environment variable.<br>
# Initialize LLM<br>
llm = OpenAI(model_name=&ldquo;text-davinci-003&rdquo;, temperature=0)</p>
<p>template = &quot;&quot;&quot;<br>
As a futuristic robot band conductor, I need you to help me come up with a song title.<br>
What&rsquo;s a cool song title for a song about {theme} in the year {year}?<br>
&quot;&quot;&quot;<br>
# prompt template<br>
prompt = PromptTemplate( <br>
    input_variables=[&ldquo;theme&rdquo;, &ldquo;year&rdquo;],<br>
    template=template,<br>
)</p>
<p>llm = OpenAI(model_name=&ldquo;text-davinci-003&rdquo;, temperature=0)<br>
input_data = {&ldquo;theme&rdquo;: &ldquo;interstellar travel&rdquo;, &ldquo;year&rdquo;: &ldquo;3030&rdquo;}<br>
chain = LLMChain(llm=llm, prompt=prompt)<br>
response = chain.run(input_data)</p>
<p>print(&ldquo;Theme: interstellar travel&rdquo;)<br>
print(&ldquo;Year: 3030&rdquo;)<br>
print(&ldquo;AI-generated song title:&quot;, response)</p>
</li>
</ul>
<p>输出</p>
<pre><code>Theme: interstellar travel  
Year: 3030  
AI-generated song title:   
&quot;Journey to the Stars: 3030&quot;  
</code></pre>
<h4 id="llms-内存">LLMs 内存</h4>
<p>在聊天机器人应用的动态领域中，保留消息历史在提供上下文相关的回应以增强用户体验方面起着关键作用。LangChain的ConversationChain包括一种基本形式的内存，它保留了过去的所有输入和输出，并将它们融入当前的上下文中。这可以被视为一种短期记忆。LangChain提供了多种类型的内存链，包括ConversationBufferMemory（对话缓冲内存）、ConversationBufferWindowMemory（对话缓冲窗口内存）、ConversationTokenBufferMemory（对话标记缓冲内存）和ConversationSummaryMemory（对话摘要内存）。</p>
<p>通过使用这些内存链，LangChain能够在对话过程中跟踪和保留消息的历史，使得模型可以根据之前的对话内容和用户交互生成更具上下文相关的响应。这样的内存机制提高了对话的连贯性和个性化，从而提升用户体验。</p>
<pre><code>llm = ChatOpenAI(temperature=0.0)  
memory = ConversationBufferMemory()  
conversation = ConversationChain(  
    llm=llm,   
    memory = memory,  
    verbose=True  
)  
  
print(conversation.predict(input=&quot;Hi, my name is Andrew&quot;))  
print(conversation.predict(input=&quot;What is 1+1?&quot;))  
print(conversation.predict(input=&quot;What is my name?&quot;))  
</code></pre>
<p>输出</p>
<pre><code>Hello Andrew! It's nice to meet you. How can I assist you today?  
1+1 is equal to 2.  
Your name is Andrew.  
</code></pre>
<p>在上面的对话中，LLM能够记住之前的对话，并为第三次对话提供准确的回答。这得益于LangChain的内存机制，特别是ConversationChain。ConversationChain保留了过去的输入和输出，并将它们整合到当前的上下文中。这使得LLM能够根据之前的对话内容和用户交互生成更准确、更具上下文的回答。</p>
<p>通过ConversationChain的内存功能，LLM可以回顾之前的对话历史，并将其作为参考来理解当前的问题并生成相关的回答。这样的记忆机制有助于提供连贯的对话体验，并确保LLM在整个对话过程中能够保持准确性和一致性。</p>
<pre><code>print(memory.buffer)  
</code></pre>
<p>输出</p>
<pre><code>Human: Hi, my name is Andrew  
AI: Hello Andrew! It's nice to meet you. How can I assist you today?  
Human: What is 1+1?  
AI: 1+1 is equal to 2.  
Human: What is my name?  
AI: Your name is Andrew.  
</code></pre>
<h4 id="llms的链式结构">LLMs的链式结构</h4>
<p>LangChain中的链式结构旨在建立一个全面的流程，以利用语言模型。它们集成了模型、提示、内存、解析输出和调试功能，提供了用户友好的界面。一个链式结构执行以下步骤：1）接收用户的查询作为输入，2）处理语言模型的响应，3）将输出返回给用户。</p>
<p>链式结构的类型包括：</p>
<ol>
<li>
<p>LLMChain：LLMChain是使用单个语言模型的链式结构。它接收用户的查询，将其发送给语言模型进行处理，并将模型生成的响应返回给用户。</p>
</li>
<li>
<p>Sequential Chains（SimpleSequentialChain和SequentialChain）：这些是顺序执行的链式结构，可以按照特定的顺序连接多个处理组件。例如，SimpleSequentialChain可能包括一个提示组件、一个语言模型组件和一个输出解析组件，依次进行处理。</p>
</li>
<li>
<p>Router Chain：路由链是一种根据条件将查询路由到不同的子链的结构。它根据一些规则或条件决定将查询发送到哪个子链进行处理，并返回子链处理的结果。</p>
</li>
</ol>
<p>通过这些链式结构，LangChain能够组织和管理对语言模型的查询和响应流程，提供更灵活、可扩展的应用开发方式，并为用户提供更好的交互体验。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/femv5Jq5M17HfYiaByVJdtNjhHZCAdib4LHhxWCI80FFPllib8icMZ1wd164EuJPocvezsJPRVQ1CRMOfoV7dLvkgA/640?wx_fmt=png" alt=""><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/femv5Jq5M17HfYiaByVJdtNjhHZCAdib4LaY9aAQWyJaf2MkDkVklL0m2QO7YGfQhlUfEiaF2RicicOfuG608iaE9y9A/640?wx_fmt=png" alt=""><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/femv5Jq5M17HfYiaByVJdtNjhHZCAdib4LFticfIVq8ZJGoQLczF9YQrkGep3j2cxyDiciaep8x96VS34D3ZnXhULfw/640?wx_fmt=png" alt=""></p>
<p>这是一个用于SimpleSequentialChain的示例代码：</p>
<pre><code>from langchain.chat_models import ChatOpenAI  
from langchain.prompts import ChatPromptTemplate  
from langchain.chains import SimpleSequentialChain  
llm = ChatOpenAI(temperature=0.9)  
  
# prompt template 1  
first_prompt = ChatPromptTemplate.from_template(  
    &quot;What is the best name to describe \  
    a company that makes {product}?&quot;  
)  
# Chain 1  
chain_one = LLMChain(llm=llm, prompt=first_prompt)  
  
# prompt template 2  
second_prompt = ChatPromptTemplate.from_template(  
    &quot;Write a 20 words description for the following \  
    company:{company_name}&quot;  
)  
# chain 2  
chain_two = LLMChain(llm=llm, prompt=second_prompt)  
  
overall_simple_chain = SimpleSequentialChain(chains=[chain_one, chain_two],  
                                             verbose=True  
                                            )  
  
overall_simple_chain.run(product)  
</code></pre>
<h4 id="langchain索引">LangChain索引</h4>
<p>无论选择了哪种模型或使用了哪种提示表达方式，语言模型本身都具有一些无法通过我们所学的技术来克服的局限性。这些模型有一个训练截断点，这意味着它们无法获得实时新闻和最新的更新。因此，这些模型提供的回应可能不总是事实准确的，有可能包含虚构的信息。</p>
<p>在LangChain中，索引和检索器在组织和检索语言模型相关数据方面起着关键作用。索引是高效存储和组织文档的强大数据结构，用于快速搜索；而检索器利用这些索引，在用户查询时定位和检索相关文档。在LangChain中，主要的索引类型是基于向量数据库的，其中基于嵌入向量的索引是最常见的方法。</p>
<p>下面的图片展示了从向量数据库中读取索引的过程。（图片来源：deeplearning.ai）</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/femv5Jq5M17HfYiaByVJdtNjhHZCAdib4Ln7mA79GwJiaMHzkoRydXaqZdF45OMB3iaVFc5biaKBNfic9QanKCiaDFF3w/640?wx_fmt=png" alt=""><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/femv5Jq5M17HfYiaByVJdtNjhHZCAdib4LaMnAXPPoQbbcNhia7KzdyHClkRuiaiaJn3NxYYSOfLVZDksbotUEAL1EQ/640?wx_fmt=png" alt=""><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/femv5Jq5M17HfYiaByVJdtNjhHZCAdib4LlVqxf8gu0llroItdjlKGTnvgXq0XObf9LrcrakCwkVcLfQflDI73sQ/640?wx_fmt=png" alt=""><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/femv5Jq5M17HfYiaByVJdtNjhHZCAdib4Ln3dGibznE1aiarMk9jaSjk2rDxwiaBtiaCV8n7ic2SYQyz1uOLJXvzZumxQ/640?wx_fmt=png" alt=""></p>
<p>面是一个读取词嵌入（word embeddings）的示例：</p>
<pre><code>from langchain.chains import RetrievalQA  
from langchain.chat_models import ChatOpenAI  
from langchain.document_loaders import CSVLoader  
from langchain.vectorstores import DocArrayInMemorySearch  
from langchain.indexes import VectorstoreIndexCreator  
  
file = 'csv_file.csv'  
loader = CSVLoader(file_path=file)  
index = VectorstoreIndexCreator(  
    vectorstore_cls=DocArrayInMemorySearch  
).from_loaders([loader])  
query =&quot;Please list all your shirts with sun protection \  
in a table in markdown and summarize each one.&quot;  
response = index.query(query)  
loader = CSVLoader(file_path=file)  
docs = loader.load()  
  
  
from langchain.embeddings import OpenAIEmbeddings  
embeddings = OpenAIEmbeddings()  
embed = embeddings.embed_query(&quot;Hi my name is Harrison&quot;)  
  
print(embed[:5])  
</code></pre>
<p>输出</p>
<pre><code>[-0.021913960576057434, 0.006774206645786762, -0.018190348520874977,   
-0.039148248732089996, -0.014089343138039112]  
</code></pre>
<p>下面是一个来自Data Lake Serverless Vector Database的示例：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/femv5Jq5M17HfYiaByVJdtNjhHZCAdib4LUWOc498lfgmROOkNYcvDib2iaZbnIPJbL6YBPERTlNhfoMQoqibUpzLoQ/640?wx_fmt=png" alt=""></p>
<pre><code>from langchain.document_loaders import TextLoader  
  
# text to write to a local file  
# taken from https://www.theverge.com/2023/3/14/23639313/google-ai-language-model-palm-api-challenge-openai  
text = &quot;&quot;&quot;Google opens up its AI language model PaLM to challenge OpenAI and GPT-3  
Google is offering developers access to one of its most advanced AI language models: PaLM.  
The search giant is launching an API for PaLM alongside a number of AI enterprise tools  
it says will help businesses “generate text, images, code, videos, audio, and more from  
simple natural language prompts.”  
  
PaLM is a large language model, or LLM, similar to the GPT series created by OpenAI or  
Meta’s LLaMA family of models. Google first announced PaLM in April 2022. Like other LLMs,  
PaLM is a flexible system that can potentially carry out all sorts of text generation and  
editing tasks. You could train PaLM to be a conversational chatbot like ChatGPT, for  
example, or you could use it for tasks like summarizing text or even writing code.  
(It’s similar to features Google also announced today for its Workspace apps like Google  
Docs and Gmail.)  
&quot;&quot;&quot;  
  
# write text to local file  
with open(&quot;my_file.txt&quot;, &quot;w&quot;) as file:  
    file.write(text)  
  
# use TextLoader to load text from local file  
loader = TextLoader(&quot;my_file.txt&quot;)  
docs_from_file = loader.load()  
  
  
from langchain.text_splitter import CharacterTextSplitter  
  
# create a text splitter  
text_splitter = CharacterTextSplitter(chunk_size=200, chunk_overlap=20)  
  
# split documents into chunks  
docs = text_splitter.split_documents(docs_from_file)  
  
from langchain.embeddings import OpenAIEmbeddings  
embeddings = OpenAIEmbeddings(model=&quot;text-embedding-ada-002&quot;)  
  
from langchain.vectorstores import DeepLake  
my_activeloop_org_id = &quot;&lt;YOUR-ACTIVELOOP-ORG-ID&gt;&quot;  
my_activeloop_dataset_name = &quot;langchain_course_indexers_retrievers&quot;  
dataset_path = f&quot;hub://{my_activeloop_org_id}/{my_activeloop_dataset_name}&quot;  
db = DeepLake(dataset_path=dataset_path, embedding_function=embeddings)  
  
# add documents to our Deep Lake dataset  
db.add_documents(docs)  
  
# create retriever from db  
retriever = db.as_retriever()  
  
from langchain.chains import RetrievalQA  
from langchain.llms import OpenAI  
  
# create a retrieval chain  
qa_chain = RetrievalQA.from_chain_type(  
 llm=OpenAI(model=&quot;text-davinci-003&quot;),  
 chain_type=&quot;stuff&quot;,  
 retriever=retriever  
)  
  
query = &quot;How Google plans to challenge OpenAI?&quot;  
response = qa_chain.run(query)  
print(response)  
</code></pre>
<p>输出</p>
<pre><code>Google plans to challenge OpenAI by offering access to its AI language model  
PaLM, which is similar to OpenAI's GPT series and Meta's LLaMA family   
of models. PaLM is a large language model that can be used for tasks   
like summarizing text or writing code.  
</code></pre>
<h4 id="工具和代理">工具和代理</h4>
<p>LangChain提供了各种工具和代理，用于帮助用户在应对挑战和生成有意义的回答时提高效率和便捷性。通过无缝集成这些工具，用户可以访问各种功能和信息源，以解决问题和提供不同类型的答案。LangChain中一些重要的工具示例包括Google搜索、Requests、Python REPL、Wikipedia和Wolfram Alpha。</p>
<p>代理是根据自然语言指令行动的机器人，可以利用工具来回答查询。它们确定要采取的操作顺序，可能涉及使用工具或向用户提供回答。有效使用代理可以发挥强大的作用，因为它们可以根据用户输入动态调用链条。在LangChain中创建代理时，可以使用initialize_agent函数和load_tools函数来准备代理可用的工具。</p>
<p>LangChain中的代理在根据用户输入进行决策和任务执行方面起着重要作用。它们评估情况并确定要使用的适当工具。LangChain提供了两类主要的代理：执行单个动作的“Action Agents”，适用于简单的任务；以及制定包含多个动作并按顺序执行的“Plan-and-Execute Agents”，适用于复杂或长时间运行的任务。</p>
<p>以下示例中，我们将使用Google搜索作为工具来查找Ashes系列赛事的最新摘要。（在撰写这篇文章时，我正在积极关注Ashes系列赛事)</p>
<pre><code>from langchain.llms import OpenAI  
  
from langchain.agents import AgentType  
from langchain.agents import load_tools  
from langchain.agents import initialize_agent  
  
from langchain.agents import Tool  
from langchain.utilities import GoogleSearchAPIWrapper  
  
llm = OpenAI(model=&quot;text-davinci-003&quot;, temperature=0)  
  
os.environ[&quot;GOOGLE_API_KEY&quot;]= &quot;&lt;GOOGLE_API_KEY&gt;&quot;  
os.environ[&quot;GOOGLE_CSE_ID&quot;] = &quot;&lt;GOOGLE_CSE_ID&gt;&quot;  
search = GoogleSearchAPIWrapper()  
  
tools = [  
    Tool(  
        name = &quot;google-search&quot;,  
        func=search.run,  
        description=&quot;useful for when you need to search google to answer questions about current events&quot;  
    )  
]  
  
agent = initialize_agent(tools,   
                         llm,   
                         agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION,   
                         verbose=True,  
                         max_iterations=6)  
  
response = agent(&quot;latest status on ashes series&quot;)  
print(response['output'])  
</code></pre>
<p>输出</p>
<pre><code>&gt; Finished chain.  
The 2021–22 Ashes series, named the Vodafone Men's Ashes Series for   
sponsorship reasons, is scheduled to take place in England from 8 July to  
7 September 2023. Australia last won an Ashes series in England in 2001   
and the current series is scheduled to take place from 8 July to 7 September   
2023. The ESPNcricinfo app has an all-new native experience on match score   
screens and an exciting new feature 'Fantasy Cheatsheet' to help you win your  
fantasy games. The 2023 Ashes series is sure to be a highly anticipated   
event for cricket fans worldwide.  
</code></pre>
<h4 id="进一步阅读">进一步阅读</h4>
<p>随着ChatGPT和LangChain引起的激动，这个领域出现了许多令人振奋的项目和发展。以下是一些链接，可供探索这些令人兴奋的创新项目：</p>
<ul>
<li>
<p>CAMEL : <a href="https://www.camel-ai.org/">https://www.camel-ai.org/</a></p>
</li>
<li>
<p>Deep Lake: <a href="https://python.langchain.com/docs/modules/data_connection/vectorstores/integrations/deeplake">https://python.langchain.com/docs/modules/data_connection/vectorstores/integrations/deeplake</a></p>
</li>
<li>
<p>AgentGPT : <a href="https://github.com/reworkd/AgentGPT">https://github.com/reworkd/AgentGPT</a></p>
</li>
<li>
<p>AutoGPT : <a href="https://www.lesswrong.com/posts/566kBoPi76t8KAkoD/on-autogpt">https://www.lesswrong.com/posts/566kBoPi76t8KAkoD/on-autogpt</a></p>
</li>
<li>
<p><a href="https://github.com/yoheinakajima/babyagi/blob/main/docs/inspired-projects.md">https://github.com/yoheinakajima/babyagi/blob/main/docs/inspired-projects.md</a></p>
</li>
</ul>



          </div>

可关注我们的公众号：每天AI新工具

<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


