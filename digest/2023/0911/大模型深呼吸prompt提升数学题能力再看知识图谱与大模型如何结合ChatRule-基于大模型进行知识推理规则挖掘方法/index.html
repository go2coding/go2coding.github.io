

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>大模型深呼吸prompt提升数学题能力？再看知识图谱与大模型如何结合：ChatRule-基于大模型进行知识推理规则挖掘方法 作者： 老刘说NLP 来源： 老刘说NLP 今天是2023年9月10日，星期日，北京天气阴，今天是教师节，祝各位老师节日快乐。‍ 在昨天的文章中，我们介绍了大模型幻觉的一个很好的综述工作，从中可以看到幻觉产生的原因、种类以及不同阶段的缓解策略，我们可  | AiBard123| ai工具网址导航,ai最新产品</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AI聊天,AI文本生成,AI绘画,AI编程,AI电商" />
    <meta name="description" content="AiBard123 网址导航 | 免费chatgpt 汇集各类先进的人工智能产品，旨在帮助用户更快速地了解和使用这些产品,轻松地浏览不同领域的AI产品，包括语音识别、图像处理、自然语言处理。" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://aibard123.com/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                        </a>
                        <a href="https://aibard123.com/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>本月热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>热门网站</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>国内热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>对话工具</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>写作</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像处理</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音视频</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音乐生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>办公</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>提示词</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>编程</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AI搜索</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>文本翻译</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>学习网站</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>友情链接</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AiBard123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AiBard123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AiBard123| ai工具网址导航,ai最新产品">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI 文摘
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">大模型深呼吸prompt提升数学题能力？再看知识图谱与大模型如何结合：ChatRule-基于大模型进行知识推理规则挖掘方法</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://aibard123.com/about>AiBard123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              September 11, 2023 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJj032K8NeasafZA4voLLoiaUxSSic6EiceOLILDOddJAelTTDQdvenoDIugL1tLg0EuJicP4x8VRbrkiaQ/640?wx_fmt=png" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <p>作者： 老刘说NLP  来源： <a href="https://mp.weixin.qq.com/s/NCCoEQs8GKOctx7eMBJy7w">老刘说NLP</a></p>
<p>今天是2023年9月10日，星期日，北京天气阴，今天是教师节，祝各位老师节日快乐。‍</p>
<p>在昨天的文章中，我们介绍了大模型幻觉的一个很好的综述工作，从中可以看到幻觉产生的原因、种类以及不同阶段的缓解策略，我们可以在此基础上做成脑图【完整版和编辑版可在社区获取】。‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍</p>
<p>​<img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJj032K8NeasafZA4voLLoiaU95mRCGJZwXD911l8hJMfZTicOgzKhQQH33WQLwUkyy0BKdziabofz97Q/640?wx_fmt=png" alt=""></p>
<p>而昨天又看到一个十分有趣的工作：谷歌DeepMind团队:https://arxiv.org/abs/2309.03409《LARGE LANGUAGE MODELS AS OPTIMIZERS》提出了&quot;提示优化&quot;（OptimizationbyPROmpting，简称OPRO），利用大型语言模型（LLM）作为优化器的简单而有效的方法，其中的优化任务是用自然语言描述。</p>
<p>其在每个优化步骤中，LLM会从包含先前生成的解决方案及其值的提示中生成新的解决方案，然后对新解决方案进行评估，并将其添加到下一个优化步骤的提示中，其目标是找到能最大限度提高任务准确性的指令。</p>
<p>通过各种LLM，证明OPRO优化后的最佳提示在GSM8K上优于人类设计的提示达8%，在Big-BenchHard任务上优于人类设计的提示达50%。</p>
<p>例如，<strong>用这个新“咒语”（Take a deep breath）结合大家已经熟悉的“一步一步地想”（Let’s think step by step），大模型在GSM8K数据集上的成绩就从71.8提高到80.2分。</strong></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJj032K8NeasafZA4voLLoiaULDU8OMDKrwic7KbNrxehXFsdricDn9LzO9DPBn6j7lYecslDEYb2LbBQ/640?wx_fmt=png" alt=""></p>
<p>这感觉大模型越来越玄学，但从直觉上来说，这种效果应该本质上与其所使用的训练数据有直接关系。‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJj032K8NeasafZA4voLLoiaU5AebYnthLq8t97jxeF2AibUq4nicPOYZs1UMSsregay7WSiciclMwWVCgA/640?wx_fmt=png" alt=""></p>
<p>因此，我们更对大模型这种不可解释的黑盒现象表示十分的无奈。‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍</p>
<p>所以，我们再来看看知识图谱与大模型的结合工作，我们知道，<strong>在大模型黑盒化的今天，人们越来越需要可解释的KG推理，</strong> 它可以帮助用户理解推理过程，并提高高风险场景中的可信度，如医疗诊断和法律判断。</p>
<p><strong>而知识图谱推理从现有事实中推断出新知识，是知识图谱中一项有趣的任务，也是许多应用所必需的，例如知识图谱补全、问题解答和推荐。</strong></p>
<p>例如，可以确定一个逻辑 cal规则：GrandMather(X,Y)←Mother(X,Z)∧Father(Z,Y)来预测关系&quot;Grand-Mather&quot;的缺失事实。</p>
<p>进行知识图谱推理规则挖掘，基本思想很简单，给定种子规则，针对规则来生成进一步的规则候选，然后利用打分函数对规则进行打分排序，最终形成最终的挖掘结果。</p>
<p><strong>最近的工作：《ChatRule: Mining Logical Rules with Large Language Models for Knowledge Graph Reasoning》(<a href="https://arxiv.org/pdf/2309.01538.pdf">https://arxiv.org/pdf/2309.01538.pdf</a>)</strong> 这篇文章将两者进行结合，利用大模型挖掘知识图谱上的逻辑规则，利用LLM的重读能力和KG的结构信息进行规则生成、规则排序和规则验证。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBfvJ1ErUJHTsgNao5vMMdtJbqA1waBkvAPcibjWnQpl43OVcAKlG7ib8vg/640?wx_fmt=png" alt=""></p>
<p>为了验证该方法的有效性，ChatRule在四个KG数据集上进行了评估，声称取得了不错的效果，本文对该工作进行介绍，其关于知识图谱挖掘的一些工作也具备参考意义，供大家一起思考。</p>
<h4 id="一现有知识图谱规则挖掘方法及大概思想">一、现有知识图谱规则挖掘方法及大概思想</h4>
<p>进行知识图谱推理规则挖掘，基本思想很简单，给定种子规则，针对规则来生成进一步的规则候选，然后利用打分函数对规则进行打分排序，最终形成最终的挖掘结果。</p>
<p>为了从KG中自动发现有意义的推理规则，逻辑规则挖掘在研究界获得了极大的关注。</p>
<p>早期关于逻辑规则挖掘的研究通常通过发现KG结构中频繁出现的模式来找到逻辑规则。然而，它们通常需要枚举KG上所有可能的规则，并根据估计的重要性对其进行排序。</p>
<p>尽管最近的研究提出使用深度学习方法对规则进行排序。这些方法仍然受限于对规则的穷举，无法扩展到大规模KG。</p>
<p>也就是说，传统方法的核心在于<strong>列举候选规则，然后通过计算权重分数来判断规则的质量</strong> 。</p>
<p>例如：</p>
<p><strong>AIME，一种传统的逻辑规则挖掘方法，它通过归纳逻辑编程从KG中发现规则；</strong></p>
<p><strong>NeuralLP，一种归纳逻辑编程方法，它以端到端的差分方式学习逻辑规则；</strong></p>
<p><strong>DRUM，利用LSTM和注意力机制扩展了NeuralLP，以挖掘可变长度的规则；</strong></p>
<p>随着深度学习的发展，研究人员探索了以不同方式同时学习逻辑规则和权重的想法，然而，这些方法仍然要对规则空间进行大量优化，这限制了它们的可扩展性。</p>
<p>最近，研究人员提出了从KG中抽样路径并训练模型来学习逻辑连接的方法。RLvLR从子图中采样规则，并提出一种基于嵌入的分数函数来估计每条规则的重要性。</p>
<p>RNNLogic将规则生成和规则加权分开，这可以相互促进，减少搜索空间。</p>
<p>R5提出了一种强化学习框架，可启发式地搜索KG并挖掘底层逻辑规则。RLogic和NCRL可预测规则体的最佳构成，是该领域最先进的方法。</p>
<p><strong>RNNLogic，一种规则生成器和逻辑规则推理预测器，它开发了一种基于EM的算法，用于优化和学习高质量的推理规则；</strong></p>
<p><strong>Rlogic，引入了一个在采样路径上训练的评分模型，并使用演绎推理来估计每个规则的质量；</strong></p>
<p><strong>NCRL，通过反复合并规则体中的成分来推导规则，从而检测出规则体中表达规则头的最佳成分结构。</strong></p>
<p>最近一些方法解决了这一问题，它们从KG中抽取路径，并对其进行模型训练，以捕捉形成规则的逻辑联系。但是，他们通常忽略了关系语义对表达逻辑联系的贡献。</p>
<p>例如：</p>
<p>我们知道一个人的&quot;父亲&quot;的&quot;母亲&quot;是他的&quot;祖母&quot;，据此以定义一条规则，如GrandMather(X,Y)←Mother(X,Z)∧Father(Z,Y)来表达逻辑联系。然而，<strong>由于KG中的关系数量众多，要求领域专家为每个关系注释规则可能会造成负担</strong> 。因此，必须自动结合关系的结构和语义来发现KG中的逻辑规则。</p>
<p>最近，大型语言模型（LLM）凭借其突现能力和泛化能力，在自然语言处理领域和各种应用中表现出了令人印象深刻的性能。<strong>经过大规模语料库的训练，LLMs存储了大量常识性知识，可用于促进KG推理，但LLMs并非为理解KG的结构而设计，因此很难直接应用它们来挖掘KG的逻辑规则。</strong> 此外，公认的幻觉问题也会使LLM生成毫无意义的逻辑规则。</p>
<p>ChatRule的路线也类似，该框架利用KG的语义和结构信息促使LLM生成逻辑规则。具体的：</p>
<p>首先提出一种基于LLM的规则生成器，为每个关系生成候选规则，从KG中抽取一些路径来表示结构信息，然后将其用于精心设计的提示中，从而利用LLM的能力进行规则挖掘。</p>
<p>为了减少幻觉问题，设计了一个逻辑规则排序器来评估生成规则的质量，并通过囊括KG中观察到的事实来过滤无均值规则。在逻辑推理阶段进一步使用质量分数，以减少低质量规则的影响。</p>
<p>最后，为了去除由KG支持但逻辑上不正确的虚假规则，利用LLM的逻辑推理能力，通过思维链（CoT）推理用规则验证器验证规则的逻辑正确性。</p>
<p>整个框架如图2所示：<strong>‍‍‍</strong></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBfRVXBn0eqCn82aTROt0mibmH019qxsy4cKXWsI7c78fFQgsdEmD7mltg/640?wx_fmt=png" alt=""></p>
<p>其中：</p>
<p>每一步实现步骤包括以下几步：‍‍‍‍</p>
<p>1)首先针对给定的目标关系rh从知识图谱中抽取一些规则实例。</p>
<p>2)促使大型语言模型（如ChatGPT）生成一组粗略的候选规则。</p>
<p>3)提出一个规则排序器，根据知识图谱中的事实来估算生成规则的质量。</p>
<p>4)通过思维链推理验证排序规则的逻辑正确性。</p>
<p>5)最终规则可用于逻辑推理和处理下游任务，如完成知识图谱。</p>
<h4 id="二问题的定义">二、问题的定义</h4>
<p>知识图谱（KowledgeGraphs，KGs）表示三元组G={(e,r,e′)⊆E×R×E}中的事实集合，其中e,e′∈E和r∈R分别表示实体和关系的集合。</p>
<p>逻辑规则是一阶逻辑的特例，它有助于对KG进行可解释的推理，逻辑规则ρ以如下形式说明逻辑蕴涵</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBfI0EWibsA769vgia2xqnUk5V2fpRTNefH6XhFWjTpcP0jud6OZFUJym7w/640?wx_fmt=png" alt=""></p>
<p>其中body(ρ):=r1(X,Z1)∧&mdash;∧rL(ZL-1,Y)表示一系列关系的连接，称为规则体，rh(X,Y)表示规则头，L表示规则长度。如果满足规则体的条件，那么规则头的声明也成立。</p>
<p>用KG中的实际实体替换变量X、Y、Z∗，就可以实现规则的实例。例如，给定一条规则GrandMather(X,Y)←Mother(X,Z1)∧Father(Z1,Y)，规则实例δ可以是</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBficHKHVWbm6ez8SWcx4CJN4icuevxoFZTcthHmRctqXvAibVXo9icCnw7mQ/640?wx_fmt=png" alt=""></p>
<p>这意味着如果Alice是Bob的母亲，而Bob是Charlie的父亲，那么Alice就是Charlie的祖母。</p>
<p>那么，规则挖掘的定义则是：<strong>给定一个目标关系rh∈R作为规则头，逻辑规则挖掘的目标是找到一组有意义的规则Prh={ρ1,&mdash;,ρK}，这些规则捕捉其他关系的逻辑联系，用KGs表达目标关系rh。</strong></p>
<h4 id="三具体实现细节">三、具体实现细节‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍</h4>
<p><strong>1、基于LLM的规则生成</strong></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJj032K8NeasafZA4voLLoiaUyW4pzEQ8RgWGgkZNibs9xwM7D5wl9LUsE1UaFz1jia36UeFHQgObicLDA/640?wx_fmt=png" alt=""></p>
<p>入上图所示，对于通过规则采样器从Srh = {ρ}中获得的目标关系rh的每一条规则，将其口头化为自然语言句子，去除关系名称中的特殊符号，因为这些符号可能会降低LLMs的语义理解能力。</p>
<p>对于原始关系的逆关系，通过添加&quot;inv&quot;符号将其口头化。然后，将口头化的规则样本放入提示模板，并将其输入LLM（如ChatGPT）以生成规则。关系&quot;丈夫（X,Y）&ldquo;的规则生成提示和LLM生成结果示例如下图3所示。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBfWaF1DpFa4cHuIP7ZbBeZnxs6jxcfmq3f0wWWQiaiaibzKmhIAyIDhf4NQ/640?wx_fmt=png" alt=""></p>
<p>其对应的规则生成提示prompt如下：‍‍‍‍‍‍</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBf1hS5bJ6YibCKyhYIdfBSBHfDcMPA9vGic2IQ5btfNjSiaTCkRnCPcnHnA/640?wx_fmt=png" alt=""></p>
<p><strong>2、逻辑规则摘要</strong></p>
<p>由于规则样本数量庞大，无法同时将所有规则样本输入LLM，否则就会超出上下文限制。因此，将规则样本分成多个查询，以促使LLM生成规则。然后，收集LLMs的回复，并要求LLMs对结果进行总结，得到一组可生成的规则Crh={ρ}。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJj032K8NeasafZA4voLLoiaULpG3uIkMFxgEG9mkJ0aHOlG3GLLteGVVW2SnRUmTdScxYrYNYIc8BA/640?wx_fmt=png" alt=""></p>
<p>这一步也通过Prompt来控制，对应的prompt如下：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBfEoFBh14wibOTPMI0N3QPV40zVzTcHx064PZZfUUd2EnFNsiavS5G53xA/640?wx_fmt=png" alt=""></p>
<p><strong>3、逻辑规则排序</strong></p>
<p>由于LLM存在幻觉问题，可能会生成错误的结果，如图3结果中显示的生成规则husband(X,Y)←husband(X,Z1)&amp;brother(Z1,Y)就是不正确的。因此，可以开发一种规则排序器来检测幻觉，并根据KG中的事实来估计生成规则的质量。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJj032K8NeasafZA4voLLoiaUxSSic6EiceOLILDOddJAelTTDQdvenoDIugL1tLg0EuJicP4x8VRbrkiaQ/640?wx_fmt=png" alt=""></p>
<p><strong>规则排序器旨在为候选规则集Crh中的每条规则ρ指定一个质量分数s(ρ)。</strong></p>
<p>在这里采用四种方法来评估规则的质量，即支持度、覆盖率、置信度和PCA置信度【这是一种打分函数】，其中：</p>
<p>支持度表示KG中满足规则ρ的事实数量，其定义为：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBfOjZozqicKQrbGz5CKU0lhWvo4DvubJicID2n9cXJPJ7gibKfwFns3f67Q/640?wx_fmt=png" alt=""></p>
<p>其中(e1,r1,e2),&mdash;,(eL-1,rL,e′)表示KG中满足规则body(ρ)的一系列事实，(e,rh,e′)表示满足规则头rh的事实。然而，支持度是一个绝对数，对于KG中事实较多的关系，支持度可能会更高，从而导致排序结果有偏差。</p>
<p>因此可以采用覆盖率，即通过KG中每个关系的事实数来规范支持率，其定义为：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBfHB4dSETM6vYPeYR1fcgJHrRMLn1FhUZ2W01A2hjQfkrrM1Mzl8Musg/640?wx_fmt=png" alt=""></p>
<p>而为了进一步考虑规则的错误预测，可以进一步引入置信度和PCA置信度来估计规则的质量。</p>
<p>置信度被定义为在KG中满足规则ρ的事实数量与满足规则主体body(ρ)的次数之比，其定义为：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBfG1FKiaB7bx3HhNsp9AHNcOSPLzHlJicBdiaINRwT4awDrQ7mYMzekTTnA/640?wx_fmt=png" alt=""></p>
<p>置信度假定从规则正文导出的所有事实都应包含在KG中。然而，在实践中，KG通常是不完整的，这可能会导致证据事实的误判。因此，我们引入PCA置信度来选择能更好地概括未见事实的规则。</p>
<p>PCA置信度定义为在部分完成的KG中，满足规则ρ的事实数量与满足规则主体body(ρ)的次数之比，其定义为：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBfBTSwSLhaXR0LibQGE8boRNPTZ8IejgFKmVUDLZiarQhQaxoQhOzIumQQ/640?wx_fmt=png" alt=""></p>
<p>PCA置信度的分母并不是从规则主体导出的整个事实集的大小，而是基于已知为真和假定为假的事实数量。因此，PCA置信度更适合用来估计不完整KG中规则的质量和通用性。</p>
<p><strong>4、用于规则验证的CoT推理</strong></p>
<p>逻辑规则排序之后，可以得到目标关系rh的排序规则集Rrh={(ρ,s(ρ))}。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJj032K8NeasafZA4voLLoiaUxO9ANfN09EPI7iafxaicejvXhZTflZ6hTbwM5zNicROwhgobRqa4kEKPg/640?wx_fmt=png" alt=""></p>
<p>虽然可以剪除支持度为零的规则来提高生成规则的质量，但是，KG中可能存在噪音，这会导致虚假规则的存在。这些规则看似得到KG中事实的支持，但在逻辑上却是不正确的，这可能会导致下游任务中出现错误的预测。因此，可以利用LLM的推理能力，通过思维链（CoT）推理来验证规则的逻辑正确性。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBf5HZwGI4x4CUrzzYZDbgDtoyxQgfibzcmib2Orr4XmwlOnXrJmzD9rLxA/640?wx_fmt=png" alt=""></p>
<p>对于每条规则ρ∈Rrh，将其输入CoT提示模板，并要求LLM验证其逻辑正确性。对应的prompt提示如下：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJj032K8NeasafZA4voLLoiaUNYicR409MLxFhj9Yic4icfEs9JGWeCaIqCJk84o9w7rR8NIKtNiaNu2zNw/640?wx_fmt=png" alt=""></p>
<p><strong>5、基于规则的逻辑推理</strong></p>
<p>最终规则可用于逻辑推理，并通过应用现有算法解决下游任务，如完成知识图谱。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJj032K8NeasafZA4voLLoiaUsm2Wibf7VZdODwyfAsiawq6kib82TvkE1dnPDj3FCia0ePRLKzocSbnFUw/640?wx_fmt=png" alt=""></p>
<p>给定一个查询（e,rh,?），让A成为候选答案集。对于每个e′∈A，我们可以应用Prh中的规则来获得得分：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBf4a6HzYpc64P1tBJrz3msXXHJemAkof49sOaZDlgqYuia8fIPDOCaabw/640?wx_fmt=png" alt=""></p>
<p>其中，body(ρ)(e,e′)表示KG中满足规则主体的路径，s(ρ)表示规则的质量得分，可以是收敛、置信度和PCA置信度。然后，可以根据得分对候选答案A进行排序，选出前N个答案作为最终结果。</p>
<h4 id="四实验设置与具体效果">四、实验设置与具体效果‍‍‍‍‍‍‍‍‍‍</h4>
<p><strong>1、实验数据</strong></p>
<p>Family：一个定义家庭成员关系的知识图谱，例如&quot;父亲&rdquo;、&ldquo;母亲&quot;和&quot;姑姑&rdquo;。</p>
<p>WN18RR：一个英语词汇知识图谱，旨在根据词汇的语义关系组织词汇。单词通过一系列关系连接起来，包括&quot;hypernym（超义词）&quot;、&ldquo;deriva-tion（派生词）&ldquo;等。</p>
<p>FB15K-237：从Freebase中提取的知识图谱子集，其中包含各种主题和237种不同关系的数据。</p>
<p>YAGO3-10：从维基百科、WordNet和地名等多个数据源构建的大规模知识图谱，其中包含许多关系，如&quot;出生在&rdquo;、&ldquo;生活在&quot;和&quot;政治家&quot;等。</p>
<p><strong>2、对比基线</strong></p>
<p>AIME、NeuralLP、DRUM、RNN-Logic、RLogic、NCRL</p>
<p><strong>3、评测指标</strong></p>
<p>在知识图谱补全任务（通过基于规则的逻辑重构来预测缺失的事实）中，屏蔽了每个测试三元组的尾部或头部实体，并使用每种方法生成的规则对其进行预测，使用平均倒数等级（MRR）和命中率@N作为评价指标，并将N设为1和10。</p>
<p>对于ChatRule，分别使用ChatGPT1和GPT-43作为规则生成和验证的LLM，选择PCA置信度作为最终的规则排序指标。</p>
<p><strong>4、知识图谱补全效果</strong> ‍‍‍</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJj032K8NeasafZA4voLLoiaUw9uf15M2VxQXMicNI9w9mM4hsc0Ed5HSL9fD7ZibmrmeHnuATmOCo4Zw/640?wx_fmt=png" alt=""></p>
<p>从结果中可以看出，ChatRule在所有数据集上的表现较好。特别是传统的AIME方法，它只利用结构信息进行归纳逻辑编程，已经取得了相对较好的性能。</p>
<p>但是，由于关系和三元的数量不断增加，AIME在大规模KG（如FB15K-237和YAGO3-10）中失效。最近基于深度学习的方法（如Neural-LP、DRUMP和RNNLogic）利用神经网络的能力实现了更好的性能。然而，由于规则搜索空间非常大，这些方法在处理大型KG时很容易超出内存。</p>
<p><strong>5、规则质量评估效果</strong></p>
<p>为了进一步证明规则排序中采用的四项指标（即支持度、覆盖度、置信度和PCA置信度）的有效性，我们使用它们来评估每种方法生成的规则。结果如表3所示。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJj032K8NeasafZA4voLLoiaUVtgmSKdF9l485cCGmFDvHb5tib1zmyYDuaibGYvJRHclaM8PuNE9PViag/640?wx_fmt=png" alt=""></p>
<p>从结果中可以看出，与基线方法相比，ChatRule能生成支持度、覆盖率和置信度更高的规则。</p>
<p>值得注意的是，即使ChatRule（Chat-GPT）在YAGO3-10的支持度和覆盖率方面获得了更高的分数，其知识图谱完成结果仍然被ChatRule（GPT-4）击败。原因是ChatRule(GPT-4)生成的规则具有更好的PCA置信度，更适合评估完整知识图谱中的规则。</p>
<p>较高的PCA置信度得分表明，ChatRule（GPT-4）可以生成具有更好普适性的规则，而不是仅仅依赖于提示中提供的抽样规则。因此，ChatRule(GPT-4)在完成知识图谱任务时可以获得更好的性能。</p>
<p><strong>6、消融实验</strong> ‍</p>
<p>首先，ChatRule中每个组件的有效性。使用GPT-4作为LLM，使用PCA置信度作为规则排名指标，结果如表4所示：</p>
<p>GPT（zero-shot）表示直接使用GPT-4生成规则，不需要任何规则样本。规则样本、总结、排名和验证分别表示ChatRule中提出的组件。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggCibhibAvF2MgPRTFvdsZBfKoAcN0xTk51C13EoebIeLzn8QFicUibbfick8bVkyB4RF5kVns8IiaLZTQ/640?wx_fmt=png" alt=""></p>
<p>从结果中可以看出，ChatRule的性能随着各个组件的增加而逐渐提高，即加入规则样本后，ChatRule的性能得到了显著提高，这说明了在规则挖掘中加入图结构信息的重要性。通过应用求和、排序和验证，聊天规则的性能得到了进一步提高。这说明这些组件可以进一步完善规则并提高ChatRule的性能。</p>
<p><strong>其次，规则排序所采用的各项指标（即覆盖率、置信度和PCA置信度）的有效性。</strong> 所有规则都是在Family和WN18RR数据集上由GPT-4生成的。结果如表5所示。</p>
<p>从结果可以看出，与无排序措施（即无）相比，采用排序措施后，聊天规则的所有性能都得到了提高。这说明排序措施可以有效降低低质量规则的影响。</p>
<p>在所有排序方法中，PCA置信度的性能最好。这表明PCA置信度能够量化不完整KG中规则的质量，并选出具有更好普适性的规则，这也被选为最终的排序指标。</p>
<p><strong>最后，CoT验证分析。</strong> 在实验中，评估了使用不同LLM（如ChatGPT和GPT-4）进行CoT规则验证的性能。所有规则都是由GPT-4在Family和WN18RR数据集上生成的，结果如表6所示，从结果可以看出，GPT-4的性能比ChatGPT更好。这表明GPT-4具有更好的逻辑推理能力，可以识别隐含的逻辑联系并检查规则的有效性。</p>
<h4 id="总结">总结</h4>
<p>本文主要介绍了**《ChatRule: Mining Logical Rules with Large Language Models for Knowledge Graph Reasoning》** 这一工作，这个工作给了一个较好的思路，也将知识图谱规则挖掘的思路进行了一些重温，里面所提到的一些方法可以进一步地去拓展。<strong>‍‍‍‍‍‍‍‍‍‍‍‍‍‍</strong></p>
<p>进行知识图谱推理规则挖掘，基本思想很简单，给定种子规则，针对规则来生成进一步的规则候选，然后利用打分函数对规则进行打分排序，最终形成最终的挖掘结果。其核心就是采样以及规则的打分。</p>
<p>不过，尽管ChatRule工作在某些任务上取得了较好结果，但严重依赖于关系的语义。即使可以提供抽样规则来促使LLM理解图结构，但如果关系的语义没有明确给出，LLM仍然无法生成高质量的规则。</p>
<p>针对本文说的那个提示问题，我们将从下一个文章中进行介绍。‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍</p>
<h4 id="参考文献">参考文献</h4>
<p>1、https://arxiv.org/pdf/2309.01538.pdf</p>
<p>2、https://arxiv.org/abs/2309.03409<strong>‍</strong></p>
<h4 id="关于我们">关于我们</h4>
<p>老刘，刘焕勇，NLP开源爱好者与践行者，主页：https://liuhuanyong.github.io。</p>
<p>老刘说NLP，将定期发布语言资源、工程实践、技术总结等内容，欢迎关注。</p>
<p><strong>对于想加入更优质的知识图谱、事件图谱、大模型AIGC实践、相关分享的，可关注公众号，在后台菜单栏中点击会员社区-&gt;会员入群加入。</strong></p>
<p>更多AI工具，参考<a href="https://aibard123.com/">Github-AiBard123</a>，<a href="https://aibard123.com/">国内AiBard123</a></p>



          </div>

可关注我们的公众号：每天AI新工具

<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


