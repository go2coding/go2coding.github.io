

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>如果我在OpenAI训GPT4 作者： AINLP 来源： AINLP 一个 NLP 人的意淫。 感恩 SemiAnalysis 透露的细节，仿佛拼图，之前东一块西一块，突然从天而降一大块，就在正中间，一下让整个拼图有了大概形状。 FBI WARNING ：OpenAI 并没公开太多训练细节，不保证下面所提为真实，基本是东拼西凑加自我发挥，就当虚构文章看  | AiBard123| ai工具网址导航,ai最新产品</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AI聊天,AI文本生成,AI绘画,AI编程,AI电商" />
    <meta name="description" content="AiBard123 网址导航 | 免费chatgpt 汇集各类先进的人工智能产品，旨在帮助用户更快速地了解和使用这些产品,轻松地浏览不同领域的AI产品，包括语音识别、图像处理、自然语言处理。" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://aibard123.com/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                        </a>
                        <a href="https://aibard123.com/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>本月热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>热门网站</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>国内热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>对话工具</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>写作</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像处理</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音视频</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音乐生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>办公</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>提示词</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>编程</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AI搜索</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>文本翻译</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>学习网站</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>友情链接</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AiBard123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AiBard123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AiBard123| ai工具网址导航,ai最新产品">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI 文摘
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">如果我在OpenAI训GPT4</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://aibard123.com/about>AiBard123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              July 22, 2023 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/Gyc8xouDEr2Hoaz9HWxicoItZPTQJQcO4K7TYfH1T9098beZZQWxUrymrsdj64wfGjCPibv9UB1iagO4U0vbftAfg/640?wx_fmt=jpeg" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <p>作者： AINLP  来源： <a href="https://mp.weixin.qq.com/s/rE3vdZ8mYK5_Hwx_GlF9kQ">AINLP</a></p>
<blockquote>
<p>一个 NLP 人的意淫。</p>
<p>感恩 SemiAnalysis 透露的细节，仿佛拼图，之前东一块西一块，突然从天而降一大块，就在正中间，一下让整个拼图有了大概形状。</p>
<p><strong>FBI WARNING</strong> ：OpenAI 并没公开太多训练细节，不保证下面所提为真实，基本是东拼西凑加自我发挥，就当虚构文章看吧。</p>
<p><strong>PS</strong> ：FlashAttention2 和 LLAMA2 出来都还没来得及看，To-Read 还一大堆，落后的学习速度完全赶不上先进的开源速度，不知道是开心还是难过hh</p>
</blockquote>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/nW2ZPfuYqSJuK8UUBxdZXj1c20hUg374YPgXibgDGytAy87YxvVk4WCRFWrdKJPshStrlPJp4vGEGUQodxt7ibOw/640?wx_fmt=jpeg" alt=""></p>
<p>时间回到2021年9月，我，Andy，正式加入 OpenAI，着实花了不少功夫。</p>
<p>大概 2020 年中 GPT3 发布了，于是我司也算开始正式商业化了，开放 API 搭建使用平台，拿了微软爸爸钱帮爸爸干活。过去一年里也开始收紧战略，将人力都往 GPT 方向转，之前做音频，图像相关也都暂时不作为重点。不久前整个机器人团队还被解散了呢。而关于 GPT3 发布前的历史，可以看我好朋友总结的博客《<a href="http://mp.weixin.qq.com/s?__biz=MjM5ODkzMzMwMQ==&amp;mid=2650420366&amp;idx=1&amp;sn=b596d82fcdc09339fc5af3e179859f97&amp;chksm=becdb2d489ba3bc2e1480935e3f6edfcab84e2489800eba8081b08456ed964fac8801279be88&amp;scene=21#wechat_redirect">GPTの野望</a>》，中二是中二了点，但不失为一篇佳文。</p>
<p>NLP 方向会比机器人好做，因为数据较充足，能快速迭代。且我司已搭建了一个非常好的标注团队，听说最近对齐团队要放出一个对书籍总结的强化学习相关研究。去年就有个类似工作，看来这一年是花了不少时间磨合标注团队，还有将整个流程规模化起来。</p>
<p>啊，忘说了，我被招进来主要负责 NLP 预训练方向，算是 Capability 侧的人。之前也有过相关经验，对分布式训练架构也还算熟。</p>
<h4 id="数据">数据</h4>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/Gyc8xouDEr2Hoaz9HWxicoItZPTQJQcO4DNcGiaYdE0RbvodJETRwLiagbRdyJDoIgMza7rCreLyZAvticZjmBh7PQ/640?wx_fmt=png" alt=""></p>
<p>由机器人团队的事，就可见现在数据驱动范式研究中数据的重要性，不光是<strong>迭代速度，还影响性能</strong> 。</p>
<p>从去年 GPT3 到现在节点，听同事介绍，主要进展是满足用户一些需求，比如 Retrieval-based、插入编辑的需求、少量数据finetune泛化等等。</p>
<p>预训练侧，比较大动静就是做 CodeX 模型，投入不少人，但也获得了不少关于代码数据的 Insight，比如发现自然语言混进较高比例代码数据对性能影响，并不会导致自然语言任务性能下降，还会对符号推理有一定提升。</p>
<p>所以最近数据团队又整体收集了一大批高质量的自然语言数据，加上代码数据，用于训练。</p>
<p>关于数据来源，因为之前探索，发现数据量特别是高质量数据，对基座模型的性能影响很大，所以是想方设法找高质量数据，有传闻包括了：</p>
<ul>
<li>
<p>Libgen，Z-library 这样电子书网站中的电子书</p>
</li>
<li>
<p>还有不光是 Arxiv 这样公开预印论文网站，还有 Scihub 这样无版权论文网站</p>
</li>
<li>
<p>当然 Github 全站也都有，也没管许可</p>
</li>
</ul>
<p>这些如果能都用上，一定能训练出能力强大的基模型，对之后工作有了信心，预训练主要就得靠数据了，其他都能慢慢解决。</p>
<p>而老板们给到的目标，却不光是单单给预训练性能提上去，经过一年商业化尝试，发现不能光是增大规模一把梭哈，给单纯性能指标提上去。还要考虑训练和推理的效率平衡，首先<strong>预训练完后性能要有一个很大的提升</strong> ，而且之后<strong>推理时消耗也要让大家用得起</strong> 。</p>
<h4 id="一年的尝试">一年的尝试</h4>
<p>于是给之前经验汇总起来，基于新的一批数据开始训模型。</p>
<p>我们实验了各种数据的配比，确定了一个较好值。而且训练时逐步增加长度，增大长度这是一些应用场景需求，原始 GPT3 的 2048 长度不太够，这次我们增大到了 4096. 还训练了更长的时间，而不仅仅是 300B 的 Token 数量，因为发现对于大模型 300B tokens 远远不够。</p>
<p>于是我们拿到了一个新的版本，果然在一些能力如长文、代码还有自然语言任务都相比之前模型有一定提升，但却并没有一个质的提升，于是我们称这个模型为 <strong>3.5</strong> 。</p>
<p>之后我们在 Scaling 方面做了些尝试，绘制了更多 Scaling 曲线，发现 GPT3 架构上还能继续 Scaling，也会有收益，但要达到一开始的提升目标，需要给模型 Scale 到非常大规模，但这就导致训练和推理成本都非常高，真是头疼。</p>
<p>于是开始想着要不要尝试其他技术栈，比如说稀疏的 <strong>MoE 模型</strong> ，最近谷歌有些还不错的成果展示。而且正好 22 年年初，入职了一个相关同事，我们讨论了一下可行性。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/Gyc8xouDEr2Hoaz9HWxicoItZPTQJQcO4ujTw5B0P5ByAeibUmobGgkHDFkjVNBuvJ3BOFT2dZa9HWyOAqYqLFicw/640?wx_fmt=jpeg" alt=""></p>
<p>讨论中还遇到一个问题，这位同事参与过 Chinchilla 论文，了解到如果要 Scale 到一个很大规模，现在<strong>数据量是不够的</strong> ，很可能即使模型规模上去了，但因为数据的不足，导致整体性能也还是没太大提升。</p>
<p>一个比较大的担心是没有数据，没有更多高质量数据。现在高质量的 NLP 数据来源基本上都搜集都已经搜集遍了，只能想其他方法了，这时有人提议，现在拿的还只是纯粹以文本形式展现的数据，其实网上<strong>以其他形式表现的文本数据</strong> ，比如音频。</p>
<p>对啊，网络上那么多音频数据，那么多播客、有声书、视频内容，都可以转成文本数据。于是说干就干搜集了大量弱监督数据，训练了一个音频转文本模型，就叫做 Whisper 了。</p>
<p>而且除了音频数据，图像数据也能拿到很多，这样的话，就可以给一些带图的文本数据，还有视频数据更好的利用起来了。至于图片输入就照着 DALLE 的方式弄就行。</p>
<p>调研差不多，可以开始进行新的挑战了。</p>
<h4 id="gpt4-的诞生">GPT4 的诞生</h4>
<p>于是推翻之前技术栈，重新基于 MoE 模型来进行开发，从头开始调研 Scaling Law. 一系列实验下来，一定数据量情况下，确实 MoE 是一个比较有效的 Scale 方法。而且通过曲线预估，可以在达到满意的 Scaling 规模同时，还能在推理上勉强达到需求。</p>
<p>于是大概将模型的规模扩大十倍，因为一次训练成本太高，出于保守起见，先只用了16个专家，每个 111B参数，而共享部分是 55B参数，所以总计大概是 <strong>1831B参数量</strong> ，可以说非常大了，特别还准备投入上线使用。之后推理时，每次前向会走两个专家，加上共享参数也就是 280B 的参数，勉强能抗住。</p>
<p>数据方面，用调配好的数据比例，大概 1 个大 epoch 会包含 1 个 epoch 的自然语言数据，加上 2 个 epoch的代码数据，于是 <strong>1 个 epoch 大概就是 6.5T tokens</strong>  的数据量。之前发现代码配比能占到较大比例，如果按40%算的话，自然语言有 3.9T 的tokens，而代码则是 1.3T 的 tokens.</p>
<p>训练方面，策略方面我们和之前一样，用<strong>课程学习逐步增加 Batch Size 大小</strong> ，一直到 6000万 tokens，逐渐增大长度，但主要在 8k 上进行训练。如果有更长长度的需求，也有专门的长文团队，基于 8k 来进一步训练；分布式方面，我们为了最大化利用 NV-Link 的通讯优势，用了 8 路的 tensor 并行，同时出于硬件方面的限制，用的是 15 路的管道并行。</p>
<p>模型结构方面，完整的 Multi-Head Attention 会带来非常大的 KV-Cache，所以改成了 <strong>Multi-Query Attention</strong> ，虽然性能可能会下降些但在推理时带来的收益是非常大的。最近还出来了一个 <strong>Flash Attention</strong> ，看起来很不错，但保守起见先没上，先做一些实验看看实际效果，这个对长文至关重要。</p>
<p>之后就启动文本 GPT4 的训练了。</p>
<p>过程中，我们会进行阶段性评估，发现当前这个训练策略果然是有效的，非常振奋人心，中间就已经超过了之前的 GPT3.5。这时微软那边想要做相关的分析工作，于是给了他们一个部署的接口，让他们能持续做实验。</p>
<h4 id="chatgpt-小插曲">ChatGPT 小插曲</h4>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/Gyc8xouDEr2Hoaz9HWxicoItZPTQJQcO4K7TYfH1T9098beZZQWxUrymrsdj64wfGjCPibv9UB1iagO4U0vbftAfg/640?wx_fmt=jpeg" alt=""></p>
<p>Alignment 侧的同事们这一年也做得不错，给预训练+SFT+RLHF这条路走通后。在 API 建设中发现，用户喜欢直接给模型指令，因此就直接复用流程做了个 <strong>InstructGPT</strong> . 我试用了一下挺有意思的，就是还主要是单轮，不能和模型讨论，用起来不方便。</p>
<p>出于这个考虑，Alignment 团队开始搜集标注多轮相关的数据，用 InstructGPT 的技术又调了一版，果然交互就自然了很多。</p>
<p>大家讨论了一下就叫 ChatGPT 吧，因为是用 Chat 的方式来进行交互的。</p>
<p>Murati 体验后感觉效果很好，就让公开发布一个版本，于是准备了下放出一版。然后就继续各做各的事情去了。</p>
<p>然而没想到，一刷 Twitter 大家都开始提到 ChatGPT，公司内也都开始讨论起来，用户使用数也不断增加，使得给 ChatGPT 的推理资源，也越来越多了，超出了大家的预期。</p>
<p>一开始以为也就在英文用户圈，毕竟模型都是在英文数据上训练的，结果没想到在全球都开始引起了热议，公司内的人开始被不断找，大家出现了一个共识，<strong>我们火了</strong> 。</p>
<p>明明相同的技术差不多大半年前大家也都知道了，只是简单换了下数据和交互方式，突然就火了，真的申请。但火了肯定是好事，财富自由指日可待。</p>
<p>因为用户量的激增，找微软爸爸借算力，还有对 ChatGPT 模型进行量化降低推理成本马上提上了日程。</p>
<h4 id="gpt4-的发布">GPT4 的发布</h4>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/Gyc8xouDEr2Hoaz9HWxicoItZPTQJQcO4RnkJib5eUg7AL1asiafIj6QNQ7EpXxZpMBoTIP0hTicPJr8Ag0O2U17kg/640?wx_fmt=jpeg" alt=""></p>
<p>同时，因为大家知道了 ChatGPT 后面基座模型是 3.5 模型，于是压力也就给到了我们。</p>
<p>我们需要<strong>发布一个满足大家期待的 GPT4 模型</strong> 。</p>
<p>于是大家也都开始紧锣密鼓地准备 4 的发布，准备三月份发布。多模能力可以先做一个 demo 版本，所以在多模态的数据上只进行了 2T 数据的继续训练。</p>
<p>然后就是一些推理方面的优化，尽量先让用起来，包括推理机器的规划，怎么提高推理时候 GPU 的使用率，而一些推理上通用策略可以直接复用之前 3.5 的经验，比如 Batch 推理，还有 Continuous Batching 减少无用计算等等。量化还需要做大量实验，之后再做。</p>
<p>解码时，可以用前段时间提出来的，<strong>Speculative Decoding</strong> . 自回归生成文本中，有简单部分和困难部分，让 4 模型来处理难的就行，用一个更简单推理成本更低的模型处理简单的，一次生成几个 token，然后让 4 模型看看，OK 就接受，不行就打回自己生成。</p>
<p>发布后，果然访问量直接炸了，用户也觉得能力确实有很大提升，我们算是基本完成了我们的任务。放出了4接口之后，算力却彻底吃紧了，本来大家算力还比较余裕，突然就捉襟见肘，很多实验都开展不起来，只能先让给推理。</p>
<p>所以 4 的 32k，还有多模接口完全不敢放出去，算力根本扛不住。</p>
<p>现在第一优先级就是<strong>降低 4 的推理成本</strong> ，目标是如 3.5 Turbo 一样不降低性能给推理成本降低10倍。一些临时方案只能是如降低 Speculative Decoding 的拒绝概率这样，但看网友反应好像觉得性能下降了。</p>
<p>等给 Long-Context 的场景解决了，再考虑多模态的事情。而现在用接口的人越来越多，而且还有很多创业公司，于是各种需求也要开发，调工具啊，Code Interpreter啊，stateful api啊，低成本 finetune 啊。</p>
<p>害，会忙碌好一阵子了。</p>
<pre><code>**进技术交流群请添加AINLP小助手微信（id: ainlp2)**   


**请备注具体方向+所用到的相关技术点** 

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/nW2ZPfuYqSJADkmZ2IX6Z23znAibuEevotDMq9iaMxiapK7jfMibiauGFkycicAJEs6x5U9SGyDJZ0S1tRed9TPNUUDQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1)



**关于AINLP** 

AINLP 是一个有趣有AI的自然语言处理社区，专注于 AI、NLP、机器学习、深度学习、推荐算法等相关技术的分享，主题包括LLM、预训练模型、自动生成、文本摘要、智能问答、聊天机器人、机器翻译、知识图谱、推荐系统、计算广告、招聘信息、求职经验分享等，欢迎关注！加技术交流群请添加AINLP小助手微信(id：ainlp2)，备注工作/研究方向+加群目的。

  


  


![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/nW2ZPfuYqSKABHCqVVQkVYPrM4XY1vsd0iaeuXzyJnoFc8cibd5mYb4wdA3WMQtiaPVmr0XLZHMuVibqWncibpnTSnQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1)

**阅读至此了，分享、点赞、在看三选一吧🙏** 
</code></pre>
<p>更多AI工具，参考<a href="https://aibard123.com/">Github-AiBard123</a>，<a href="https://aibard123.com/">国内AiBard123</a></p>



          </div>

可关注我们的公众号：每天AI新工具

<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


