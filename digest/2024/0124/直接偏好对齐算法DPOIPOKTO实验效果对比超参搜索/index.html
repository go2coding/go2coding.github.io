

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>ç›´æ¥åå¥½å¯¹é½ç®—æ³•ï¼ˆDPOã€IPOã€KTOï¼‰å®éªŒæ•ˆæœå¯¹æ¯”ã€è¶…å‚æœç´¢ ä½œè€…ï¼š NLPå‰æ²¿ æ¥æºï¼š NLPå‰æ²¿ https://huggingface.co/blog/pref-tuning introduction è¿™ç¯‡æ–‡ç« æ˜¯å…³äºå¯¹ä¸‰ç§çƒ­é—¨çš„LLMå¯¹é½ç®—æ³•è¿›è¡Œå®è¯è¯„ä¼°ï¼šDirect Preference Optimization (DPO)ã€Identity Preference Optimisation (IPO)å’ŒKahneman-Tversky Optimisation (KTO)ã€‚æˆ‘ä»¬åœ¨ä¸¤ä¸ªç»è¿‡ç›‘ç£å¾®è°ƒä½†æœªè¿›è¡Œåå¥½å¯¹é½çš„é«˜è´¨  | AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AIèŠå¤©,AIæ–‡æœ¬ç”Ÿæˆ,AIç»˜ç”»,AIç¼–ç¨‹,AIç”µå•†" />
    <meta name="description" content="AiBard123 ç½‘å€å¯¼èˆª | å…è´¹chatgpt æ±‡é›†å„ç±»å…ˆè¿›çš„äººå·¥æ™ºèƒ½äº§å“ï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·æ›´å¿«é€Ÿåœ°äº†è§£å’Œä½¿ç”¨è¿™äº›äº§å“,è½»æ¾åœ°æµè§ˆä¸åŒé¢†åŸŸçš„AIäº§å“ï¼ŒåŒ…æ‹¬è¯­éŸ³è¯†åˆ«ã€å›¾åƒå¤„ç†ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€‚" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://aibard123.com/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                        </a>
                        <a href="https://aibard123.com/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>æœ¬æœˆçƒ­é—¨</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>çƒ­é—¨ç½‘ç«™</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>å›½å†…çƒ­é—¨</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>å¯¹è¯å·¥å…·</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>å†™ä½œ</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>å›¾åƒç”Ÿæˆ</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>å›¾åƒå¤„ç†</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>éŸ³è§†é¢‘</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>éŸ³ä¹ç”Ÿæˆ</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>åŠå…¬</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>æç¤ºè¯</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>ç¼–ç¨‹</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AIæœç´¢</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>æ–‡æœ¬ç¿»è¯‘</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>å­¦ä¹ ç½‘ç«™</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>å‹æƒ…é“¾æ¥</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>é¦–é¡µ</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">ç–å½±æ¨ªæ–œæ°´æ¸…æµ…ï¼Œæš—é¦™æµ®åŠ¨æœˆé»„æ˜ã€‚</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI æ–‡æ‘˜
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">ç›´æ¥åå¥½å¯¹é½ç®—æ³•ï¼ˆDPOã€IPOã€KTOï¼‰å®éªŒæ•ˆæœå¯¹æ¯”ã€è¶…å‚æœç´¢</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://aibard123.com/about>AiBard123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              January 24, 2024 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/4d6kn6AwWwwicvFZIyXkDFiaHKuiaHkjewlLwXIMIFtr14CuxCPo02CYibSvG3JyJfO7iaTNebGmGiauEWBhA91oNO6A/640?wx_fmt=png&amp;from=appmsg" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <p>ä½œè€…ï¼š NLPå‰æ²¿  æ¥æºï¼š <a href="https://mp.weixin.qq.com/s/RbVNR1acA1gB0nixVK6qnQ">NLPå‰æ²¿</a></p>
<pre><code>https://huggingface.co/blog/pref-tuning  
</code></pre>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/4d6kn6AwWwwicvFZIyXkDFiaHKuiaHkjewlN7F8nxrN58zKy3PFicEueoedK1bRXoC37h9Dvp0sxaicQxbgDrx8WbUQ/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<h4 id="heading"></h4>
<h4 id="introduction">introduction</h4>
<p>è¿™ç¯‡æ–‡ç« æ˜¯å…³äºå¯¹ä¸‰ç§çƒ­é—¨çš„LLMå¯¹é½ç®—æ³•è¿›è¡Œå®è¯è¯„ä¼°ï¼šDirect Preference Optimization (DPO)ã€Identity Preference Optimisation (IPO)å’ŒKahneman-Tversky Optimisation (KTO)ã€‚æˆ‘ä»¬åœ¨ä¸¤ä¸ªç»è¿‡ç›‘ç£å¾®è°ƒä½†æœªè¿›è¡Œåå¥½å¯¹é½çš„é«˜è´¨é‡7b LLMä¸Šè¿›è¡Œäº†å®éªŒã€‚æˆ‘ä»¬å‘ç°ï¼Œè™½ç„¶æœ‰ä¸€ç§ç®—æ³•æ˜æ˜¾ä¼˜äºå…¶ä»–ç®—æ³•ï¼Œä½†å¿…é¡»è°ƒæ•´å…³é”®è¶…å‚æ•°æ‰èƒ½è·å¾—æœ€ä½³ç»“æœã€‚</p>
<h4 id="ä¸ä¾èµ–å¼ºåŒ–å­¦ä¹ çš„å¯¹é½ç®—æ³•">ä¸ä¾èµ–å¼ºåŒ–å­¦ä¹ çš„å¯¹é½ç®—æ³•</h4>
<p>ç›´æ¥åå¥½ä¼˜åŒ–ï¼ˆDPOï¼‰å·²ç»æˆä¸ºå°†å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰ä¸äººç±»æˆ–AIåå¥½å¯¹é½çš„ä¸€ç§æœ‰å‰é€”çš„æ›¿ä»£æ–¹æ³•ã€‚ä¸ä¼ ç»Ÿçš„åŸºäºå¼ºåŒ–å­¦ä¹ çš„å¯¹é½æ–¹æ³•ä¸åŒï¼ŒDPOå°†å¯¹é½å…¬å¼é‡æ–°æ„å»ºä¸ºä¸€ä¸ªç®€å•çš„æŸå¤±å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥åœ¨åå¥½æ•°æ®é›†ä¸Šè¿›è¡Œä¼˜åŒ– {(x,y_w,y_l)} ï¼Œå…¶ä¸­ x æ˜¯æç¤ºè¯ï¼Œy_w,y_l åˆ†åˆ«æ˜¯é¦–é€‰å’Œä¸é¦–é€‰çš„å›åº”ç­”æ¡ˆã€‚</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/4d6kn6AwWwwicvFZIyXkDFiaHKuiaHkjewl1wkoWctiaHlG8UudUbnYHSDFZsyb6oDzNlGH8tuq7FgNLtKSzaJVZiaw/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p>è¿™ä½¿å¾—DPOåœ¨å®è·µä¸­å˜å¾—ç®€å•æ˜“ç”¨ï¼Œå¹¶å·²æˆåŠŸåº”ç”¨äºè®­ç»ƒè¯¸å¦‚Zephyrå’Œè‹±ç‰¹å°”çš„NeuralChatç­‰æ¨¡å‹ã€‚</p>
<p>DPOçš„æˆåŠŸä¿ƒä½¿ç ”ç©¶äººå‘˜æ²¿ç€ä¸¤ä¸ªä¸»è¦æ–¹å‘å¼€å‘æ–°çš„æŸå¤±å‡½æ•°ï¼Œä»¥æ¨å¹¿è¯¥æ–¹æ³•ã€‚</p>
<ul>
<li>
<p>é²æ£’æ€§ï¼šDPO çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯å®ƒå¾€å¾€å¾ˆå¿«åœ¨åå¥½æ•°æ®é›†ä¸Šè¿‡æ‹Ÿåˆã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œè°·æ­ŒDeepMindçš„ç ”ç©¶äººå‘˜å¼•å…¥äº†Identity Preference Optimisation (IPO)ï¼Œå®ƒåœ¨DPOæŸå¤±ä¸­æ·»åŠ äº†ä¸€ä¸ªæ­£åˆ™åŒ–é¡¹ï¼Œä½¿å¾—å¯ä»¥è®­ç»ƒæ¨¡å‹æ”¶æ•›è€Œæ— éœ€ä½¿ç”¨æå‰åœæ­¢ç­‰æŠ€å·§ã€‚</p>
</li>
<li>
<p>æ”¾å¼ƒé…å¯¹çš„åå¥½æ•°æ®ï¼šä¸å¤§å¤šæ•°å¯¹é½æ–¹æ³•ä¸€æ ·ï¼ŒDPO éœ€è¦ä¸€ç»„é…å¯¹åå¥½æ•°æ® { (x, y_w, y_l) }ï¼Œå…¶ä¸­æ ‡æ³¨äººå‘˜æ ¹æ®è¯¸å¦‚å¸®åŠ©æ€§æˆ–æœ‰å®³æ€§ä¹‹ç±»çš„æ ‡å‡†æ ‡è®°å“ªä¸ªç­”æ¡ˆæ›´å¥½ã€‚å®é™…ä¸Šï¼Œåˆ›å»ºè¿™äº›æ•°æ®é›†æ˜¯ä¸€é¡¹è€—æ—¶ä¸”æˆæœ¬é«˜æ˜‚çš„å·¥ä½œã€‚ContextualAI æœ€è¿‘æå‡ºäº†ä¸€ä¸ªæœ‰è¶£çš„æ›¿ä»£æ–¹æ¡ˆï¼Œç§°ä¸º Kahneman-Tversky ä¼˜åŒ–ï¼ˆKTOï¼‰ï¼Œå®ƒå®Œå…¨æ ¹æ®å·²æ ‡è®°ä¸ºâ€œå¥½â€æˆ–â€œåâ€çš„ä¸ªåˆ«ç¤ºä¾‹å®šä¹‰æŸå¤±å‡½æ•°ï¼ˆä¾‹å¦‚ï¼Œåœ¨èŠå¤©ç•Œé¢ä¸­çœ‹åˆ°çš„ğŸ‘æˆ–ğŸ‘å›¾æ ‡ï¼‰ã€‚è¿™äº›æ ‡ç­¾åœ¨å®è·µä¸­æ›´å®¹æ˜“è·å–ï¼ŒKTO æ˜¯ä¸æ–­æ›´æ–°åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œçš„èŠå¤©æ¨¡å‹çš„ä¸€ç§æœ‰å‰é€”çš„æ–¹å¼ã€‚</p>
</li>
</ul>
<p>ä¸æ­¤åŒæ—¶ï¼Œè¿™äº›å„ç§æ–¹æ³•éƒ½å¸¦æœ‰è¶…å‚æ•°ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯ Î²ï¼Œå®ƒæ§åˆ¶ç€å¯¹å‚è€ƒæ¨¡å‹åå¥½çš„æƒé‡ã€‚ä¸€ä¸ªè‡ªç„¶çš„é—®é¢˜å°±æ˜¯å“ªç§æ–¹æ³•å’Œè¶…å‚æ•°èƒ½å¤Ÿäº§ç”Ÿæœ€å¥½çš„èŠå¤©æ¨¡å‹ï¼Ÿ æœ¬æ–‡æ—¨åœ¨é€šè¿‡å¯¹ä¸‰ç§æ–¹æ³•è¿›è¡Œå®è¯åˆ†ææ¥å›ç­”è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å°†å¯¹å…³é”®è¶…å‚æ•°ï¼ˆå¦‚ Î² å’Œè®­ç»ƒæ­¥éª¤ï¼‰è¿›è¡Œæ‰«æï¼Œç„¶åé€šè¿‡ MT-Bench è¯„ä¼°æ‰€å¾—æ¨¡å‹çš„æ€§èƒ½ï¼ˆè¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„åŸºå‡†æµ‹è¯•æ¥è¡¡é‡èŠå¤©æ¨¡å‹çš„èƒ½åŠ›ï¼‰ã€‚</p>
<p>ä»£ç åœ¨</p>
<pre><code>https://github.com/huggingface/alignment-handbook  
</code></pre>
<h4 id="experimental-setup">Experimental Setup</h4>
<p>åœ¨æ‰§è¡Œå¯¹é½å®éªŒæ—¶ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦å› ç´ éœ€è¦è€ƒè™‘ï¼šæˆ‘ä»¬é€‰æ‹©ä¼˜åŒ–çš„æ¨¡å‹å’Œå¯¹é½æ•°æ®é›†ã€‚ä¸ºäº†è·å¾—æ›´å¤šç‹¬ç«‹çš„æ•°æ®ç‚¹ï¼Œæˆ‘ä»¬è€ƒè™‘äº†ä¸¤ä¸ªæ¨¡å‹ï¼ŒOpenHermes-2.5-Mistral-7B å’Œ Zephyr-7b-beta-sftï¼Œä»¥åŠä¸¤ä¸ªå¯¹é½æ•°æ®é›† Intel çš„ orca_dpo_pairs å’Œ ultrafeedback-binarized æ•°æ®é›†ã€‚</p>
<p>åœ¨ç¬¬ä¸€ä¸ªå®éªŒä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† OpenHermes-2.5-Mistral-7Bï¼Œå› ä¸ºå®ƒæ˜¯æœ€ä½³çš„ 7B å‚æ•°èŠå¤©æ¨¡å‹ä¹‹ä¸€ï¼Œå°šæœªç»è¿‡ä»»ä½•å¯¹é½æŠ€æœ¯ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨äº† Intel çš„ orca_dpo_pairs æ•°æ®é›†ï¼Œå…¶ä¸­åŒ…å« 13,000 ä¸ªæç¤ºï¼Œå…¶ä¸­é€‰æ‹©çš„å“åº”ç”± GPT-4 ç”Ÿæˆï¼Œä¸å¸Œæœ›çš„å“åº”ç”± Llama-Chat 13b ç”Ÿæˆã€‚è¿™æ˜¯ NeuralChat å’Œ NeuralHermes-2.5-Mistral-7B èƒŒåçš„æ•°æ®é›†ã€‚ç”±äº KTO å¹¶ä¸éœ€è¦æˆå¯¹çš„åå¥½ï¼Œæˆ‘ä»¬ç®€å•åœ°å°† GPT-4 çš„å“åº”è§†ä¸ºâ€œå¥½â€çš„æ ‡ç­¾ï¼Œå°† Llama-Chat 13b çš„å“åº”è§†ä¸ºâ€œåâ€çš„æ ‡ç­¾ã€‚è™½ç„¶ GPT-4 çš„å“åº”å¾ˆå¯èƒ½æ¯” Llama-Chat 13b æ›´å—æ¬¢è¿ï¼Œä½†ä¹Ÿå¯èƒ½æœ‰ä¸€äº›æƒ…å†µä¸‹ Llama-Chat-13b ä¼šäº§ç”Ÿæ›´å¥½çš„å“åº”ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ä»£è¡¨äº†å°‘æ•°ä¾‹å­ã€‚</p>
<p>ç¬¬äºŒä¸ªå®éªŒå¯¹ Zephyr-7b-beta-sft æ¨¡å‹æ‰§è¡Œäº†åå¥½å¯¹é½ï¼Œä½¿ç”¨äº† ultrafeedback-binarized æ•°æ®é›†ï¼Œå…¶ä¸­åŒ…å«äº† 66,000 ä¸ªæç¤ºå’Œé€‰æ‹©ä¸æ‹’ç»çš„å“åº”å¯¹ã€‚è¿™ä¸ªæ•°æ®é›†è¢«ç”¨æ¥è®­ç»ƒåŸå§‹çš„ Zephyr æ¨¡å‹ï¼Œåœ¨å½“æ—¶å®ƒæ˜¯ 7B æ¨¡å‹ä¸­åœ¨ä¼—å¤šè‡ªåŠ¨åŒ–åŸºå‡†æµ‹è¯•å’Œäººç±»è¯„ä¼°ä¸­è¡¨ç°æœ€ä½³çš„æ¨¡å‹ã€‚</p>
<h4 id="configuring-the-experiments">Configuring the experiments</h4>
<pre><code>#Â ModelÂ arguments  
model_name_or_path:Â teknium/OpenHermes-2.5-Mistral-7B  
torch_dtype:Â null  
  
#Â DataÂ trainingÂ arguments  
dataset_mixer:  
Â Â HuggingFaceH4/orca_dpo_pairs:Â 1.0  
dataset_splits:  
-Â train_prefs  
-Â test_prefs  
preprocessing_num_workers:Â 12  
  
#Â TrainingÂ argumentsÂ withÂ sensibleÂ defaults  
bf16:Â true  
beta:Â 0.01  
loss_type:Â sigmoid  
do_eval:Â true  
do_train:Â true  
evaluation_strategy:Â steps  
eval_steps:Â 100  
gradient_accumulation_steps:Â 2  
gradient_checkpointing:Â true  
gradient_checkpointing_kwargs:  
Â Â use_reentrant:Â False  
hub_model_id:Â HuggingFaceH4/openhermes-2.5-mistral-7b-dpo  
hub_model_revision:Â v1.0  
  
learning_rate:Â 5.0e-7  
logging_steps:Â 10  
lr_scheduler_type:Â cosine  
max_prompt_length:Â 512  
num_train_epochs:Â 1  
optim:Â adamw_torch  
output_dir:Â data/openhermes-2.5-mistral-7b-dpo-v1.0  
per_device_train_batch_size:Â 8  
per_device_eval_batch_size:Â 8  
push_to_hub_revision:Â true  
save_strategy:Â &quot;steps&quot;  
save_steps:Â 100  
save_total_limit:Â 1  
seed:Â 42  
warmup_ratio:Â 0.1  
</code></pre>
<p>æˆ‘ä»¬ä¸º Zephyr å®éªŒåˆ›å»ºäº†ä¸€ä¸ªç±»ä¼¼çš„åŸºç¡€é…ç½®æ–‡ä»¶ã€‚èŠå¤©æ¨¡æ¿æ˜¯ä»åŸºç¡€èŠå¤©æ¨¡å‹è‡ªåŠ¨æ¨æ–­å‡ºæ¥çš„ï¼ŒOpenHermes-2.5 ä½¿ç”¨ ChatML æ ¼å¼ï¼Œè€Œ Zephyr ä½¿ç”¨ H4 èŠå¤©æ¨¡æ¿ã€‚æˆ–è€…ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨è‡ªå·±çš„èŠå¤©æ ¼å¼ï¼Œtokenizers åº“ç°åœ¨å·²ç»å¯ç”¨äº†ä½¿ç”¨ jinja æ ¼å¼å­—ç¬¦ä¸²æ¥å®šä¹‰ç”¨æˆ·è‡ªå®šä¹‰çš„èŠå¤©æ¨¡æ¿ã€‚</p>
<pre><code>#Â ExampleÂ ofÂ theÂ ZephyrÂ chatÂ template  
&quot;{%Â forÂ messageÂ inÂ messagesÂ %}\n{%Â ifÂ message['role']Â ==Â 'user'Â %}\n{{Â '&lt;|user|&gt;\n'Â +Â message['content']Â +Â eos_tokenÂ }}\n{%Â elifÂ message['role']Â ==Â 'system'Â %}\n{{Â '&lt;|system|&gt;\n'Â +Â message['content']Â +Â eos_tokenÂ }}\n{%Â elifÂ message['role']Â ==Â 'assistant'Â %}\n{{Â '&lt;|assistant|&gt;\n'Â Â +Â message['content']Â +Â eos_tokenÂ }}\n{%Â endifÂ %}\n{%Â ifÂ loop.lastÂ andÂ add_generation_promptÂ %}\n{{Â '&lt;|assistant|&gt;'Â }}\n{%Â endifÂ %}\n{%Â endforÂ %}&quot;  
</code></pre>
<p>å°†å¯¹è¯æ ¼å¼åŒ–å¦‚ä¸‹ï¼š</p>
<pre><code>#Â &lt;|system|&gt;  
#Â YouÂ areÂ aÂ friendlyÂ chatbotÂ whoÂ alwaysÂ respondsÂ inÂ theÂ styleÂ ofÂ aÂ pirate.&lt;/s&gt;  
#Â &lt;|user|&gt;  
#Â HowÂ manyÂ helicoptersÂ canÂ aÂ humanÂ eatÂ inÂ oneÂ sitting?&lt;/s&gt;  
#Â &lt;|assistant|&gt;  
#Â Ah,Â meÂ heartyÂ matey!Â ButÂ yerÂ questionÂ beÂ aÂ puzzler!Â AÂ humanÂ cannotÂ eatÂ aÂ helicopterÂ inÂ oneÂ sitting,Â asÂ helicoptersÂ areÂ notÂ edible.Â TheyÂ beÂ madeÂ ofÂ metal,Â plastic,Â andÂ otherÂ materials,Â notÂ food!  
</code></pre>
<h4 id="hyperparameter-sweep">Hyperparameter Sweep</h4>
<p>æˆ‘ä»¬é€šè¿‡ è°ƒæ•´TRL DPOTrainer çš„ loss_type å‚æ•°ï¼Œ è®­ç»ƒäº† DPOã€IPO å’Œ KTO æ–¹æ³•ï¼Œå…¶ä¸­ beta çš„å–å€¼èŒƒå›´ä¸º 0.01ã€0.1ã€0.2ï¼Œç›´åˆ° 0.9ã€‚æˆ‘ä»¬åŒ…æ‹¬äº† 0.01ï¼Œå› ä¸ºæˆ‘ä»¬è§‚å¯Ÿåˆ°ä¸€äº›å¯¹é½ç®—æ³•å¯¹è¿™ä¸ªå‚æ•°ç‰¹åˆ«æ•æ„Ÿã€‚æ‰€æœ‰å®éªŒéƒ½è®­ç»ƒäº†ä¸€ä¸ªepochã€‚åœ¨æ¯æ¬¡è¿è¡Œä¸­ï¼Œæ‰€æœ‰å…¶ä»–è¶…å‚æ•°éƒ½ä¿æŒä¸å˜ï¼ŒåŒ…æ‹¬éšæœºç§å­ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬åœ¨ Hugging Face é›†ç¾¤ä¸Šå¯åŠ¨äº†åŸºäºä¸Šè¿°åŸºæœ¬é…ç½®çš„æ‰«æã€‚</p>
<pre><code>#!/bin/bash  
#Â DefineÂ anÂ arrayÂ containingÂ theÂ baseÂ configsÂ weÂ wishÂ toÂ fineÂ tune  
configs=(&quot;zephyr&quot;Â &quot;openhermes&quot;)  
#Â DefineÂ anÂ arrayÂ ofÂ lossÂ types  
loss_types=(&quot;sigmoid&quot;Â &quot;kto_pair&quot;Â &quot;ipo&quot;)  
#Â DefineÂ anÂ arrayÂ ofÂ betaÂ values  
betas=(&quot;0.01&quot;Â &quot;0.1&quot;Â &quot;0.2&quot;Â &quot;0.3&quot;Â &quot;0.4&quot;Â &quot;0.5&quot;Â &quot;0.6&quot;Â &quot;0.7&quot;Â &quot;0.8&quot;Â &quot;0.9&quot;)  
  
#Â OuterÂ loopÂ forÂ lossÂ types  
forÂ configÂ inÂ &quot;${configs[@]}&quot;;Â do  
Â Â Â Â forÂ loss_typeÂ inÂ &quot;${loss_types[@]}&quot;;Â do  
Â Â Â Â Â Â Â Â #Â InnerÂ loopÂ forÂ betaÂ values  
Â Â Â Â Â Â Â Â forÂ betaÂ inÂ &quot;${betas[@]}&quot;;Â do  
Â Â Â Â Â Â Â Â Â Â Â Â #Â DetermineÂ theÂ jobÂ nameÂ andÂ modelÂ revisionÂ basedÂ onÂ lossÂ type  
Â Â Â Â Â Â Â Â Â Â Â Â job_name=&quot;$config_${loss_type}_beta_${beta}&quot;  
Â Â Â Â Â Â Â Â Â Â Â Â model_revision=&quot;${loss_type}-${beta}&quot;  
Â Â Â Â Â Â Â Â Â Â Â Â #Â SubmitÂ theÂ job  
Â Â Â Â Â Â Â Â Â Â Â Â sbatchÂ --job-name=${job_name}Â recipes/launch.slurmÂ dpoÂ pref_align_scanÂ config_$configÂ deepspeed_zero3Â \\  
Â Â Â Â Â Â Â Â Â Â Â Â &quot;--beta=${beta}Â --loss_type=${loss_type}Â --output_dir=data/$config-7b-align-scan-${loss_type}-beta-${beta}Â --hub_model_revision=${model_revision}&quot;  
Â Â Â Â Â Â Â Â done  
Â Â Â Â done  
done  
</code></pre>
<h4 id="results">Results</h4>
<p>æˆ‘ä»¬ä½¿ç”¨MT Benchå¯¹æ‰€æœ‰æ¨¡å‹è¿›è¡Œäº†è¯„ä¼°ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤šè½®å¯¹è¯åŸºå‡†æµ‹è¯•ï¼Œä½¿ç”¨GPT-4æ¥è¯„åˆ¤æ¨¡å‹åœ¨å†™ä½œã€è§’è‰²æ‰®æ¼”ã€æ¨ç†ã€æ•°å­¦ã€ç¼–ç ã€ä¿¡æ¯æå–ã€STEMå’Œäººæ–‡ç­‰å…«ä¸ªä¸åŒç±»åˆ«ä¸­çš„è¡¨ç°ã€‚è™½ç„¶ä¸å®Œç¾ï¼Œä½†MT Benchæ˜¯è¯„ä¼°å¯¹è¯å¼LLMæ€§èƒ½çš„ä¸€ä¸ªå¾ˆå¥½çš„æ–¹å¼ã€‚</p>
<h4 id="zephyr-7b-beta-sft">Zephyr-7b-beta-SFT</h4>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/4d6kn6AwWwwicvFZIyXkDFiaHKuiaHkjewliaVQia43wkAXESdk2LXLEshlJRCkic5HRSIMR4eWwcVAXw2KKV9QvWQXw/640?wx_fmt=png&amp;from=appmsg" alt="">é’ˆå¯¹ Zephyr æ¨¡å‹ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°åœ¨æµ‹è¯•çš„æ‰€æœ‰ç®—æ³•ä¸­ï¼Œæœ€ä½³æ€§èƒ½æ˜¯åœ¨æœ€ä½çš„ Î² å€¼ 0.01 ä¸‹å®ç°çš„ã€‚è¿™ä¸€ç»“æœæ˜¯ä¸€è‡´çš„ã€‚å¯¹ç¤¾åŒºè€Œè¨€ï¼Œä¸€ä¸ªæœ‰è¶£çš„åç»­å®éªŒå¯èƒ½æ˜¯åœ¨ 0.0-0.2 èŒƒå›´å†…è¿›è¡Œç»†ç²’åº¦çš„æ‰«æã€‚è™½ç„¶ DPO å¯ä»¥å®ç°æœ€é«˜çš„ MT Bench åˆ†æ•°ï¼Œä½†æˆ‘ä»¬å‘ç° KTOï¼ˆé…å¯¹ï¼‰åœ¨é™¤ä¸€ä¸ªç»“æœä¹‹å¤–çš„æ‰€æœ‰æƒ…å†µä¸‹éƒ½å–å¾—äº†æ›´å¥½çš„ç»“æœã€‚IPOï¼Œè™½ç„¶å…·æœ‰æ›´å¼ºçš„ç†è®ºä¿è¯ï¼Œä½†åœ¨é™¤ä¸€ä¸ªè®¾ç½®ä¹‹å¤–çš„æ‰€æœ‰æƒ…å†µä¸‹ä¼¼ä¹éƒ½æ¯”åŸºæœ¬æ¨¡å‹å·®ã€‚</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/4d6kn6AwWwwicvFZIyXkDFiaHKuiaHkjewlLwXIMIFtr14CuxCPo02CYibSvG3JyJfO7iaTNebGmGiauEWBhA91oNO6A/640?wx_fmt=png&amp;from=appmsg" alt="">æˆ‘ä»¬å¯ä»¥åˆ†è§£MT Benchè¯„ä¼°çš„æ¯ä¸ªç®—æ³•åœ¨å„ä¸ªç±»åˆ«ä¸­çš„æœ€ä½³ç»“æœï¼Œä»¥ç¡®å®šè¿™äº›æ¨¡å‹çš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿ã€‚åœ¨æ¨ç†ã€ç¼–ç å’Œæ•°å­¦æ–¹é¢ä»æœ‰å¾ˆå¤§çš„æ”¹è¿›ç©ºé—´ã€‚</p>
<h4 id="openhermes-7b-25">OpenHermes-7b-2.5</h4>
<p>å°½ç®¡åœ¨OpenHermesä¸­ï¼Œå¯¹æ¯ä¸ªç®—æ³•çš„è§‚å¯Ÿç»“æœä¿æŒä¸å˜ï¼Œå³DPO &gt; KTO &gt; IPOï¼Œä½†Î²ä¸æ¯ä¸ªç®—æ³•éƒ½æœ‰å¾ˆå¤§å·®å¼‚ã€‚å¯¹äºDPOã€KTOå’ŒIPOæ¥è¯´ï¼Œæœ€ä½³çš„Î²é€‰æ‹©åˆ†åˆ«ä¸º0.6ã€0.3å’Œ0.01ã€‚</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/4d6kn6AwWwwicvFZIyXkDFiaHKuiaHkjewlp0uWqjxTkXE2icQh7ict2p8vc50W6UcVLnmjaD0gLZCh4f5nEJP4MWNA/640?wx_fmt=png&amp;from=appmsg" alt="">OpenHermes-7b-2.5 æ˜æ˜¾æ˜¯ä¸€ä¸ªæ›´å¼ºå¤§çš„åŸºç¡€æ¨¡å‹ï¼Œåœ¨åå¥½å¯¹é½å MT Bench åˆ†æ•°ä»…æé«˜äº† 0.3ã€‚</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/4d6kn6AwWwwicvFZIyXkDFiaHKuiaHkjewlKpRGZicIYg9temQesZ85pL8ST52ia2U8crHZKuCLRFTvINkia1jwayf1A/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<h4 id="summary--insights">Summary &amp; Insights</h4>
<p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å¼ºè°ƒäº†åœ¨æ‰§è¡Œåå¥½å¯¹é½æ—¶é€‰æ‹©æ­£ç¡®çš„è¶…å‚æ•°é›†çš„é‡è¦æ€§ã€‚æˆ‘ä»¬åœ¨é…å¯¹åå¥½è®¾ç½®ä¸­ç»éªŒæ€§åœ°è¯æ˜äº† DPO ä¼˜äº KTOï¼Œå°½ç®¡ IPO åœ¨ç†è®ºä¿è¯æ–¹é¢æ›´å¼ºï¼Œä½†ä¼¼ä¹è¡¨ç°å¹³å¹³ã€‚</p>
<p>æ›´å¤šAIå·¥å…·ï¼Œå‚è€ƒ<a href="https://aibard123.com/">Github-AiBard123</a>ï¼Œ<a href="https://aibard123.com/">å›½å†…AiBard123</a></p>



          </div>

å¯å…³æ³¨æˆ‘ä»¬çš„å…¬ä¼—å·ï¼šæ¯å¤©AIæ–°å·¥å…·

<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('å¤œé—´æ¨¡å¼å¼€å¯');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('å¤œé—´æ¨¡å¼å…³é—­');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","æ—¥é—´æ¨¡å¼");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","å¤œé—´æ¨¡å¼");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


