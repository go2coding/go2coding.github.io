

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>GraphRAG&#43;GPT-4omini低成本构建AI图谱知识库 作者： 知识图谱科技 来源： 知识图谱科技 更好的效果，更低的价格，听起来是不是像梦呓？ 限制 首先，让我们来介绍一个词：RAG。 简单来说，RAG（Retrieval-Augmented Generation，检索增强生成） 的工作原理是将大型文档分割成多  | AiBard123| ai工具网址导航,ai最新产品</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AI聊天,AI文本生成,AI绘画,AI编程,AI电商" />
    <meta name="description" content="AiBard123 网址导航 | 免费chatgpt 汇集各类先进的人工智能产品，旨在帮助用户更快速地了解和使用这些产品,轻松地浏览不同领域的AI产品，包括语音识别、图像处理、自然语言处理。" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://aibard123.com/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                        </a>
                        <a href="https://aibard123.com/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>本月热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>热门网站</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>国内热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>对话工具</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>写作</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像处理</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音视频</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音乐生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>办公</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>提示词</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>编程</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AI搜索</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>文本翻译</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>学习网站</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>友情链接</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AiBard123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AiBard123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AiBard123| ai工具网址导航,ai最新产品">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI 文摘
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">GraphRAG&#43;GPT-4omini低成本构建AI图谱知识库</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://aibard123.com/about>AiBard123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              August 2, 2024 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVaERNHjZ996O7mxqzyoEpkEAic8Pn31s7P9ZAibic9VvicLLmSChaeC9icSg/640?wx_fmt=jpeg&amp;from=appmsg" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <p>作者： 知识图谱科技  来源： <a href="https://mp.weixin.qq.com/s/efe8YEOxfi7gscROJixpOw">知识图谱科技</a></p>
<p>更好的效果，更低的价格，听起来是不是像梦呓？</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVyq5CFIguWo3GyOXRkDAKnibWic0d13L1gcaLIG5528lJ1Vlic9XdF3LEQ/640?wx_fmt=jpeg&amp;from=appmsg" alt=""></p>
<h4 id="限制">限制</h4>
<p>首先，让我们来介绍一个词：RAG。</p>
<p>简单来说，RAG（Retrieval-Augmented Generation，检索增强生成） 的工作原理是将大型文档分割成多个小段落或片段。主要原因是，大语言模型的上下文窗口长度有限，无法一次处理超过上下文窗口长度的信息。</p>
<p>当我提出一个问题时，RAG 技术可以先从这些片段中检索相关信息，根据我提问的内容与这些片段的相似度，找出若干个与问题相关的片段，组合成一个上下文，然后将这些信息，连同我的提问一起输入到大语言模型中，然后期待大语言模型「更为精准」的回答。</p>
<p>然而，我们需要考虑一些潜在的局限性。对于一个足够长的文档和一个非常复杂的问题，单靠这几个（仅仅是疑似相关的）片段可能是不够的。真正的答案，也许根本就不在里面。</p>
<p>我们之前讨论了很多关于私有知识库。例如 Quivr, Elephas, GPTs, Obsidian Copilot …… 用久了你会发现，私有知识库提供的回答结果与通过数据微调模型获得的结果可能差异很大 —— 微调后的模型往往能够依据私有数据回答非常复杂的问题，而 RAG 这种简单粗暴的拼接方式，很多时候得到的答案并不理想。</p>
<h4 id="图谱">图谱</h4>
<p>这些问题就催生了 GraphRAG。GraphRAG 是一种创新的技术，它结合了知识图谱结构和 RAG 方法，旨在解决传统 RAG 方法的局限性。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVvTH8GeLoXwEQPjw79ol0vO45mbXdUjTB2BjrYVJysaRgp9NHDgPS4g/640?wx_fmt=jpeg&amp;from=appmsg" alt=""></p>
<p>这是微软研发的一个创新产品，它代表了 RAG 技术的最新进展。微软还发布了相关的学术论文，详细阐述了 GraphRAG 的理论基础和技术实现。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVFGX9mcBpFfKcSccZF5fvbYwhpYRIq29ktRjeWVtDz56PIfFRkFN6Sw/640?wx_fmt=jpeg&amp;from=appmsg" alt=""></p>
<p>那么，这里的 &ldquo;Graph（图）&rdquo; 究竟是什么意思呢？在 GraphRAG 的主页上，你会看到一个复杂的图谱。这个图谱不仅仅是一个简单的示意图，它代表了知识的结构化表示。在这个图谱中，每个节点可能代表一个概念或实体，而连接这些节点的边则表示它们之间的关系。</p>
<p>假设图谱中有一个节点是「老虎」，另一个是「兔子」，老虎与兔子之间连一条线，上面写着「吃」，代表二者的关联是「老虎吃兔子」。当然，这只是一个不够严谨的比喻。</p>
<p>有了这样的图谱，为什么要将其与刚才提到的 RAG 结合呢？因为之前提到的「满地找碎片」的传统 RAG 方式实际上效果不佳，所以我们希望将这些概念之间的复杂关系展现出来。在查询时，不再是大海捞针去找「可能相关」的信息碎片，而是根据图谱中已经掌握的关联，提取一整串相连的信息，让大语言模型来一并处理。</p>
<p>这里是 GraphRAG 的 GitHub 网址。它在 GitHub 上的受欢迎程度如何？已经获得超过一万一千颗星。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVNUEcLQhQW0bGgcLHRKYnpd3L20LmGwSYd18ibmH48J0sBY9qraK17eA/640?wx_fmt=jpeg&amp;from=appmsg" alt=""></p>
<p>对于一个项目来说，这是一个非常好的成绩，我做梦都希望自己的项目能达到这样的水平。看来还得继续努力。</p>
<h4 id="特点">特点</h4>
<p>我们来看看 GraphRAG 的特点。它融合了人工智能的两大流派，一个是深度学习，另一个是知识图谱。</p>
<p>曾经这两个流派是对立的。后来发现对立干啥啊？</p>
<p>你现在用深度学习直接回答效果不好，但如果结合图谱，效果就会强很多。</p>
<p>另一方面，构建知识图谱原来得人工根据规则去抽取其中的实体和关联，那是一个砸钱堆人力的活计。后来发现用上深度学习可以有效提升实体抽取效率。特别是有了大语言模型，人们发现抽取实体和关联变得更加准确、简单且低成本。所以，二者的融合，是大势所趋。</p>
<p>那么融合之后的 GraphRAG 擅长什么呢？它能够把<strong>实体之间的复杂关系和上下文串联起来</strong> 。</p>
<p>正如刚才我们提到的这个过程，它可以连接多个信息点进行复杂查询。这种查询不是简单地提取一部分信息就能完成的。原先根据相似度找出来的这些信息碎片，可能根本不足以支撑问题解答。但现在，根据实际关联获取相关信息，效果要好很多。</p>
<p>另外 GraphRAG 由于对数据集有了整体的刻画，因此概念语义信息得到了充分的表达。</p>
<p>两个特点相夹持，使得 GraphRAG 的表现有了非常显著的改进。后面的例子里，你也能观察到这点。</p>
<h4 id="局限">局限</h4>
<p>不过，这个技术也不是那么完美。它遇到的问题，最为显著的就是一个字 —— 贵。</p>
<p>官方的例子提到一本书，稍后我们会看到，实体书篇幅大概 200 页左右。把它图谱化 RAG ，需要花多少钱？</p>
<p>11 美金。</p>
<p>有的人觉得这太贵了，为了索引一本电子书耗费的钱都快赶上一本实体书了。</p>
<p>那么我们有没有解决办法呢？我们需要分析。</p>
<p>GraphRAG 实施成本为什么会那么高？因为它使用的是 GPT-4 Turob Preview 模型。这个模型 token 成本较高，由于在图谱构建过程中，需要反复调用它，因此 GraphRAG 成本居高不下。</p>
<p>既然找到了原因，我们是否可以使用一个更经济的模型来替代它呢？</p>
<p>这是个很自然就能联想到的问题。许多人也已经做了尝试。例如，有人尝试在本地运行 Ollama 这样的本地小型模型，但最终效果不好，构建过程中常常出现问题。</p>
<p>有的人使用 Groq 来做，而且成功了，但需要进行不少复杂的设置变更，对于初级用户来说非常麻烦。</p>
<p>最简便的方法，自然是期待 OpenAI 推出一个更经济实惠的模型。</p>
<p>期盼着，期盼着，好消息来了。</p>
<p>OpenAI 最近给我发了信，说它新推出了一个 GPT-4o mini 模型。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVRg8d2QdheZDyBvzPTsPkVvKqMTlyEX2nKquhNmSq8FiazBImTuQxXrQ/640?wx_fmt=jpeg&amp;from=appmsg" alt=""></p>
<p>不要被名称忽悠了——GPT-4o mini 的对标模型，其实是GPT-3.5 Turbo，但它甚至比3.5 Turbo还要便宜60%。</p>
<p>我不得不钦佩 OpenAI 现在的命名方式。如果你把它叫做 GPT 3.5 Turbo Plus，效果可能就不好，因为人们会觉得这不就是一个改进版的 3.5 吗？虽然便宜一点，但依然觉得不太满意。</p>
<p>你把它叫做 GPT-4o mini ，人们就会脑补这是一个好的模型，多模态、快速又便宜。大家就会觉得自己占了便宜，竟然能用一个跟 GPT-4o 对标的模型，居然比原来的 3.5 还便宜那么多，这无论如何，也是个甜买卖啊。</p>
<p>我拿到 GPT-4o mini 的使用权限后，立即测试了一下它的中文写作。我把测试结果分享到了知识星球。</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVlZqaS3xG4ic9ayBUFicfLJYZwaUGAU0XB2KLCd96LhGiaGPSW4MHmoytA/640?wx_fmt=jpeg&amp;from=appmsg" alt=""></p>
<p>不过你不要误解，GPT-4o mini 毕竟是个小模型，你可以指望它的中文输出能力，但千万不要以为它的推理与逻辑思考能力也可以赶上 GPT-4o 或者 Claude 3.5 Sonnet 。所以我是把它放在了工作流里合适的位置上，物尽其用。</p>
<p>突然，我想到 GPT-4o mini 不仅可以用来输出文字，还可以用它和 GraphRAG 「双剑合璧」啊。</p>
<p>想到这里都觉得兴奋不已，那咱们下面就来看看效果究竟如何。</p>
<h4 id="安装">安装</h4>
<p>首先，我们需要把 GraphRAG 安装上，这里使用 pip install
，非常简单。</p>
<p>pip install graphrag</p>
<pre tabindex="0"><code>




它会安装一系列的依赖，包括了 GraphRAG 所需的各种库和工具。安装过程可能需要一些时间，取决于你的网络速度和电脑性能。





![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVSXiajUMC05d4FMm7hljBhciaSkKa1t59xAlySnIcK4F4PNoYWkzHgLpg/640?wx_fmt=jpeg&amp;from=appmsg)





安装完成后，我们找一个目录，新建一个目录，然后在下面执行这一句。



mkdir -p ./ragtest/input


这里的 input 是什么呢？就是我们存放输入的文本 —— 像刚刚提到的 200 页的书或者文章 —— 的地方。

我在 Visual Studio Code 下给你演示吧，比较直观。

执行这条命令后，侧边栏会出现一个新的文件夹。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVnC35vr7DT980YdPF8fpGNl0c3UxNGYl5Y1DLwTHnLwj5mQrrFNqeicg/640?wx_fmt=jpeg&amp;from=appmsg)

接下来，我们要把书籍资料下载下来。这里 GraphRAG 官网样例使用的是古腾堡计划，上面有很多免费的图书。古腾堡计划是一个致力于创建和分发免费电子书的志愿者项目，它提供了大量版权已过期的经典文学作品。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVQxxO84FXphJdgAuADBVzWcvWl9ANO6ia7WPz28ht24RdcxFYJ6NvdfQ/640?wx_fmt=jpeg&amp;from=appmsg)

GraphRAG 官网给的样例是《圣诞颂歌》，是查尔斯・狄更斯创作的一部著名小说，讲述了一个守财奴在圣诞节前夜经历的奇妙故事，最终改变了自己的人生态度。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVQLVmcpkeG3eyA8MPkz9HayJE9ibZ22ghLBRR0emLib7DThhvXVmBx6Dw/640?wx_fmt=jpeg&amp;from=appmsg)

执行下面这条命令下载即可：

curl https://www.gutenberg.org/cache/epub/24022/pg24022.txt &gt; ./ragtest/input/book.txt


我查看了一下，下载的文件在本地显示为 189KB。大吗？对于文本来说，不算太少。不过相对于今天动辄上 GB 的存储内容来说，那是真不大。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVUFMeFZDFtYWQFZHU94x66bF6PtyLPIsKmaV0TyqkL7fJibzCZuf9BAw/640?wx_fmt=jpeg&amp;from=appmsg)

下载完成后，我们需要进行初始化。

python -m graphrag.index --init --root ./ragtest


这个步骤是为了设置 GraphRAG 的基本环境和配置，确保后续操作能够顺利进行。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVC9ibHsqGsUpnbmAcuicR3Gp3O6ClcPJ4D66fTcbSVKcYaia1z1qqFiaW0g/640?wx_fmt=jpeg&amp;from=appmsg)

我们来看一下，执行很快，因为这里面不做任何实际索引操作，只是新建几个文件和文件夹。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVKoYPAvILgpIGIDVibv0KIXYRpZBnYLib3icjLhngdrsVOZCXEz32WPM7w/640?wx_fmt=jpeg&amp;from=appmsg)

刚才有一个 input 是你自己建的，现在 GraphRAG 创建了 output 文件夹、prompts 文件夹，还有两个设定文件。

我们先设置这个 .env
文件，里面需要填入一些配置。这些配置通常包括 API 密钥、模型选择等重要参数，它们对于 GraphRAG 的正常运行至关重要。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVwyrZFwX7g9861Tm1ISiatv2dpgg5EZN6ib9jiaicUKV5PiaA5uibUGctLa4Q/640?wx_fmt=jpeg&amp;from=appmsg)

你需要将 OpenAI 提供的 API 密钥填入 GRAPHRAG_API_KEY
即可。

另外，settings.yaml
文件也需要修改。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVqLJXkLmcWdaMIhTnZzD0Siag8WPPiaeyHeAibt8KTRZiaK7ub6d0UqYdEw/640?wx_fmt=jpeg&amp;from=appmsg)

这里面有一项尤其需要注意。原来默认使用的是 GPT-4 Turbo preview，这一定要改为 GPT-4o mini，因为我们要尝试降低成本。其他设置无需更改。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVaERNHjZ996O7mxqzyoEpkEAic8Pn31s7P9ZAibic9VvicLLmSChaeC9icSg/640?wx_fmt=jpeg&amp;from=appmsg)

接下来我们来建立索引。回到终端，执行以下命令。

python -m graphrag.index --root ./ragtest


这条命令建立一个图谱化的知识库。这个过程花了足足五分钟的时间，咱们就不详细展示了。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_gif/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVY9UOPHRHCQsstMA4KNBFA7KmhyPqxSDp0rtdTcQuRr0IZibtB4pOUnA/640?wx_fmt=gif&amp;from=appmsg)

#### 查询

终于，图谱构建完毕。下面我们做一个查询。

python -m graphrag.query \ --root ./ragtest \ --method global \ &#34;What are the top themes in this story?&#34;


注意这里的命令，Global（全局）代表我对整本书提问。我们问的问题是：这个故事有哪些最主要的主题？

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_gif/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVsdfjRC8NqibqLNicjkWdKFWR1kqDcFCsM8lll9cMZSxEUNeyibXyy5n0w/640?wx_fmt=gif&amp;from=appmsg)

来看一下结果。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVHf9dxCQMoibaCcJic0EDgxIOgqGqVpgnJ0iaDYZrQhwAibQlXdrCZGPZwg/640?wx_fmt=jpeg&amp;from=appmsg)

结果显示了若干主题，每个答案后面都有一系列的内容来源标号，这一点很重要。它强调了大语言模型没有幻觉，而确实是利用你提供的资料来给出答案。

为了让你看得更加清楚，我给你把上面的答案翻译一下。这里我们使用的是吴恩达老师的三步反思翻译法。

为了让 AI 工作流更加简单，我做了一个工具，并且开放在了 Github 上面，网址在这里。（https://github.com/wshuyi/workflows_with_litellm_pub）如果你觉得好用，别忘了给加颗星啊。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVttbwKWEUko1TbFjH5qlqibQvc5BnqzM0Wmy6YsgvCU6dDtJejX7SjuQ/640?wx_fmt=jpeg&amp;from=appmsg)

这个项目可以帮助我们快捷地执行工作流程。它包含了一系列预设的脚本和配置文件，使得我们能够轻松地设置环境、运行查询。

这个项目不仅可以提高效率，还能确保工作流程的一致性。你可以将复杂的工作流程简化为一个配置文件。这个文件可以清晰地定义每一个步骤，使得整个流程变得更加透明和可管理。

这就是一个配置文件的例子。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVpPYtDRibCKibjdmYgsLSZ4nzk0vf54ZB9nEFXHNumTibTK9Ok270Xkuibg/640?wx_fmt=jpeg&amp;from=appmsg)

这里我说你要进行三步操作，这三步操作构成了一个完整的工作流程。

第一步是执行一个叫做 “翻译成中文”（translate_cn） 的工作提示词。这个步骤的目的是将输入的英文内容转换为中文。使用的输入来自于用户提供的信息，模型调用的还是 GPT-4o mini。

第二步是对刚才的翻译结果进行评价。这一步的目的是确保翻译的质量，通过客观的评价来识别可能存在的问题或改进空间。它的输入相对多一些，除了原文，还应该包括刚才第一步给出的直译结果。为了保证修改建议的有效性和可靠性，我们使用思辨能力更强的 Claude 3.5 Sonnet 模型。

第三步则是综合原文、直译和反思建议，进行精细翻译。这里我们还是使用 GPT-4o mini 模型，以降低成本，提升输出速度。

这种方法的优势在于它的灵活性和可定制性，你可以根据具体需求来调整每一步的提示词，从而优化整个工作流程。具体安装和使用方式，请参考《[如何轻松定制和调用你自己的 AI 工作流](https://mp.weixin.qq.com/s?__biz=MzIyODI1MzYyNA==&amp;mid=2653546876&amp;idx=1&amp;sn=b85ff37a9e9cda1bde890d17cb5e9f54&amp;scene=21#wechat_redirect)》一文。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVWWLJRVh564w0fribic7pmnXFvDgsbFSakF0dtwAaJUIp1zwHDY6FTGVg/640?wx_fmt=jpeg&amp;from=appmsg)

闲言少叙，我们来看翻译的结果。这个结果是经过我们刚才描述的三步工作流程处理后得到的。通过这个例子，你也可以直观看到工作流的效果。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVNfAMtric3mYAzrOBia4N9pd9QNFo1JGq1wa7ovYguvO5b0NNLBxGyMjQ/640?wx_fmt=jpeg&amp;from=appmsg)

#### 验证

我们该不该相信这个结果？我觉得尽管在回答中，GraphRAG 给出了来源片段信息，但这还不够。

假设你根本就没有读过狄更斯的这本小说，该如何验证刚才给出的答案呢？

你可以写一个提示词：

&gt;   * 你是一名资深英语文学教师，现在你就狄更斯小说 &#34;A Christmas Carol&#34; 提出来了一个问题 &#34;What are the top themes in this story?&#34;，下面我提供给你的文档，是一个学生的回答。请你根据你对这本小说的理解，一段段核对，看答案是否有事实性错误，以及是否有可改进的地方

然后，把这个提示词，连同刚刚 GraphRAG 给出的结果（英文即可）交给 Claude 3.5 Sonnet 。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVDiaTWhv3voa2IRiayJvzcuibA4qHNCYWAU1yAmrdtRaZjH4ae1Lvrb7cg/640?wx_fmt=jpeg&amp;from=appmsg)

然后，这是 Claude 3.5 Sonnet 给出的回答质量分析结果。让我们来看看它的评价。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVWWS6E07RibD5xgX4vFLeojCYx1FZFYyMuAsZyib7VPiczfYnbYHOnb9HA/640?wx_fmt=jpeg&amp;from=appmsg)

Claude 3.5 Sonnet 给出总体评价：这是一个非常优秀的分析。这个结果证明了我们利用知识图谱进行检索的方法非常有效。到此为止，我们是否可以完全相信这个答案呢？

当然不行。

刚才看到的是大语言模型基于自己训练时对数据的记忆得出的结果，这依然可能会产生幻觉。因此，我们需要让 AI 连接网络进行查询，以验证信息的准确性。

在这方面，[一个比较好的工具就是 Perplexity](https://mp.weixin.qq.com/s?__biz=MzIyODI1MzYyNA==&amp;mid=2653545151&amp;idx=1&amp;sn=c180d59dd86b284d4d9f8e30ab73a06d&amp;scene=21#wechat_redirect)。它能够网络查询，验证信息的准确性。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVlX73SErckQ8NsZyuicANsgMjPoqZfoaKtX19CDqlI92ibTv2JzJLp0Yg/640?wx_fmt=jpeg&amp;from=appmsg)

首先，Perplexity 会查找与输入内容相关的信息，列出了多个相关的信息来源。然后，Perplexity 会核对主题识别的准确性。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVtTWyWLFlzc9X1lhguRraTiaCBdGQr793cE94BJWdBs05ZwPZK25V7wQ/640?wx_fmt=jpeg&amp;from=appmsg)

在 Perplexity 的分析中，你可以看到它使用了这些词语来评价：准确地捕捉、准确地识别、很好的捕捉，准确地指出、很好的总结。它还指出没有明显的事实性错误，主题的选择和分析都很到位。

通过这两种方法的交叉验证，我们对大语言模型根据我们的图谱式知识库给出的答案就更有信心了。

#### 成本

使用这种方法的成本如何呢？

我打开 OpenAI 控制台查看，一开始吓了一跳 —— 今天的账单又起飞了？

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVLnWmeofZGN3MTa5eFzgvFpI2WoFEd7BvuR2kRxXpaBID5CNm4epIrw/640?wx_fmt=jpeg&amp;from=appmsg)

好在仔细一看，实际花费仅仅 0.28 美金。下面是明细。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVgcmPILxD4nUibdD8M0muH6JuuBicicuH1GK7Sia3Kq5bm9gfF0mQuyfXCQ/640?wx_fmt=jpeg&amp;from=appmsg)

有 0.05 美金（将近五分之一）是用于语音识别的，这与我们当前的任务无关。

换句话说，我们用于总结这本书、构建知识图谱型知识库，以及进行查询的实际花费是多少呢？仅需要 0.23 美金。

考虑到使用官方样例花费 11 美金，你会发现 GPT-4o mini 带来的成本改善令人惊叹。

#### 小结

通过本文的讲解，你可以发现 GraphRAG 技术能帮助我们更准确地回答全局性的复杂问题，这对许多应用场景来说至关重要。

进一步，结合 GPT-4o mini 模型，我们不仅提高了处理效率和速度，还有效降低了成本。对于个人用户、研究人员和企业来说，这都是一个好消息。

自己动手试一试吧，欢迎你把自己的测试结果分享在留言区，咱们一起交流讨论。

祝基于知识图谱的 AI 知识库使用愉快！

**点赞 +「在看」，转发** 给你身边有需要的朋友。收不到推送?那是因为你只**订阅** ，却没有**加星标** 。

欢迎订阅我的小报童付费专栏，每月更新不少于3篇文章。订阅一整年价格优惠。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVHIsZNKbFzF6aSKtAGAmBl0Piabd4bsjGe3MyicoAsdPyGEB6LSJtVm2w/640?wx_fmt=jpeg&amp;from=appmsg)

如果有问题咨询，或者希望加入社群和热爱钻研的小伙伴们一起讨论，**订阅知识星球** 吧。不仅包括小报童的推送内容，还可以自由发帖与提问。之前已经积累下的帖子和问答，就有数百篇。足够你好好翻一阵子。知识星球支持72小时内无条件退款，所以你可以放心尝试。

![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_jpg/6fHkSrNbAAt4TyXmRbLPAceNrBXZm3CVDkRic1m7cRBjJkKic2uhDSh3JjrkAU8FR10l4rFziaOVPcCcYnSdtuf0A/640?wx_fmt=jpeg&amp;from=appmsg)

若文中部分链接可能无法正常显示与跳转，可能是因为微信公众平台的外链限制。如需访问，请点击文末「阅读原文」链接，查看链接齐备的版本。 





#### 延伸阅读

  * [开发文档 RAG 的 GPTs 如何更高效地帮你 AI 编程？](https://mp.weixin.qq.com/s?__biz=MzIyODI1MzYyNA==&amp;mid=2653546568&amp;idx=1&amp;sn=b03b9d4d0339ea4c52100f152ad9430e&amp;scene=21#wechat_redirect)

  * [如何用人工智能帮你读论文？](https://mp.weixin.qq.com/s?__biz=MzIyODI1MzYyNA==&amp;mid=2653543623&amp;idx=1&amp;sn=a87d4ea4bd72b98f33f2217fe18aa635&amp;scene=21#wechat_redirect)

  * [文科生用机器学习做论文，该写些什么？](https://mp.weixin.qq.com/s?__biz=MzIyODI1MzYyNA==&amp;mid=2653540483&amp;idx=1&amp;sn=8d876a47e22146057702ab7f28ff33d1&amp;scene=21#wechat_redirect)

  * [如何用人工智能帮你高效寻找研究选题？](https://mp.weixin.qq.com/s?__biz=MzIyODI1MzYyNA==&amp;mid=2653543339&amp;idx=1&amp;sn=5c3b6815f5d2982f2ebe4749b386692d&amp;scene=21#wechat_redirect)

  * [如何用人工智能帮你找论文？](https://mp.weixin.qq.com/s?__biz=MzIyODI1MzYyNA==&amp;mid=2653540347&amp;idx=1&amp;sn=a9f834771070ab42fecc206f8b5e4195&amp;scene=21#wechat_redirect)









  



更多AI工具，参考[Github-AiBard123](https://aibard123.com/)，[国内AiBard123](https://aibard123.com/)
</code></pre>


          </div>

可关注我们的公众号：每天AI新工具

<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


