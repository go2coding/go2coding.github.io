

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>正确完成检索增强生成（RAG）：数据库数据 作者： 大数据杂货铺 来源： 大数据杂货铺 介绍 检索增强生成 （RAG） 管道正日益成为使用大型语言模型 （LLM） 和您自己的数据实现问答和聊天机器人应用程序的常用方法。 您的某些数据可能以 PDF 格式的文件或 MSOffice 文档的形式驻留在 S3 或 Google-Drive 上，但在许多情况下，您的数据  | AiBard123| ai工具网址导航,ai最新产品</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AI聊天,AI文本生成,AI绘画,AI编程,AI电商" />
    <meta name="description" content="AiBard123 网址导航 | 免费chatgpt 汇集各类先进的人工智能产品，旨在帮助用户更快速地了解和使用这些产品,轻松地浏览不同领域的AI产品，包括语音识别、图像处理、自然语言处理。" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://aibard123.com/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                        </a>
                        <a href="https://aibard123.com/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| ai工具网址导航,ai最新产品">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>本月热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>热门网站</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>国内热门</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>对话工具</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>写作</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>图像处理</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音视频</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>音乐生成</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>办公</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>提示词</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>编程</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AI搜索</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>文本翻译</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>学习网站</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>友情链接</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AiBard123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AiBard123| ai工具网址导航,ai最新产品">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AiBard123| ai工具网址导航,ai最新产品">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>首页</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI 文摘
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">正确完成检索增强生成（RAG）：数据库数据</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://aibard123.com/about>AiBard123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              March 26, 2024 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/9IZsf6icv8GrfX8Ka42MicOPzAYIiaI97oIibJZ1M5nqKvIPw0RfwhpmvVMqkc1tuAhhAaccnSs7xsEE1y16gvPmQg/640?wx_fmt=png&amp;random=0.17425989804940967&amp;random=0.2760412669525931&amp;random=0.23002170610379524&amp;random=0.0423348502342471" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <p>作者： 大数据杂货铺  来源： <a href="https://mp.weixin.qq.com/s/YW4RQihRmVU_Szg4wFKgKg">大数据杂货铺</a></p>
<p>介绍</p>
<ul>
<li>
<h4 id="检索增强生成-rag-管道正日益成为使用大型语言模型-llm-和您自己的数据实现问答和聊天机器人应用程序的常用方法">检索增强生成 （RAG） 管道正日益成为使用大型语言模型 （LLM） 和您自己的数据实现问答和聊天机器人应用程序的常用方法。</h4>
</li>
<li></li>
<li>
<p>您的某些数据可能以 PDF 格式的文件或 MSOffice 文档的形式驻留在 S3 或 Google-Drive 上，但在许多情况下，您的数据存储在 Snowflake、Redshift 或 Postgres 等数据库的结构化表中，或存储在 MongoDB 或 CouchDB 等文档数据库中。</p>
</li>
<li>
<p>这些数据通常对您的业务至关重要，将 RAG 应用于此数据可以让您的用户以全新的方式与这些数据进行交互，例如问答、聊天机器人或摘要。最终结果是提高生产力、销售转化率或提高用户参与度。</p>
</li>
<li>
<p>如何使用此类结构化或半结构化数据构建 RAG 管道？</p>
</li>
<li>
<p>在这篇博文中，我们将介绍执行此操作的过程，并回顾一些最佳实践。我们将重点关注通常存储在 RDBMS 系统中的结构化数据，如代码中所示，但此处描述的方法也适用于文档数据库。</p>
</li>
</ul>
<p>将 GenAI 与数据库结合使用</p>
<h4 id="企业中的大多数关键业务数据都是以关系方式组织和存储的sql-仍然是人们查询这些数据以获取见解的主要方式">企业中的大多数关键业务数据都是以关系方式组织和存储的，SQL 仍然是人们查询这些数据以获取见解的主要方式。</h4>
<p>当我们在生成式 AI 的背景下讨论数据库时，总是首先想到的问题之一是：“我不能告诉数据库我需要什么，而不必制作一个复杂（通常是多页）的 SQL 查询吗？</p>
<p>对于LLM来说，这是一个非常重要的用例。 事实证明，现有的 LLM 如 OpenAI 的 GPT-4 或 Anthropic 的 Claude-2 可以很好地完成简单的文本到 SQL 任务，但在更复杂的用例中往往会失败。这是很不幸的，尽管我真的希望文本到SQL在未来几年内会得到显着改善，并且我们将有一种很好的方式来使用分析，只需发出自然语言查询即可。</p>
<p>在这篇博文中，我将重点介绍一个不同的用例，即使用驻留在数据库中的数据构建 RAG 应用程序。</p>
<p>例如，考虑以下巴塞罗那市的 Airbnb 房源公开数据集，我已将其上传到 Snowflake 实例中，分为两个表：房源和评论。</p>
<p>房源表有75个不同的列，描述了巴塞罗那每个Airbnb房源的各个方面，例如：描述、床位数量、社区以及地理坐标——经度和纬度。</p>
<p>评论表只有 6 列，包括 listing-ID（将评论映射到它在列表表中引用的列表）、评论者姓名、评论日期和“评论”（主要评论文本）。</p>
<p>用户评论往往包含非常有价值的信息，这些信息可用于帮助未来的巴塞罗那游客。然而，众所周知，RDBMS系统和基于关键字的索引很难利用这种类型的用户生成的内容。我们将使用 Vectara 构建一个 RAG 应用程序，以允许用户提出以下问题：</p>
<p>·什么是最适合儿童的博物馆？</p>
<p>·哪个街区的小吃店最好？</p>
<p>·我在哪里可以找到夜总会？</p>
<p>您可以想象，如果用户可以在房产搜索过程中利用这些定性信息，那么 Airbnb 的转化率会变得更好。这将是Airbnb的胜利，也是其用户的胜利。</p>
<p>让我们开始吧。</p>
<p>将数据引入 Vectara</p>
<h4 id="我们的第一步是将-snowflake-中的数据摄取到-vectara-中">我们的第一步是将 Snowflake 中的数据摄取到 Vectara 中。</h4>
<p>数据库表中的数据被结构化为列，在准备用于生成式 AI 的数据时，必须考虑数据架构并决定如何最好地准备它在 RAG 上下文中使用。</p>
<p>因此，在进行任何数据摄取之前，我们需要设计一个“文档构建计划”，据此我们决定如何将数据库中每个感兴趣的实体转换为要摄取的 Vectara JSON 文档。</p>
<p>例如，在我们的例子中，我们将从每个评论（即评论表中的每一行）构建这样一个JSON文档，它将包括一个标题和一些文本部分，然后添加元数据字段以支持过滤。</p>
<p>具体说来：</p>
<p>·我们将为本文档构建一个标题，如下所示：“在进行审查”</p>
<p>·第一部分是我们从有关属性的一些字段构造的句子：“属性，描述为”</p>
<p>·第二部分将包括有关该物业的实际&lt;评论&gt;（实际评论）。</p>
<p>列表数据库中有许多字段可用于元数据，我们在此演示中选择了几个字段来包含：</p>
<ul>
<li>
<p>LATITUDE</p>
</li>
<li>
<p>LONGITUDE</p>
</li>
<li>
<p>DATE</p>
</li>
<li>
<p>NEIGHBORHOOD_CLEANSED</p>
</li>
</ul>
<p>我们刚才概述的用于处理数据库表中每一列的计划演示了引入数据库表以在 RAG 应用程序中使用时的常见模式：</p>
<p>1.一些本质上是文本的列，例如“评论”列，是直接使用的——在这种情况下，作为其自身的一个部分。</p>
<p>2.可以通过从一列或多列及其值创建“人工句子”来构造文本。例如，标题和第二部分都是以这种方式构造的。</p>
<p>3.某些字段用作元数据（如 LONGITUDE 和 LATITUDE）。这使我们能够使用这些字段过滤结果。</p>
<p>4.某些字段只是被忽略，并且不会在 RAG 流中使用。</p>
<p>虽然我们在这里处理的是像 Snowflake 或 Redshift 这样的数据库系统，但值得一提的是，如果您的文件驻留在 CSV 文件或任何其他行为类似于数据库中的结构化数据的格式中，则遵循“文档构建计划”的策略同样适用。</p>
<p>为了摄取数据，我们首先在 Vectara 中创建一个新的语料库，并将元数据中的每个字段（日期、经度、纬度和邻域）定义为过滤器属性。</p>
<p>接下来，我们使用 Snowflake 的 Python 连接器将数据从表下载到 pandas 数据帧中：“'</p>
<hr>
<pre><code>con = connect(user=sf_user, password=sf_password, account=sf_account)
  

cursor = con.cursor()
  

cursor.execute(&quot;USE DATABASE AIRBNB;&quot;)
  

query = '''
  

SELECT
  

DATE, REVIEWER_NAME, COMMENTS, R.ID as REVIEW_ID,
  

LATITUDE, LONGITUDE, ROOM_TYPE, DESCRIPTION,
  

NEIGHBOURHOOD_CLEANSED as NEIGHBORHOOD
  

FROM REVIEWS AS R JOIN LISTINGS as L
  

ON R.LISTING_ID = L.ID
  

'''
  

cursor.execute(query)
  

df = cursor.fetch_pandas_all()
</code></pre>
<p>在这里，我们将两个表 REVIEWS 和 LISTINGS 连接起来，以获取每个评论所需的所有信息。</p>
<p>这就是我们为每条评论创建一个 Vectara “JSON 文档”的方式：</p>
<hr>
<pre><code>def add_chunk(df_chunk, bar) -&gt; None:    
  

&quot;&quot;&quot;Ingest a df into Vectara.&quot;&quot;&quot;
  

session = requests.Session()
  

adapter = requests.adapters.HTTPAdapter(max_retries=5)
  

session.mount(&quot;https://&quot;, adapter)
  

for row in df_chunk.to_dict(orient='records'):
  

metadata = {
  

'date': row['DATE'],
  

'reviewer': row['REVIEWER_NAME'],
  

'latitude': row['LATITUDE'],
  

'longitude': row['LONGITUDE'],
  

'neighborhood': row['NEIGHBORHOOD']
  

}
  

doc = {
  

&quot;documentId&quot;: f&quot;Review {row['REVIEW_ID']}&quot;,
  

&quot;metadataJson&quot;: json.dumps(metadata),
  

&quot;title&quot;: f&quot;Review by {row['REVIEWER_NAME']} on {row['DATE']}&quot;,
  

&quot;section&quot;: [
  

{'text': f&quot;{row['ROOM_TYPE']} property in {row['NEIGHBORHOOD']}, described as {clean_md(row['DESCRIPTION'])}&quot;},
  

{'text': clean_md(row['COMMENTS'])}
  

],
  

}    
  

res = index_doc(session, doc)
  

bar.update.remote(1)&lt;code&gt;&lt;/code&gt;
</code></pre>
<p>请注意，这里如何对每一行执行以下操作：df_chunk</p>
<p>1.创建元数据，包括日期、审阅者、纬度、经度和邻域</p>
<p>2.创建变量，包括 doc、documentID 、title 和 a，其中包含两部分metadata和section ：上面讨论的人工句子和评论注释。</p>
<p>然后，该函数index_doc()通过调用索引 API 在 Vectara 中为文档编制索引 - 您可以在此处查看完整代码。</p>
<p>生成的 JSON 文档的示例如下：</p>
<hr>
<pre><code>{
  

&quot;documentId&quot;: &quot;Review 886755474280381042&quot;,
  

&quot;metadataJson&quot;: '{&quot;date&quot;: &quot;2023-05-08&quot;, &quot;reviewer&quot;: &quot;Mathias&quot;, &quot;latitude&quot;: 41.37249, &quot;longitude&quot;: 2.13603, &quot;neighborhood&quot;: &quot;Sants&quot;}',
  

&quot;title&quot;: &quot;Review by Mathias on 2023-05-08&quot;,
  

&quot;section&quot;: [
  

{
  

&quot;text&quot;: &quot;Private room property in Sants, described as The spaceBreakfast buffet not included 24 hour ReceptionHigh-speed Wi-Fi throughout the buildingRelax ZoneLuggage storage lockersMeeting RoomTablet with tourist informationAir conditioning and heatingSmart TV in all roomsDisabled accessible roomsNon smoking hotelGuest accessComfortable, modern, functional room with its own private bathroom, hairdryer, towels, ecological shampoo and soap and a smart safe. The room is equipped with quality comfortable beds, a 28-inch Smart TV, functional wardrobe (closet), a chair and desk, as well as two bedside tables with reading lights. It has high speed Wi-Fi, individually controlled air conditioning &amp; heating as well as daily room cleaning.Registration numberHB-004659&quot;    
  

},
  

{&quot;text&quot;: &quot;Veldig bra oppholf&quot;},
  

],
  

}
</code></pre>
<p>Test 函数add_chunk()接收 DataFrame 中的一组行，并每行创建一个 JSON 文档。这样，我们就可以使用 Ray 轻松并行化和加速数据摄取：</p>
<hr>
<pre><code>ray_workers = 10 # or choose your number of cores
  

print(f&quot;Using Ray with {ray_workers} workers&quot;)
  

ray.init(num_cpus=ray_workers, ignore_reinit_error=True)
  

remote_tqdm = ray.remote(tqdm_ray.tqdm)
  

bar = remote_tqdm.remote(total=len(df))
  

ray_add_chunk = ray.remote(add_chunk)
  

chunks = np.array_split(df, ray_workers)    
  

futures = [ray_add_chunk.remote(chunk, bar) for chunk in chunks]
  

_ = ray.get(futures)
</code></pre>
<p>就是这样。</p>
<p>完成此摄取过程后，我们现在可以使用 Vectara 使用这些数据构建用于问答的应用程序或聊天机器人。</p>
<h4 id="询问有关巴塞罗那的问题">询问有关巴塞罗那的问题</h4>
<p>好了，现在所有数据都已摄取，我们可以尝试对这些数据进行一些有趣的查询。AirBNB 评论往往不仅有对房产的评论，而且通常有很多关于社区、要做的事情等等的宝贵信息。</p>
<p>我们在这里提供了用于查询数据的完整代码。</p>
<p>让我们尝试几个问题：</p>
<p>第一个问题是“什么是最适合儿童的博物馆？</p>
<p>Vectata 的查询 API 响应：</p>
<p>“正如一位游客所说，巴塞罗那最适合儿童的博物馆似乎是科学博物馆。据他们 6 岁和 8 岁的孩子说，这是他们旅行的亮点。此外，还推荐 Recinte Modernista St Pau、MACBA 和毕加索博物馆。这些博物馆为儿童提供引人入胜的教育体验。此外，海滩附近还有公园和游乐场，孩子们可以在那里享受户外活动。总的来说，这些景点为巴塞罗那的儿童娱乐和教育提供了一系列选择。</p>
<p>当我们运行此查询时：“哪个社区的小吃店最好？</p>
<p>我们得到：</p>
<p>“强烈推荐巴塞罗那的格拉西亚（Gracia）社区，因为它拥有一流的小吃场所。游客们称赞了该地区一流的酒吧和餐馆。一些具体的小吃推荐包括 El 58 和太阳广场的一个地方。Gracia 拥有迷人而舒适的氛围，方便前往圣家堂和奎尔公园等景点。附近的Estrella市场提供新鲜水果和传统的加泰罗尼亚产品。总的来说，格拉西亚是一个充满活力的社区，拥有梦幻般的小吃选择和便利的地理位置。</p>
<p>这听起来很酷很美味，以至于我让 Dalle-3 生成一张它可能是什么样子的图像。结果如下：</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_png/9IZsf6icv8GrfX8Ka42MicOPzAYIiaI97oIibJZ1M5nqKvIPw0RfwhpmvVMqkc1tuAhhAaccnSs7xsEE1y16gvPmQg/640?wx_fmt=png&amp;random=0.17425989804940967&amp;random=0.2760412669525931&amp;random=0.23002170610379524&amp;random=0.0423348502342471" alt=""></p>
<p>多么有趣！</p>
<p>我们的最后一个问题是：“我在哪里可以找到夜总会？</p>
<p>回应如下：</p>
<p>“夜总会在不同的地方都可以找到。一个搜索结果提到了一家名为Club Pipos的夜总会，该夜总会位于公寓下方，可能会造成噪音干扰。另一个结果提到某个公寓附近的一家夜总会，直到凌晨 1-2 点左右才能听到热闹游客的噪音。此外，另一个搜索结果提到了一家名为 APOLLO 的夜总会，位于公寓附近，在周四、周五和周六凌晨 5：30 之前会造成潜在的噪音问题。然而，一篇评论指出，在窗户和百叶窗关闭的情况下，附近夜总会的噪音不是问题。重要的是要考虑夜总会与潜在住宿的接近程度以及个人喜好，以享受宁静的住宿。</p>
<p>当然，我们可能正在寻找大流行前的一些建议，那么如果我们添加过滤标准会怎样：</p>
<p>doc.date
&lt; &lsquo;2020-01-01&rsquo;</p>
<p>使用相同的查询，我们现在得到：</p>
<p>“根据搜索结果，巴塞罗那有几个地区可以找到夜总会。一种选择是住在圣安东尼，附近有商店、餐馆、小吃店和夜总会。另一个区域是示例区，距离著名的步行大道兰布拉大道有 15 分钟步行路程，提供充满活力的夜生活场景。然而，值得注意的是，这些地区附近的一些住宿提到，由于夜总会附近，晚上可能会有一些噪音。总的来说，这些地点为巴塞罗那的夜生活场所提供了便利。</p>
<h4 id="heading"></h4>
<p>结论</p>
<p>许多企业数据驻留在结构化数据库表中，在这篇博文中，我们研究了如何将此类数据引入 Vectara，特别是从表的每一行创建 Vectara“文档”对象的常用方法，以实现强大的语义搜索、问答和对话式 AI。</p>
<p>原文链接：https://vectara.com/blog/retrieval-augmented-generation-rag-done-right-database-data/</p>
<p>更多AI工具，参考<a href="https://aibard123.com/">Github-AiBard123</a>，<a href="https://aibard123.com/">国内AiBard123</a></p>



          </div>

可关注我们的公众号：每天AI新工具

<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('夜间模式开启');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('夜间模式关闭');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","日间模式");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","夜间模式");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


