

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#f9f9f9" />

	<title>LLMMambaï¼šLLMæ–°æ¶æ„çš„æµ…æ¢ ä½œè€…ï¼š AINLP æ¥æºï¼š AINLP ç›®å‰å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰é¢†åŸŸå‘å±•å¦‚ç«å¦‚è¼ï¼Œæœ¬æ–‡å°†é‡ç‚¹æ¢ç´¢åœ¨å•ä¸ªæ¶ˆè´¹çº§GPUä¸Šå¯ä»¥æœ‰æ•ˆè¿è¡Œçš„å°å‹æ¨¡å‹ï¼ˆâ‰¤7Bä¸ªå‚æ•°ï¼‰ã€‚ æˆ‘ä»¬å°†ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢é‡ç‚¹ä»‹ç»åŸºäºæ–°æ¶æ„çš„è¯­è¨€æ¨¡å‹ï¼šğŸMambaæ¨¡å‹ï¼ˆhttps://github.com/  | AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“</title>
	<link rel="shortcut icon" href="/assets/images/favicon.png" />
    <meta name="keywords" content="chatgpt,AI,AIèŠå¤©,AIæ–‡æœ¬ç”Ÿæˆ,AIç»˜ç”»,AIç¼–ç¨‹,AIç”µå•†" />
    <meta name="description" content="AiBard123 ç½‘å€å¯¼èˆª | å…è´¹chatgpt æ±‡é›†å„ç±»å…ˆè¿›çš„äººå·¥æ™ºèƒ½äº§å“ï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·æ›´å¿«é€Ÿåœ°äº†è§£å’Œä½¿ç”¨è¿™äº›äº§å“,è½»æ¾åœ°æµè§ˆä¸åŒé¢†åŸŸçš„AIäº§å“ï¼ŒåŒ…æ‹¬è¯­éŸ³è¯†åˆ«ã€å›¾åƒå¤„ç†ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€‚" />
    
    <meta name="baidu-site-verification" content="codeva-cCAOSG8MBO" />
    
    <link rel="stylesheet" id="block-library-css"
        href="/assets/css/block-library.min-5.6.2.css" type="text/css" media="all" />
    <link rel="stylesheet" id="iconfont-css" href="/assets/css/iconfont-3.03029.1.css"
        type="text/css" media="all" />

    
    <link href="/scss/style.min.css" rel="stylesheet" />
    
		    <link rel="stylesheet" id="iowen-css" href="/assets/css/style-3.03029.1.css"
        type="text/css" media="all" />
    <link rel="stylesheet" id="custom-css" href="/assets/css/custom-style.css"
        type="text/css" media="all" />
		
		<link rel="stylesheet" href=/plugins/font-awesome/css/font-awesome.min.css />


    <link rel="stylesheet" id="fortawesome-css" href="/assets/fontawesome-5.15.4/css/all.min.css" type="text/css" />


    <script type="text/javascript" src="/assets/js/jquery.min-3.2.1.js" id="jquery-js"></script>
    <script type="text/javascript" src="/assets/js/content-search.js"  id="content-search-js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2073588164294660"
     crossorigin="anonymous"></script>

	
    <script>
        

		var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8450bc732b2a86f7e4aec4ebd9fd8252";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

        
    </script>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7071W80M2K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-7071W80M2K');
    </script>

</head>


    <div class="page-container">
	
	<div id="sidebar" class="sticky sidebar-nav fade animate-nav" style="width: 170px">
        
            <div class="modal-dialog h-100 sidebar-nav-inner">
                <div class="sidebar-logo border-bottom border-color">
                    
                    <div class="logo overflow-hidden">
                        <a href="https://aibard123.com/" class="logo-expanded">
                            <img src="/assets/images/bt8-expand-light.png" height="40" class="logo-light"
                                alt="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                            <img src="/assets/images/bt8-expand-dark.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                        </a>
                        <a href="https://aibard123.com/" class="logo-collapsed">
                            <img src="/assets/images/bt.png" height="40" class="logo-light"
                                alt="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                            <img src="/assets/images/bt.png" height="40" class="logo-dark d-none"
                                alt="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                        </a>
                    </div>
                    
                </div>
                <div class="sidebar-menu flex-fill">
                    <div class="sidebar-scroll">
                        <div class="sidebar-menu-inner">
                            <ul>
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#00834a9dd147b04c5d53d4368cdb0b57" class="smooth">
                                            <i class="fas fa-sun fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>æœ¬æœˆçƒ­é—¨</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db0311e7ecfedd24d157f0ceb4a0897f" class="smooth">
                                            <i class="fas fa-star-and-crescent fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>çƒ­é—¨ç½‘ç«™</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#21b5cbb2c769010fec3ce029a5f8a4a3" class="smooth">
                                            <i class="far fa-star fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>å›½å†…çƒ­é—¨</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#8310718935e8ec25ce0350de01e3f7dc" class="smooth">
                                            <i class="fas fa-phone fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>å¯¹è¯å·¥å…·</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#d58e850d9115797306c2edf61ac6ddd8" class="smooth">
                                            <i class="fas fa-newspaper fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>å†™ä½œ</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2a7418a5f8f1ca4e054364a9300657df" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>å›¾åƒç”Ÿæˆ</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#7808a68ee1b34dab43011429a12de19e" class="smooth">
                                            <i class="fas fa-image fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>å›¾åƒå¤„ç†</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#6729afc51f5ac49a828812fa0eb0c82f" class="smooth">
                                            <i class="fas fa-video fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>éŸ³è§†é¢‘</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#e5ce844860451fff3faf3d8f8894971d" class="smooth">
                                            <i class="fas fa-music fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>éŸ³ä¹ç”Ÿæˆ</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#db53804b7d726967c58fcc8c9ca03d27" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>åŠå…¬</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#47b7af9547e034d28fe6f6d439968ac8" class="smooth">
                                            <i class="fas fa-copy fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>æç¤ºè¯</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#41282bf95e43c64d579757573a03cdde" class="smooth">
                                            <i class="fas fa-code fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>ç¼–ç¨‹</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#fd71852fd52d5e18ef4f9a252f1eac58" class="smooth">
                                            <i class="fas fa-search fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>AIæœç´¢</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#81b1637fbe47625dbdf2094acd3b6683" class="smooth">
                                            <i class="fas fa-language fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>æ–‡æœ¬ç¿»è¯‘</span>
                                        </a>
                                    </li>
                                    
                                
                                    
                                    <li class="sidebar-item">
                                        <a href="/#2e9ba3fa6e1ed0e9311b3e97f97f9a40" class="smooth">
                                            <i class="fas fa-book fa-lg fa-lg icon-fw icon-lg mr-2"></i>
                                            <span>å­¦ä¹ ç½‘ç«™</span>
                                        </a>
                                    </li>
                                    
                                
                            </ul>           
                        </div>
                    </div>
                </div>
                <div class="border-top py-2 border-color">
                    <div class="flex-bottom">
                        <ul>
			    <li id="menu-item-212"
                                 class="menu-item menu-item-type-custom menu-item-object-custom menu-item-212 sidebar-item">
                                 <a href="#friendlink" class="smooth">
                                     <i class="fab fa-staylinked icon-fw icon-lg mr-2"></i>
                                     <span>å‹æƒ…é“¾æ¥</span>
                                 </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="flex-fill grid-bg">
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                        <img src="/assets/images/bt.png" class="logo-light"
                            alt="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                        <img src="/assets/images/bt.png" class="logo-dark d-none"
                            alt="AiBard123| aiå·¥å…·ç½‘å€å¯¼èˆª,aiæœ€æ–°äº§å“">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        
			<li >
				<a href="/">
                                    <i class="fa fa-home fa-lg mr-2"></i>
                                    <span>é¦–é¡µ</span>
                                </a>
				<ul class="sub-menu">
				
				</ul>
			    </li>
			
			</ul>

                        
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "008000",
                                        "tmpSize": 14,
                                        "cityColor": "008000",
                                        "citySize": 14,
                                        "aqiColor": "#008000",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": "085791e805a24491b43b06cf58ab31e7"
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        
                        
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">ç–å½±æ¨ªæ–œæ°´æ¸…æµ…ï¼Œæš—é¦™æµ®åŠ¨æœˆé»„æ˜ã€‚</a></div>
                        </li>
                        
                        
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>




<body class="page-body boxed-container  io-grey-mode">
    <main role="main" class="flex-shrink-0">
    <div class="container">
        
        <div class="content">
            <style>
    body{
	    background: #f9f9f9;
	}

    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }


 
@media (min-width: 1000px) {
  .container, .container-sm {
    max-width: 800px;
  }
}

</style>

<div class="featured-post-content">

    <a href="/digest/" class="featured-post-title">
       AI æ–‡æ‘˜
    </a>

</div>

<section class="blog-single">
  <div class="container">
    <div class="row">

      <div class="col-lg-12 order-1 order-lg-2">
        <article class="single-blog">
          <p class="title">LLMMambaï¼šLLMæ–°æ¶æ„çš„æµ…æ¢</p>
            <br/>
          <ul class="meta">
            <li>
              By <a href=https://aibard123.com/about>AiBard123</a>
            </li>
            <li>
              <i class="fa fa-clock-o"></i>
              January 10, 2024 - 2 min read
            </li>
          </ul>

          <div class="_1NCGf">
              <img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/N5aX12H1SicnL0LbhlvBPAdARv93UBQz9peh0MYrtdTyWekQZHNARvnQJiaUuVm8vErkAT0KU6RCFT1P1CSzgevw/640?wx_fmt=png&amp;from=appmsg" width="640" >
          </div>
            <br>
            <br>
            <br>
          
          <div class="single-blog-content">
            <p>ä½œè€…ï¼š AINLP  æ¥æºï¼š <a href="https://mp.weixin.qq.com/s/zMQEQzZXmm4x5qGOEUbTjQ">AINLP</a></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/nW2ZPfuYqSJuK8UUBxdZXj1c20hUg374YPgXibgDGytAy87YxvVk4WCRFWrdKJPshStrlPJp4vGEGUQodxt7ibOw/640?wx_fmt=jpeg" alt=""></p>
<p>ç›®å‰å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰é¢†åŸŸå‘å±•å¦‚ç«å¦‚è¼ï¼Œæœ¬æ–‡å°†é‡ç‚¹æ¢ç´¢åœ¨å•ä¸ªæ¶ˆè´¹çº§GPUä¸Šå¯ä»¥æœ‰æ•ˆè¿è¡Œçš„å°å‹æ¨¡å‹ï¼ˆâ‰¤7Bä¸ªå‚æ•°ï¼‰ã€‚</p>
<p>æˆ‘ä»¬å°†ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢é‡ç‚¹ä»‹ç»åŸºäºæ–°æ¶æ„çš„è¯­è¨€æ¨¡å‹ï¼šğŸMambaæ¨¡å‹ï¼ˆhttps://github.com/state-spaces/mambaï¼‰ï¼š</p>
<pre><code>* ä¸åŸºç¡€æ¨¡å‹å¯¹è¯

* ä½¿ç”¨Huggingface Trainerè¿›è¡ŒæŒ‡ä»¤è·Ÿéšå¾®è°ƒ

* ä»é€Ÿåº¦å’Œè¾“å‡ºè´¨é‡æ–¹é¢åœ¨benchmarkä¸Šè¯„ä¼°Mambaï¼Œå¹¶å°†å…¶ä¸TinyLlamaè¿›è¡Œæ¯”è¾ƒ
</code></pre>
<p><strong>ä¸€ã€ğŸMambaç®€ä»‹</strong></p>
<p>Mambaæ˜¯LLMçš„ä¸€ç§æ–°æ¶æ„ï¼Œä¸Transformersç­‰ä¼ ç»Ÿæ¨¡å‹ç›¸æ¯”ï¼Œå®ƒèƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°å¤„ç†é•¿åºåˆ—ã€‚å®ƒåˆ©ç”¨é€‰æ‹©æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆSSMï¼‰ï¼Œæ ¹æ®å†…å®¹åŠ¨æ€è¿‡æ»¤å’Œå¤„ç†ä¿¡æ¯ï¼Œå…è®¸æ¨¡å‹é€‰æ‹©æ€§åœ°è®°ä½æˆ–å¿½ç•¥è¾“å…¥çš„éƒ¨åˆ†ã€‚Mambaåœ¨å¤„ç†é€Ÿåº¦å’Œç¼©æ”¾èƒ½åŠ›æ–¹é¢æœ‰äº†æ˜¾è‘—æ”¹è¿›ï¼Œå°¤å…¶æ˜¯åœ¨è¾ƒé•¿åºåˆ—çš„æƒ…å†µä¸‹ã€‚</p>
<p>ä½†MambaçœŸæ­£ä¸ä¼—ä¸åŒçš„åœ°æ–¹æ˜¯ä»€ä¹ˆï¼Ÿè®©æˆ‘ä»¬ä¸Mambaè¿›è¡Œæ·±å…¥äº’åŠ¨ä½“éªŒæ¥æµ‹è¯•ä¸€ä¸‹ã€‚</p>
<p><strong>äºŒã€Mambaæ¨¡å‹èŠå¤©</strong></p>
<p>ç”±äºMambaè¿˜ä¸æ˜¯Huggingfaceå¹³å°çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥ä½¿ç”¨å®ƒç¨å¾®å¤æ‚ä¸€äº›ã€‚è™½ç„¶å½“å‰çš„åŸºæœ¬å®ç°æä¾›äº†ç†Ÿæ‚‰çš„from_pretrainedæ–¹æ³•å’Œç”Ÿæˆçš„åŸºæœ¬å‚æ•°ï¼Œä½†ä¸€äº›åŠŸèƒ½ï¼ˆå¦‚repeation_chamineï¼‰æ˜¯ä¸å¯ç”¨çš„ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨åƒ text-generation-webui(<a href="https://github.com/oobabooga/text-generation-webui">https://github.com/oobabooga/text-generation-webui</a>)è¿™æ ·çš„å·¥å…·ã€‚å› æ­¤ï¼Œä¸ºäº†ä½¿ç”¨Mambaï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Pythonä»£ç è¿›è¡Œæ¨ç†ã€‚æˆ‘å·²ç»å°½å¯èƒ½ç®€å•åœ°ç¼–å†™äº†ä»£ç ã€‚</p>
<p><strong>é¦–å…ˆï¼Œè®©æˆ‘ä»¬åŠ è½½æ¨¡å‹ã€‚</strong></p>
<hr>
<pre><code>import torch
from mamba_ssm.models.mixer_seq_simple import MambaLMHeadModel
from transformers import AutoTokenizer, TrainingArguments
  

# Load model
model = MambaLMHeadModel.from_pretrained(
  &quot;state-spaces/mamba-1.4b&quot;, 
  device=&quot;cuda&quot;, 
  dtype=torch.bfloat16)
  

# Load Tokenizer
tokenizer = AutoTokenizer.from_pretrained(&quot;EleutherAI/gpt-neox-20b&quot;)
</code></pre>
<p><strong>ä½¿ç”¨ç®€å•Promptå®Œæˆç»­å†™ä»»åŠ¡</strong></p>
<p>åœ¨ä¸è¿›è¡Œå¾®è°ƒçš„æƒ…å†µä¸‹ï¼Œæµ‹è¯•Mambaæ¨¡å‹æœ€ç®€å•æ–¹æ³•æ˜¯è¿›è¡Œå¯¹è¯ã€‚ä¾‹å¦‚ï¼š</p>
<hr>
<pre><code>prompt=\
&quot;&quot;&quot;A conversation between a user and a smart AI assistant.
  

### User: Hello!
### Assistant:&quot;&quot;&quot;
  

prompt_tokenized=tokenizer(prompt, return_tensors=&quot;pt&quot;).to(&quot;cuda&quot;)
  

# from https://github.com/state-spaces/mamba/blob/main/benchmarks/benchmark_generation_mamba_simple.py#L54
output_tokenized = model.generate(
    input_ids=prompt_tokenized[&quot;input_ids&quot;], 
    max_length=70,
    cg=True,
    output_scores=True,
    enable_timing=False,
    temperature=0.7,
    top_k=40,
    top_p=0.1,
    )
output=tokenizer.decode(output_tokenized[0])
  

print(output)
</code></pre>
<blockquote>
<p>A conversation between a user and a smart AI assistant.</p>
<h3 id="user-hello-assistant-hello">User: Hello!### Assistant: Hello!</h3>
<h3 id="user-im-hungry-assistant-im-hungry">User: Iâ€™m hungry.### Assistant: Iâ€™m hungry.</h3>
<h3 id="user-im-thirsty-assistant-im-thirsty">User: Iâ€™m thirsty.### Assistant: Iâ€™m thirsty.</h3>
<h3 id="user-im-tired">User: Iâ€™m tired.</h3>
</blockquote>
<blockquote>
</blockquote>
<p><strong>Prompt tuningï¼šå…·æœ‰é‡æ–°æ ·å¼çš„ä¸Šä¸‹æ–‡å†…ç­¾åï¼ˆURIALï¼‰çš„æœªè°ƒæ•´LLM</strong></p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ¢ç´¢ä¸€ç§æ›´é«˜çº§çš„æ–¹æ³•ã€‚æœ€è¿‘ï¼Œä¸€ç¯‡ç ”ç©¶è®ºæ–‡ï¼ˆhttps://arxiv.org/abs/2312.01552ï¼‰å¼ºè°ƒï¼Œåªè¦ç»™å‡ºæ­£ç¡®çš„æç¤ºï¼ŒåŸºæœ¬çš„è¯­è¨€æ¨¡å‹å®é™…ä¸Šå¯ä»¥åœ¨å¯¹è¯ä¸­è¡¨ç°å¾—å¾ˆå¥½ã€‚ä¸‹é¢å±•ç¤ºä¸€ä¸ªä¾‹å­ï¼š</p>
<h4 id="heading"></h4>
<p>Below is a list of conversations between a human and an AI assistant (you). Users place their queries under &ldquo;# Query:&rdquo;, and your responses are under &ldquo;# Answer:&rdquo;. You are a helpful, respectful, and honest assistant. You should always answer as helpfully as possible while ensuring safety. Your answers should be well-structured and provide detailed information. They should also have an engaging tone. Your responses must not contain any fake, harmful, unethical, racist, sexist, toxic, dangerous, or illegal content, even if it may be helpful. Your response must be socially responsibly, and thus you can reject to answer some controversial topics.</p>
<h1 id="query-hello">Query: Hello!</h1>
<h1 id="answer-hello">Answer: Hello!</h1>
<h1 id="query-how-are-you">Query: How are you?</h1>
<h1 id="answer-im-fine">Answer: I&rsquo;m fine.</h1>
<h1 id="query-explain-quantum-physics-to-me-like-i-am-5-years-old">Query: Explain quantum physics to me like i am 5 years old</h1>
<h1 id="answer-i-cant-explain-quantum-physics-to-you">Answer: I can&rsquo;t explain quantum physics to you.</h1>
<h1 id="query-what-is-the-meaning-of-life">Query: What is the meaning of life?</h1>
<h1 id="answer-the-meaning-of-life-is-to-live-it">Answer: The meaning of life is to live it.</h1>
<h1 id="query-what-is-the-meaning-of-life-1">Query: What is the meaning of life?</h1>
<h1 id="answer-the-meaning-of-life-is-to-live-it-1">Answer: The meaning of life is to live it.</h1>
<h1 id="query-what-is-the-meaning-of-life-2">Query: What is the meaning of life?</h1>
<h1 id="answer-the-meaning-of-life-is-to-live-it-2">Answer: The meaning of life is to live it.</h1>
<p><strong>Mixtral</strong></p>
<p>ä¸ºäº†æ‰©å±•æ›´å¤šè§†è§’ï¼Œåšä¸»è¿˜ä½¿ç”¨fireworks.aiåœ¨ç›¸åŒæç¤ºä¸‹æµ‹è¯•äº†æ–°å‘å¸ƒçš„Mixtral Mixtral Expertsæ¨¡å‹ï¼Œå¹¶è§‚å¯Ÿå›å¤çš„å·®å¼‚ã€‚</p>
<blockquote>
<p>Below is a list of conversations between a human and an AI assistant (you). Users place their queries under â€œ# Query:â€, and your responses are under â€œ# Answer:â€. You are a helpful, respectful, and honest assistant. You should always answer as helpfully as possible while ensuring safety. Your answers should be well-structured and provide detailed information. They should also have an engaging tone. Your responses must not contain any fake, harmful, unethical, racist, sexist, toxic, dangerous, or illegal content, even if it may be helpful. Your response must be socially responsibly, and thus you can reject to answer some controversial topics.</p>
<h1 id="query-hello-1">Query: Hello!</h1>
</blockquote>
<h1 id="answer-hello-1">Answer: Hello!</h1>
<blockquote>
<h1 id="query-how-are-you-1">Query: How are you?</h1>
</blockquote>
<h1 id="answer-im-fine-1">Answer: Iâ€™m fine.</h1>
<blockquote>
<h1 id="query-explain-quantum-physics-to-me-like-i-am-5-years-old-1">Query: Explain quantum physics to me like i am 5 years old</h1>
</blockquote>
<h1 id="answer-quantum-physics-is-the-study-of-the-smallest-particles-in-the-universe-these-particles-are-so-small-that-they-behave-in-strange-ways-that-we-cant-see-with-our-eyes-for-example-they-can-be-in-two-places-at-the-same-time-and-they-can-disappear-and-reappear-quantum-physics-is-a-very-complicated-subject-but-it-is-also-very-important-because-it-helps-us-understand-how-the-universe-works">Answer: Quantum physics is the study of the smallest particles in the universe. These particles are so small that they behave in strange ways that we canâ€™t see with our eyes. For example, they can be in two places at the same time, and they can disappear and reappear. Quantum physics is a very complicated subject, but it is also very important because it helps us understand how the universe works.</h1>
<blockquote>
<h1 id="query-what-is-the-meaning-of-life-3">Query: What is the meaning of life?</h1>
</blockquote>
<h1 id="answer-the-meaning-of-life-is-different-for-everyone-some-people-believe-that-life-is-about-finding-happiness-and-fulfillment-while-others-believe-that-life-is-about-serving-a-higher-purpose-ultimately-the-meaning-of-life-is-something-that-each-person-must-discover-for-themselves">Answer: The meaning of life is different for everyone. Some people believe that life is about finding happiness and fulfillment, while others believe that life is about serving a higher purpose. Ultimately, the meaning of life is something that each person must discover for themselves.</h1>
<p>æ€»çš„æ¥è¯´ï¼ŒMambaåŸºåº§æ¨¡å¼ä¸é€‚åˆå¯¹è¯ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°è¯•é€šè¿‡å¾®è°ƒæ¥æ”¹è¿›å®ƒã€‚</p>
<p><strong>ä¸‰ã€å¾®è°ƒMamba</strong></p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¹Mambaè¿›è¡Œå¾®è°ƒï¼Œå°†å…¶è½¬å˜ä¸ºä¸€ä¸ªé€šç”¨çš„èŠå¤©æœºå™¨äººã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨é«˜è´¨é‡çš„ChatMLå¤šè½®å¯¹è¯æ•°æ®é›†Open Assistantæ•°æ®é›†ï¼ˆhttps://huggingface.co/datasets/OpenAssistant/oasst_top1_2023-08-25ï¼‰ã€‚</p>
<p><strong>æ­¤å¾®è°ƒè¿‡ç¨‹åŒ…æ‹¬å‡ ä¸ªæ­¥éª¤</strong> ï¼š</p>
<pre><code>* Tokenizingæ•°æ®é›†

* å®šä¹‰collateå‡½æ•°

* ä½¿Mambaé€‚åº”Hugging Face Trainerï¼Œç”±äºMambaç‹¬ç‰¹çš„æ¶æ„ï¼Œéœ€è¦ä¿®æ”¹ä¸€äº›ä»£ç ã€‚
</code></pre>
<p><strong>3.1 åŠ è½½æ•°æ®é›†å¹¶å¯¹å…¶tokenize</strong></p>
<hr>
<pre><code>from datasets import load_dataset
  

dataset=load_dataset(&quot;OpenAssistant/oasst_top1_2023-08-25&quot;)
</code></pre>
<p>è¯¥æ•°æ®é›†æœ‰13kæ¡æ ·æœ¬ï¼Œå¹¶ä¸”å·²ç»åˆ’åˆ†å¥½äº†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼š</p>
<hr>
<pre><code>DatasetDict({
    train: Dataset({
        features: ['text'],
        num_rows: 12947
    })
    test: Dataset({
        features: ['text'],
        num_rows: 690
    })
})
</code></pre>
<p>æ•°æ®é›†ä¸­çš„å¤§å¤šæ•°å¯¹è¯ï¼ˆ92%ï¼‰æœ‰å°‘äº1000ä¸ªtokensç»„æˆã€‚å› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„tokenizeè¿‡ç¨‹ä¸­ï¼Œå°†æ¯ä¸ªä¼šè¯æˆªæ–­ä¸º1024ä¸ªtokenså°±è¶³å¤Ÿäº†ã€‚</p>
<hr>
<pre><code>import os 
  

def tokenize(element):
    return tokenizer(
        element[&quot;text&quot;],
        truncation=True,
        max_length=1024,
        add_special_tokens=False,
    )
  

dataset_tokenized = dataset.map(
    tokenize, 
    batched=True, 
    num_proc=os.cpu_count(),    # multithreaded
    remove_columns=[&quot;text&quot;]     # don't need this anymore, we have tokens from here on
)
</code></pre>
<p><strong>3.2 å®šä¹‰collateå‡½æ•°</strong></p>
<p>åœ¨æˆ‘ä»¬å°†æ•°æ®é›†ä¼ å…¥Trainerä¹‹å‰ï¼Œç”±äºå¹¶éæ‰€æœ‰å¯¹è¯çš„é•¿åº¦éƒ½ç›¸åŒï¼Œæˆ‘ä»¬å¿…é¡»å°†å®ƒä»¬åˆ†æ‰¹åˆ†ç»„ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰pad_tokenã€‚</p>
<hr>
<pre><code>tokenizer.pad_token = tokenizer.eos_token
  

# collate function - to transform list of dictionaries [ {input_ids: [123, ..]}, {.. ] to single batch dictionary { input_ids: [..], labels: [..], attention_mask: [..] }
def collate(elements):
    tokenlist=[e[&quot;input_ids&quot;] for e in elements]
    tokens_maxlen=max([len(t) for t in tokenlist])
  

    input_ids,labels = [],[]
    for tokens in tokenlist:
        pad_len=tokens_maxlen-len(tokens)
  

        # pad input_ids with pad_token, labels with ignore_index (-100) and set attention_mask 1 where content otherwise 0
        input_ids.append( tokens + [tokenizer.pad_token_id]*pad_len )   
        labels.append( tokens + [-100]*pad_len )    
  

    batch={
        &quot;input_ids&quot;: torch.tensor(input_ids),
        &quot;labels&quot;: torch.tensor(labels),
    }
    return batch
</code></pre>
<p><strong>PSï¼šç”±äºMambaæ²¡æœ‰ä½¿ç”¨æ³¨æ„åŠ›æœºåˆ¶ï¼Œå› æ­¤æ‰¹æ¬¡ä¸­ä¸åŒ…å«æ³¨æ„åŠ›æ©ç ã€‚</strong></p>
<p><strong>3.3 å‡†å¤‡MambağŸ¤—Trainer</strong></p>
<p>ç›®å‰ï¼ŒMambaè¿˜æ²¡æœ‰è¢«æ·»åŠ åˆ°Hugging Faceç”Ÿæ€ç³»ç»Ÿä¸­ã€‚æ ‡å‡†çš„Hugging Face Traineréœ€è¦ä¸€ä¸ªåŒ…æ‹¬labelsçš„å‘å‰å‡½æ•°ï¼Œè€ŒMambaæ²¡æœ‰ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡ä½¿ç”¨monkeyè¡¥ä¸å‘æ¨¡å‹æ·»åŠ ä¸€ä¸ªæ–°çš„å‰å‘å‡½æ•°ã€‚è¿™ä¸æ˜¯æœ€ä¼˜é›…çš„æ–¹æ³•ï¼Œä½†åœ¨Mambaæˆä¸ºHugging Face transformeråº“çš„ä¸€éƒ¨åˆ†ä¹‹å‰ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸´æ—¶çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<hr>
<pre><code># monkey patch MambaLMHeadModel.forward 
def forward_with_loss(self, input_ids, position_ids=None, inference_params=None, num_last_tokens=0, labels = None):
    &quot;&quot;&quot;
    &quot;position_ids&quot; is just to be compatible with Transformer generation. We don't use it.
    num_last_tokens: if &gt; 0, only return the logits for the last n tokens
    &quot;&quot;&quot;
    hidden_states = self.backbone(input_ids, inference_params=inference_params)
    if num_last_tokens &gt; 0:
        hidden_states = hidden_states[:, -num_last_tokens:]
    lm_logits = self.lm_head(hidden_states)
    
    # Source: https://github.com/huggingface/transformers/blob/80377eb018c077dba434bc8e7912bcaed3a64d09/src/transformers/models/llama/modeling_llama.py#L1196
    from torch.nn import CrossEntropyLoss
    if labels is not None:
        logits = lm_logits
        # Shift so that tokens &lt; n predict n
        shift_logits = logits[..., :-1, :].contiguous()
        shift_labels = labels[..., 1:].contiguous()
        # Flatten the tokens
        loss_fct = CrossEntropyLoss()
        # shift_logits = shift_logits.view(-1, self.config.vocab_size)
        shift_logits = shift_logits.view(-1, self.backbone.embedding.weight.size()[0])
        shift_labels = shift_labels.view(-1)
        # Enable model parallelism
        shift_labels = shift_labels.to(shift_logits.device)
        loss = loss_fct(shift_logits, shift_labels)
        return (loss,)   
    else:
        CausalLMOutput = namedtuple(&quot;CausalLMOutput&quot;, [&quot;logits&quot;])
        return CausalLMOutput(logits=lm_logits)
MambaLMHeadModel.forward=forward_with_loss
  

# patch MambaLMHeadModel
MambaLMHeadModel.forward=forward_with_loss
  

# (re)load model 
model = MambaLMHeadModel.from_pretrained(&quot;state-spaces/mamba-1.4b&quot;, device=&quot;cuda&quot;, dtype=torch.bfloat16)
</code></pre>
<p>æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¼˜ç§€çš„è®­ç»ƒå™¨axolotlï¼ˆhttps://github.com/OpenAccess-AI-Collective/axolotlï¼‰æˆ–ä½¿ç”¨mamba-chatï¼ˆhttps://github.com/havenhq/mamba-chatï¼‰è¿›è¡Œè®­ç»ƒã€‚</p>
<p><strong>å››ã€è®­ç»ƒMambaæ¨¡å‹</strong></p>
<hr>
<pre><code>from transformers import Trainer, TrainingArguments
  

bs=4        # batch size
ga_steps=1  # gradient acc. steps
epochs=3
steps_per_epoch=len(dataset_tokenized[&quot;train&quot;])//(bs*ga_steps)
lr=0.0005
  

args = TrainingArguments(
    output_dir=&quot;out&quot;,
    per_device_train_batch_size=bs,
    per_device_eval_batch_size=bs,
    evaluation_strategy=&quot;steps&quot;,
    logging_steps=1,
    eval_steps=steps_per_epoch,
    save_steps=steps_per_epoch,
    gradient_accumulation_steps=ga_steps,
    num_train_epochs=epochs,
    lr_scheduler_type=&quot;constant&quot;,
    learning_rate=lr,
    group_by_length=True,
    bf16=True,                  # mixed precision training
    save_safetensors=False,     # saving will fail without this
)
  

trainer = Trainer(
    model=model,
    tokenizer=tokenizer,
    args=args,
    data_collator=collate,
    train_dataset=dataset_tokenized[&quot;train&quot;],
    eval_dataset=dataset_tokenized[&quot;test&quot;],
)
  

trainer.train()
</code></pre>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/N5aX12H1SicnL0LbhlvBPAdARv93UBQz9wnPSwicLGh5wsXuP3H04DCrzh78Qh6HaTklwficWOJiavrjwN98XN4BEA/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/N5aX12H1SicnL0LbhlvBPAdARv93UBQz91HhrHLm5lZcRf8XfSNxeETzib1Ph1AVfe3c4vibMWWaKsbicu4pxHjeHw/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/N5aX12H1SicnL0LbhlvBPAdARv93UBQz9EibEKYEFtrOPicicgF5qStQJsQXiaZ4j1ewMJsjia8UibLQlURlN5Ie08lvA/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p><strong>learning_rate</strong> ï¼šå¯èƒ½æ˜¯è¿™é‡Œæœ€é‡è¦çš„ä¸€ä¸ªè¶…å‚æ•°ã€‚æ­£å¦‚æ‚¨å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­çœ‹åˆ°çš„ï¼Œæˆ‘æœ€åˆé€‰æ‹©çš„learning_rate=0.0005å¾ˆå·®ã€‚</p>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå¾®è°ƒç»“æœå¦‚ä½•ï¼ˆå‰§é€ï¼šç³Ÿç³•ï¼‰ä»¥åŠå¦‚ä½•ä¿®å¤å®ƒã€‚</p>
<p><strong>äº”ã€è¯„ä»·Mambaæ¨¡å‹</strong></p>
<p>èŠå¤©æœºå™¨äººçš„è¯„ä¼°å¾ˆéš¾ï¼Œå› ä¸ºç»“æœå¾ˆéš¾è¡¡é‡ã€‚</p>
<p>ä»€ä¹ˆæ˜¯å¥½çš„ä¼šè¯/æŒ‡ä»¤è·Ÿéšæ¨¡å¼ï¼Ÿè¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆä¸æ­¢ä¸€ç§ã€‚åœ¨æœ‰äººæƒ³å‡ºå¦‚ä½•æ­£ç¡®åº”ç”¨è¿™æ ·çš„ä¸œè¥¿ä¹‹å‰ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸ä¾èµ–åŸºå‡†ï¼ˆhttps://github.com/EleutherAI/lm-evaluation-harnessï¼‰æµ‹è¯•ã€èŠå¤©æœºå™¨äººç«æŠ€åœºï¼ˆhttps://huggingface.co/spaces/lmsys/chatbot-arena-leaderboardï¼‰å’Œäººå·¥æ™ºèƒ½è£åˆ¤ï¼ˆhttps://huggingface.co/spaces/lmsys/chatbot-arena-leaderboardï¼‰ã€‚</p>
<p><strong>å…­ã€åŸºå‡†</strong></p>
<p>Mambaçš„ä½œè€…å‘è¡¨äº†ä¸€ä»½ä½¿ç”¨EleutherAI/lmè¯„ä¼°å·¥å…·æ”¶é›†ï¼ˆhttps://github.com/EleutherAI/lm-evaluation-harnessï¼‰çš„æ•°å­—è¡¨ã€‚</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/N5aX12H1SicnL0LbhlvBPAdARv93UBQz9tScSCaE7iayiakOd2wBUGmukaCTMd1S08PFjIQYfbPfgMIZOibJcsia1Sg/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p>æˆ‘å¯¹è¿™äº›æ•°å­—ä¹ŸæŒæ€€ç–‘æ€åº¦ã€‚ä½†ç”±äºæˆ‘å¯¹Mambaæ²¡æœ‰ä»»ä½•ç»éªŒï¼Œæˆ‘ä»¥ä»–ä»¬ä¸ºèµ·ç‚¹ï¼Œçœ‹çœ‹å¾®è°ƒæ˜¯å¦æœç€æ­£ç¡®çš„æ–¹å‘å‘å±•ã€‚</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/N5aX12H1SicnL0LbhlvBPAdARv93UBQz91KRr2PQW8PiciaLJON3ia13UZnwgIxv7QmpXuTjNxcIXfPsiaRYeq9uajQ/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p>æˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨ç”¨è¿™ç§å¾®è°ƒæ¥ç ´åæ¨¡å‹ã€‚æ­£å¦‚æˆ‘åœ¨ä¸‹é¢è¯•å›¾è¯´æœä½ çš„é‚£æ ·ï¼Œ0.0005çš„å­¦ä¹ ç‡ï¼ˆLRï¼‰å¤ªé«˜äº†ã€‚</p>
<p><strong>ä»å“ªé‡Œå¼€å§‹ï¼Ÿ</strong></p>
<p>æˆ‘ä¸æ¸…æ¥šç”¨äºé¢„è®­ç»ƒMambaçš„å®é™…å­¦ä¹ ç‡ã€‚åœ¨è®ºæ–‡ä¸­ï¼Œä½œè€…é™ˆè¿°äº†ä»¥ä¸‹å†…å®¹ï¼š</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/N5aX12H1SicnL0LbhlvBPAdARv93UBQz9peh0MYrtdTyWekQZHNARvnQJiaUuVm8vErkAT0KU6RCFT1P1CSzgevw/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p>è¿™æ˜¯å¦æ„å‘³ç€Mamba-1.4bæ˜¯ä»¥5x0.0002å³0.001çš„å³°å€¼LRè¿›è¡Œé¢„è®­ç»ƒçš„ï¼Ÿä¸çŸ¥é“ã€‚</p>
<p><strong>ç¬¬äºŒæ¬¡å°è¯•ï¼šä»¥è¾ƒä½çš„å­¦ä¹ ç‡è¿›è¡Œå¾®è°ƒ</strong></p>
<p>å¦ä¸€ä¸ªå­¦ä¹ ç‡è¾ƒä½çš„å¾®è°ƒè¯•éªŒï¼Œæˆ‘å†³å®šå°†å­¦ä¹ ç‡é™ä½10å€è‡³0.00005ï¼ˆè€Œä¸æ˜¯0.0005ï¼‰ã€‚</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/N5aX12H1SicnL0LbhlvBPAdARv93UBQz99mwMj0bsWvzYMqZ8uYUdYTjNzw9HjXVBSSWVwSzeiaqqRWbDRKYzNnQ/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p>LRè¶Šä½ï¼ŒæŸå¤±è¶Šä½ï¼Ÿçœ‹èµ·æ¥æ²¡æœ‰é”™ï¼Œé‡æ–°è¿è¡Œä¸€ä¸‹æ¥çœ‹çœ‹æ•ˆæœï¼š</p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/N5aX12H1SicnL0LbhlvBPAdARv93UBQz9pia2sJcgSReFdNWUt0iaM9h0QAib5icC3XO12QXYRBb1DRkhdZyCQfReDQ/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p>è¿™ä¸€æ¬¡æˆ‘ä»¬æ­£æœç€æ­£ç¡®çš„æ–¹å‘å‰è¿›ã€‚</p>
<p><strong>å°è¯•äº†ä¸åŒçš„æ–¹æ³•æ¥æ”¹è¿›å®ƒï¼Œæ”¹å˜LRã€è®­ç»ƒè½®æ•°å’Œæ•°æ®é›†â€”â€”ä»¥ä¸‹æ²¡æœ‰ä¸€ä¸ªèƒ½ç»™æˆ‘æ›´å¥½çš„æ•°å­—ã€‚</strong></p>
<pre><code>***Open Assistantï¼ˆOAï¼‰æ•°æ®é›†** ï¼š3x10e-5å’Œ2x10e-5çš„è¾ƒä½LRï¼›

***OAæ•°æ®é›†** ï¼šæ›´å¤šè®­ç»ƒè½®æ•°ï¼›

***å¦ä¸€ä¸ªæ•°æ®é›†** ï¼šHuggingFaceH4/ultrachat_200kã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œè¡¨ç°ä¸ä½³ã€‚
</code></pre>
<p>**ä¸ƒã€**<strong>mambaä¸ğŸ¦™TinyLlamaåœ¨ç”Ÿæˆè´¨é‡å’Œæ¨ç†é€Ÿåº¦å¯¹æ¯”</strong></p>
<p><img src="https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/sz_mmbiz_png/N5aX12H1SicnL0LbhlvBPAdARv93UBQz9mt0ASZnfgH5NhMSh58yYFH8EbaLibtFibBvrO3y1IFzGG1eBvTEzLNMQ/640?wx_fmt=png&amp;from=appmsg" alt=""></p>
<p>é€Ÿåº¦æƒŠäººã€‚åœ¨10kä¸ªtokensçš„Promptä¸‹ï¼ŒTinyLlamaè€—å°½äº†å†…å­˜ï¼ˆ24 GB VRAMï¼‰ï¼›è€ŒMambaä»…ä½¿ç”¨5 GB VRAMï¼Œå¹¶ä¸”ä»¥æ¯ç§’100ä¸ªtokensçš„é€Ÿåº¦ç”Ÿæˆã€‚</p>
<p><strong>å…«ã€mambaé•¿ä¸Šä¸‹æ–‡èƒ½åŠ›</strong></p>
<p>Mambaèƒ½å¤Ÿç”¨å‡ GBçš„VRAMå¤„ç†10kæç¤ºï¼Ÿ</p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹å®é™…è¾“å‡ºæ˜¯å¤šå°‘ã€‚</p>
<pre><code>* å°†æ•´æœ¬ä¹¦ç²˜è´´åˆ°Promptä¸­ï¼ˆ136Kä¸ªtokensï¼‰ï¼Œè®©Mambaæ€»ç»“è¦ç‚¹ã€‚ç»“æœæ˜¯ï¼šåƒåœ¾ï¼Œéšæœºtokensï¼›

* ä¸€ç¯‡å…³äºé“äººä¸‰é¡¹ï¼ˆ3.2Kä¸ªtokensï¼‰çš„éšæœºæ–‡ç« ï¼ˆhttps://www.tri247.com/triathlon-features/interviews/lionel-sanders-championship-previewï¼‰ï¼šå®ƒç¡®å®äº§ç”Ÿäº†è‹±æ–‡æ–‡æœ¬ï¼Œæ€»ç»“äº†10ä¸ªè¦ç‚¹ï¼Œä½†é‡å¤ä¸”äº§ç”Ÿå¹»è§‰ã€‚
</code></pre>
<p><strong>å¦‚æœå°†æ–‡ç« å‡åŠï¼ˆ1.54Kä¸ªtokensï¼‰ï¼šç»“æœè¦å¥½å¾—å¤šï¼</strong></p>
<p>Mambaæ— æ³•ç”Ÿæˆé«˜è´¨é‡å†…å®¹çš„åŸå› å¯èƒ½æ˜¯å› ä¸ºå®ƒæ˜¯ç”¨â€œä»…â€2048ä¸ªtokensçš„ä¸Šä¸‹æ–‡é•¿åº¦è¿›è¡Œé¢„è®­ç»ƒçš„ï¼ˆç¬¬4.2.2èŠ‚ï¼ŒMambaè®ºæ–‡ï¼‰ã€‚å› æ­¤ï¼Œä¹Ÿè®¸å¾®è°ƒä¸€ä¸ªå°å‹Mambaæ¨¡å‹ï¼Œæ¯”å¦‚Mamba-1.4bï¼Œå¯ä»¥é‡Šæ”¾å®ƒæ€»ç»“å¤§å‹æ–‡æœ¬çš„æ½œåŠ›ã€‚</p>
<p><strong>ä¹ã€æ€»ç»“</strong></p>
<pre><code>* ğŸMambaé€Ÿåº¦å¿«ï¼Œå¯ä»¥å¤„ç†å¤§é‡tokensï¼›

* ç›®å‰å¾®è°ƒæœ‰ç‚¹æ£˜æ‰‹ï¼ŒæœŸå¾…é›†æˆåˆ°ğŸ¤—transformerä¸­ï¼›

* ğŸ¦™TTinyLlamaç”Ÿæˆçš„æ–‡æœ¬æ¯”Mambaæ›´å¥½ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºå®ƒç»è¿‡äº†5å€æ•°æ®é‡çš„é¢„è®­ç»ƒã€‚
</code></pre>
<p><strong>å‚è€ƒæ–‡çŒ®ï¼š</strong></p>
<p>[1] <a href="https://medium.com/@geronimo7/mamba-a-shallow-dive-into-a-new-architecture-for-llms-54c70ade5957">https://medium.com/@geronimo7/mamba-a-shallow-dive-into-a-new-architecture-for-llms-54c70ade5957</a></p>
<p>[2] <a href="https://github.com/state-spaces/mamba">https://github.com/state-spaces/mamba</a></p>
<p>[3] <a href="https://github.com/geronimi73/mamba/blob/main/story-snippets.ipynb">https://github.com/geronimi73/mamba/blob/main/story-snippets.ipynb</a></p>
<p><strong>è¿›æŠ€æœ¯äº¤æµç¾¤è¯·æ·»åŠ AINLPå°åŠ©æ‰‹å¾®ä¿¡ï¼ˆid:Â ainlp2)</strong></p>
<p><strong>è¯·å¤‡æ³¨å…·ä½“æ–¹å‘+æ‰€ç”¨åˆ°çš„ç›¸å…³æŠ€æœ¯ç‚¹</strong></p>
<pre><code>![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/nW2ZPfuYqSJADkmZ2IX6Z23znAibuEevotDMq9iaMxiapK7jfMibiauGFkycicAJEs6x5U9SGyDJZ0S1tRed9TPNUUDQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1)
</code></pre>
<p><strong>å…³äºAINLP</strong></p>
<pre><code>AINLP æ˜¯ä¸€ä¸ªæœ‰è¶£æœ‰AIçš„è‡ªç„¶è¯­è¨€å¤„ç†ç¤¾åŒºï¼Œä¸“æ³¨äº AIã€NLPã€æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ã€æ¨èç®—æ³•ç­‰ç›¸å…³æŠ€æœ¯çš„åˆ†äº«ï¼Œä¸»é¢˜åŒ…æ‹¬LLMã€é¢„è®­ç»ƒæ¨¡å‹ã€è‡ªåŠ¨ç”Ÿæˆã€æ–‡æœ¬æ‘˜è¦ã€æ™ºèƒ½é—®ç­”ã€èŠå¤©æœºå™¨äººã€æœºå™¨ç¿»è¯‘ã€çŸ¥è¯†å›¾è°±ã€æ¨èç³»ç»Ÿã€è®¡ç®—å¹¿å‘Šã€æ‹›è˜ä¿¡æ¯ã€æ±‚èŒç»éªŒåˆ†äº«ç­‰ï¼Œæ¬¢è¿å…³æ³¨ï¼åŠ æŠ€æœ¯äº¤æµç¾¤è¯·æ·»åŠ AINLPå°åŠ©æ‰‹å¾®ä¿¡(idï¼šainlp2)ï¼Œå¤‡æ³¨å·¥ä½œ/ç ”ç©¶æ–¹å‘+åŠ ç¾¤ç›®çš„ã€‚

  


![](https://api.allorigins.win/raw?url=https://mmbiz.qpic.cn/mmbiz_jpg/nW2ZPfuYqSKABHCqVVQkVYPrM4XY1vsd0iaeuXzyJnoFc8cibd5mYb4wdA3WMQtiaPVmr0XLZHMuVibqWncibpnTSnQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1)
</code></pre>
<p>æ›´å¤šAIå·¥å…·ï¼Œå‚è€ƒ<a href="https://aibard123.com/">Github-AiBard123</a>ï¼Œ<a href="https://aibard123.com/">å›½å†…AiBard123</a></p>



          </div>

å¯å…³æ³¨æˆ‘ä»¬çš„å…¬ä¼—å·ï¼šæ¯å¤©AIæ–°å·¥å…·

<p><img src="/images/aitools/2024/03/qrcode_for_gh_dde1b429630d_258.jpg" alt=""></p>

        </article>

      </div>
    </div>
  </div>
</section>
        </div>
    </div>
    </main>




<script type='text/javascript' src='/assets/js/jquery.ui.touch-punch.min-0.2.2.js' id='jqueryui-touch-js'></script>
<script type='text/javascript' src='/assets/js/clipboard.min-5.6.2.js' id='clipboard-js'></script>
<script type='text/javascript' src='/assets/js/tooltip-extend.js' id='iplaycode-nav-js'></script>
<script type='text/javascript' id='popper-js-extra'>
 

var theme = {"ajaxurl":"","addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png","order":"asc","formpostion":"top","defaultclass":"io-grey-mode","isCustomize":"1","icourl":"","icopng":".png","urlformat":"1","customizemax":"10","newWindow":"0","lazyload":"1","minNav":"1","loading":"1","hotWords":"baidu","classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ","apikey":"TWpBeU1UVTNOekk1TWpVMEIvZ1M2bFVIQllUMmxsV1dZelkxQTVPVzB3UW04eldGQmxhM3BNWW14bVNtWk4="};
 
</script>
<script type='text/javascript' src='/assets/js/popper.min.js' id='popper-js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.min-4.3.1.js' id='bootstrap-js'></script>
<script type='text/javascript' src='/assets/js/theia-sticky-sidebar-1.5.0.js' id='sidebar-js'></script>
<script type='text/javascript' src='/assets/js/lazyload.min-12.4.0.js' id='lazyload-js'></script>
<script type='text/javascript' src='/assets/js/fancybox.min-3.5.7.js' id='lightbox-js-js'></script>

<script type='text/javascript' src='/assets/js/app-anim.js' id='appanim-js'></script>

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            if ($('a.smooth[href="' + window.location.hash + '"]')[0]) {
                $('a.smooth[href="' + window.location.hash + '"]').click();
            }else if (window.location.hash != '') {
                $("html, body").animate({
                    scrollTop: $(window.location.hash).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            if($(this).attr("href").substr(0, 1) == "#"){
                $("html, body").animate({
                    scrollTop: $($(this).attr("href")).offset().top - 90
                }, {
                    duration: 500,
                    easing: "swing"
                });
            }
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            if(!$(this).hasClass('change-href')){
                var menu =  $("a"+$(this).attr("href"));
                menu.click();
                toTarget(menu.parent().parent(),true,true);
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>

<script>

(function(){
    if(document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") === ''){
        if(new Date().getHours() > 22 || new Date().getHours() < 6){
            document.body.classList.remove('io-black-mode');
            document.body.classList.add('io-grey-mode');
            document.cookie = "night=1;path=/";
            console.log('å¤œé—´æ¨¡å¼å¼€å¯');
        }else{
            document.body.classList.remove('night');
            document.cookie = "night=0;path=/";
            console.log('å¤œé—´æ¨¡å¼å…³é—­');
        }
    }else{
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
        if(night == '0'){
            document.body.classList.remove('night');
        }else if(night == '1'){
            document.body.classList.add('night');
        }
    }
})();

$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");   
function switchNightMode(){
    var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1") || '0';
    if(night == '0'){
	$("#search-bg").css("background", "linear-gradient(#e2c4c4, #d8d8d8)");
        document.body.classList.remove('io-grey-mode');
        document.body.classList.add('io-black-mode');
        document.cookie = "night=1;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","æ—¥é—´æ¨¡å¼");
        $(".mode-ico").removeClass("icon-night");
        $(".mode-ico").addClass("icon-light");
    }else{
	$("#search-bg").css("background", "linear-gradient(#4f4040, #1b1d1f)");
        document.body.classList.remove('io-black-mode');
        document.body.classList.add('io-grey-mode');
        document.cookie = "night=0;path=/"
        console.log(' ');
        $(".switch-dark-mode").attr("data-original-title","å¤œé—´æ¨¡å¼");
        $(".mode-ico").removeClass("icon-light");
        $(".mode-ico").addClass("icon-night");
    }
}
</script>


<script>
    var newsContainer = document.getElementById('news-container');
    var newsItems = document.getElementsByClassName('news-item');
    var currentItem = 0;

    setInterval(function() {
        
        newsItems[currentItem].classList.remove('show');
        newsItems[currentItem].style.transform = 'translateY(-20px)';
        
        currentItem = (currentItem + 1) % newsItems.length;
        newsItems[currentItem].style.transform = 'translateY(' + (newsContainer.offsetHeight - 20) + 'px)';
        setTimeout(function() {
            newsItems[currentItem].classList.add('show');
        }, 500);
    }, 8000);
</script>

</body>
</html>


